/*******************************************************************************
 * Copyright 2018 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/

/**
 * Element.matches()
 * https://developer.mozilla.org/enUS/docs/Web/API/Element/matches#Polyfill
 */
if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
}

// eslint-disable-next-line valid-jsdoc
/**
 * Element.closest()
 * https://developer.mozilla.org/enUS/docs/Web/API/Element/closest#Polyfill
 */
if (!Element.prototype.closest) {
    Element.prototype.closest = function(s) {
        "use strict";
        var el = this;
        if (!document.documentElement.contains(el)) {
            return null;
        }
        do {
            if (el.matches(s)) {
                return el;
            }
            el = el.parentElement || el.parentNode;
        } while (el !== null && el.nodeType === 1);
        return null;
    };
}

/*******************************************************************************
 * Copyright 2018 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var dataLayerEnabled;
    var dataLayer;

    var NS = "cmp";
    var IS = "tabs";

    var keyCodes = {
        END: 35,
        HOME: 36,
        ARROW_LEFT: 37,
        ARROW_UP: 38,
        ARROW_RIGHT: 39,
        ARROW_DOWN: 40
    };

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]',
        active: {
            tab: "cmp-tabs__tab--active",
            tabpanel: "cmp-tabs__tabpanel--active"
        }
    };

    /**
     * Tabs Configuration
     *
     * @typedef {Object} TabsConfig Represents a Tabs configuration
     * @property {HTMLElement} element The HTMLElement representing the Tabs
     * @property {Object} options The Tabs options
     */

    /**
     * Tabs
     *
     * @class Tabs
     * @classdesc An interactive Tabs component for navigating a list of tabs
     * @param {TabsConfig} config The Tabs configuration
     */
    function Tabs(config) {
        var that = this;

        if (config && config.element) {
            init(config);
        }

        /**
         * Initializes the Tabs
         *
         * @private
         * @param {TabsConfig} config The Tabs configuration
         */
        function init(config) {
            that._config = config;

            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");

            cacheElements(config.element);
            that._active = getActiveIndex(that._elements["tab"]);

            if (that._elements.tabpanel) {
                refreshActive();
                bindEvents();
            }

            // Show the tab based on deep-link-id if it matches with any existing tab item id
            var deepLinkItemIdx = CQ.CoreComponents.container.utils.getDeepLinkItemIdx(that, "tabpanel");
            if (deepLinkItemIdx) {
                var deepLinkItem = that._elements["tab"][deepLinkItemIdx];
                if (deepLinkItem && that._elements["tab"][that._active].id !== deepLinkItem.id) {
                    navigateAndFocusTab(deepLinkItemIdx);
                }
            }

            if (window.Granite && window.Granite.author && window.Granite.author.MessageChannel) {
                /*
                 * Editor message handling:
                 * - subscribe to "cmp.panelcontainer" message requests sent by the editor frame
                 * - check that the message data panel container type is correct and that the id (path) matches this specific Tabs component
                 * - if so, route the "navigate" operation to enact a navigation of the Tabs based on index data
                 */
                CQ.CoreComponents.MESSAGE_CHANNEL = CQ.CoreComponents.MESSAGE_CHANNEL || new window.Granite.author.MessageChannel("cqauthor", window);
                CQ.CoreComponents.MESSAGE_CHANNEL.subscribeRequestMessage("cmp.panelcontainer", function(message) {
                    if (message.data && message.data.type === "cmp-tabs" && message.data.id === that._elements.self.dataset["cmpPanelcontainerId"]) {
                        if (message.data.operation === "navigate") {
                            navigate(message.data.index);
                        }
                    }
                });
            }
        }

        /**
         * Returns the index of the active tab, if no tab is active returns 0
         *
         * @param {Array} tabs Tab elements
         * @returns {Number} Index of the active tab, 0 if none is active
         */
        function getActiveIndex(tabs) {
            if (tabs) {
                for (var i = 0; i < tabs.length; i++) {
                    if (tabs[i].classList.contains(selectors.active.tab)) {
                        return i;
                    }
                }
            }
            return 0;
        }

        /**
         * Caches the Tabs elements as defined via the {@code data-tabs-hook="ELEMENT_NAME"} markup API
         *
         * @private
         * @param {HTMLElement} wrapper The Tabs wrapper element
         */
        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                if (hook.closest("." + NS + "-" + IS) === that._elements.self) { // only process own tab elements
                    var capitalized = IS;
                    capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                    var key = hook.dataset[NS + "Hook" + capitalized];
                    if (that._elements[key]) {
                        if (!Array.isArray(that._elements[key])) {
                            var tmp = that._elements[key];
                            that._elements[key] = [tmp];
                        }
                        that._elements[key].push(hook);
                    } else {
                        that._elements[key] = hook;
                    }
                }
            }
        }

        /**
         * Binds Tabs event handling
         *
         * @private
         */
        function bindEvents() {
            var tabs = that._elements["tab"];
            if (tabs) {
                for (var i = 0; i < tabs.length; i++) {
                    (function(index) {
                        tabs[i].addEventListener("click", function(event) {
                            navigateAndFocusTab(index);
                        });
                        tabs[i].addEventListener("keydown", function(event) {
                            onKeyDown(event);
                        });
                    })(i);
                }
            }
        }

        /**
         * Handles tab keydown events
         *
         * @private
         * @param {Object} event The keydown event
         */
        function onKeyDown(event) {
            var index = that._active;
            var lastIndex = that._elements["tab"].length - 1;

            switch (event.keyCode) {
                case keyCodes.ARROW_LEFT:
                case keyCodes.ARROW_UP:
                    event.preventDefault();
                    if (index > 0) {
                        navigateAndFocusTab(index - 1);
                    }
                    break;
                case keyCodes.ARROW_RIGHT:
                case keyCodes.ARROW_DOWN:
                    event.preventDefault();
                    if (index < lastIndex) {
                        navigateAndFocusTab(index + 1);
                    }
                    break;
                case keyCodes.HOME:
                    event.preventDefault();
                    navigateAndFocusTab(0);
                    break;
                case keyCodes.END:
                    event.preventDefault();
                    navigateAndFocusTab(lastIndex);
                    break;
                default:
                    return;
            }
        }

        /**
         * Refreshes the tab markup based on the current {@code Tabs#_active} index
         *
         * @private
         */
        function refreshActive() {
            var tabpanels = that._elements["tabpanel"];
            var tabs = that._elements["tab"];

            if (tabpanels) {
                if (Array.isArray(tabpanels)) {
                    for (var i = 0; i < tabpanels.length; i++) {
                        if (i === parseInt(that._active)) {
                            tabpanels[i].classList.add(selectors.active.tabpanel);
                            tabpanels[i].removeAttribute("aria-hidden");
                            tabs[i].classList.add(selectors.active.tab);
                            tabs[i].setAttribute("aria-selected", true);
                            tabs[i].setAttribute("tabindex", "0");
                        } else {
                            tabpanels[i].classList.remove(selectors.active.tabpanel);
                            tabpanels[i].setAttribute("aria-hidden", true);
                            tabs[i].classList.remove(selectors.active.tab);
                            tabs[i].setAttribute("aria-selected", false);
                            tabs[i].setAttribute("tabindex", "-1");
                        }
                    }
                } else {
                    // only one tab
                    tabpanels.classList.add(selectors.active.tabpanel);
                    tabs.classList.add(selectors.active.tab);
                }
            }
        }

        /**
         * Focuses the element and prevents scrolling the element into view
         *
         * @param {HTMLElement} element Element to focus
         */
        function focusWithoutScroll(element) {
            var x = window.scrollX || window.pageXOffset;
            var y = window.scrollY || window.pageYOffset;
            element.focus();
            window.scrollTo(x, y);
        }

        /**
         * Navigates to the tab at the provided index
         *
         * @private
         * @param {Number} index The index of the tab to navigate to
         */
        function navigate(index) {
            that._active = index;
            refreshActive();
        }

        /**
         * Navigates to the item at the provided index and ensures the active tab gains focus
         *
         * @private
         * @param {Number} index The index of the item to navigate to
         */
        function navigateAndFocusTab(index) {
            var exActive = that._active;
            navigate(index);
            focusWithoutScroll(that._elements["tab"][index]);

            if (dataLayerEnabled) {

                var activeItem = getDataLayerId(that._elements.tabpanel[index].dataset.cmpDataLayer);
                var exActiveItem = getDataLayerId(that._elements.tabpanel[exActive].dataset.cmpDataLayer);

                dataLayer.push({
                    event: "cmp:show",
                    eventInfo: {
                        path: "component." + activeItem
                    }
                });

                dataLayer.push({
                    event: "cmp:hide",
                    eventInfo: {
                        path: "component." + exActiveItem
                    }
                });

                var tabsId = that._elements.self.id;
                var uploadPayload = { component: {} };
                uploadPayload.component[tabsId] = { shownItems: [activeItem] };

                var removePayload = { component: {} };
                removePayload.component[tabsId] = { shownItems: undefined };

                dataLayer.push(removePayload);
                dataLayer.push(uploadPayload);
            }
        }
    }

    /**
     * Reads options data from the Tabs wrapper element, defined via {@code data-cmp-*} data attributes
     *
     * @private
     * @param {HTMLElement} element The Tabs element to read options data from
     * @returns {Object} The options read from the component data attributes
     */
    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    /**
     * Parses the dataLayer string and returns the ID
     *
     * @private
     * @param {String} componentDataLayer the dataLayer string
     * @returns {String} dataLayerId or undefined
     */
    function getDataLayerId(componentDataLayer) {
        return Object.keys(JSON.parse(componentDataLayer))[0];
    }

    /**
     * Document ready handler and DOM mutation observers. Initializes Tabs components as necessary.
     *
     * @private
     */
    function onDocumentReady() {
      dataLayerEnabled = document.body.hasAttribute("data-cmp-data-layer-enabled");
      dataLayer = (dataLayerEnabled)? window.adobeDataLayer = window.adobeDataLayer || [] : undefined;

      var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Tabs({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Tabs({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

}());

/*******************************************************************************
 * Copyright 2018 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var dataLayerEnabled;
    var dataLayer;

    var NS = "cmp";
    var IS = "carousel";

    var keyCodes = {
        SPACE: 32,
        END: 35,
        HOME: 36,
        ARROW_LEFT: 37,
        ARROW_UP: 38,
        ARROW_RIGHT: 39,
        ARROW_DOWN: 40
    };

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]'
    };

    var properties = {
        /**
         * Determines whether the Carousel will automatically transition between slides
         *
         * @memberof Carousel
         * @type {Boolean}
         * @default false
         */
        "autoplay": {
            "default": false,
            "transform": function(value) {
                return !(value === null || typeof value === "undefined");
            }
        },
        /**
         * Duration (in milliseconds) before automatically transitioning to the next slide
         *
         * @memberof Carousel
         * @type {Number}
         * @default 5000
         */
        "delay": {
            "default": 5000,
            "transform": function(value) {
                value = parseFloat(value);
                return !isNaN(value) ? value : null;
            }
        },
        /**
         * Determines whether automatic pause on hovering the carousel is disabled
         *
         * @memberof Carousel
         * @type {Boolean}
         * @default false
         */
        "autopauseDisabled": {
            "default": false,
            "transform": function(value) {
                return !(value === null || typeof value === "undefined");
            }
        }
    };

    /**
     * Carousel Configuration
     *
     * @typedef {Object} CarouselConfig Represents a Carousel configuration
     * @property {HTMLElement} element The HTMLElement representing the Carousel
     * @property {Object} options The Carousel options
     */

    /**
     * Carousel
     *
     * @class Carousel
     * @classdesc An interactive Carousel component for navigating a list of generic items
     * @param {CarouselConfig} config The Carousel configuration
     */
    function Carousel(config) {
        var that = this;

        if (config && config.element) {
            init(config);
        }

        /**
         * Initializes the Carousel
         *
         * @private
         * @param {CarouselConfig} config The Carousel configuration
         */
        function init(config) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");

            setupProperties(config.options);
            cacheElements(config.element);

            that._active = 0;
            that._paused = false;

            if (that._elements.item) {
                refreshActive();
                bindEvents();
                resetAutoplayInterval();
                refreshPlayPauseActions();
            }

            // TODO: This section is only relevant in edit mode and should move to the editor clientLib
            if (window.Granite && window.Granite.author && window.Granite.author.MessageChannel) {
                /*
                 * Editor message handling:
                 * - subscribe to "cmp.panelcontainer" message requests sent by the editor frame
                 * - check that the message data panel container type is correct and that the id (path) matches this specific Carousel component
                 * - if so, route the "navigate" operation to enact a navigation of the Carousel based on index data
                 */
                window.CQ = window.CQ || {};
                window.CQ.CoreComponents = window.CQ.CoreComponents || {};
                CQ.CoreComponents.MESSAGE_CHANNEL = CQ.CoreComponents.MESSAGE_CHANNEL || new window.Granite.author.MessageChannel("cqauthor", window);
                CQ.CoreComponents.MESSAGE_CHANNEL.subscribeRequestMessage("cmp.panelcontainer", function(message) {
                    if (message.data && message.data.type === "cmp-carousel" && message.data.id === that._elements.self.dataset["cmpPanelcontainerId"]) {
                        if (message.data.operation === "navigate") {
                            navigate(message.data.index);
                        }
                    }
                });
            }
        }

        /**
         * Caches the Carousel elements as defined via the {@code data-carousel-hook="ELEMENT_NAME"} markup API
         *
         * @private
         * @param {HTMLElement} wrapper The Carousel wrapper element
         */
        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                var capitalized = IS;
                capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                var key = hook.dataset[NS + "Hook" + capitalized];
                if (that._elements[key]) {
                    if (!Array.isArray(that._elements[key])) {
                        var tmp = that._elements[key];
                        that._elements[key] = [tmp];
                    }
                    that._elements[key].push(hook);
                } else {
                    that._elements[key] = hook;
                }
            }
        }

        /**
         * Sets up properties for the Carousel based on the passed options.
         *
         * @private
         * @param {Object} options The Carousel options
         */
        function setupProperties(options) {
            that._properties = {};

            for (var key in properties) {
                if (properties.hasOwnProperty(key)) {
                    var property = properties[key];
                    var value = null;

                    if (options && options[key] != null) {
                        value = options[key];

                        // transform the provided option
                        if (property && typeof property.transform === "function") {
                            value = property.transform(value);
                        }
                    }

                    if (value === null) {
                        // value still null, take the property default
                        value = properties[key]["default"];
                    }

                    that._properties[key] = value;
                }
            }
        }

        /**
         * Binds Carousel event handling
         *
         * @private
         */
        function bindEvents() {
            if (that._elements["previous"]) {
                that._elements["previous"].addEventListener("click", function() {
                    var index = getPreviousIndex();
                    navigate(index);
                    if (dataLayerEnabled) {
                        dataLayer.push({
                            event: "cmp:show",
                            eventInfo: {
                                path: "component." + getDataLayerId(that._elements.item[index].dataset.cmpDataLayer)
                            }
                        });
                    }
                });
            }

            if (that._elements["next"]) {
                that._elements["next"].addEventListener("click", function() {
                    var index = getNextIndex();
                    navigate(index);
                    if (dataLayerEnabled) {
                        dataLayer.push({
                            event: "cmp:show",
                            eventInfo: {
                                path: "component." + getDataLayerId(that._elements.item[index].dataset.cmpDataLayer)
                            }
                        });
                    }
                });
            }

            var indicators = that._elements["indicator"];
            if (indicators) {
                for (var i = 0; i < indicators.length; i++) {
                    (function(index) {
                        indicators[i].addEventListener("click", function(event) {
                            navigateAndFocusIndicator(index);
                        });
                    })(i);
                }
            }

            if (that._elements["pause"]) {
                if (that._properties.autoplay) {
                    that._elements["pause"].addEventListener("click", onPauseClick);
                }
            }

            if (that._elements["play"]) {
                if (that._properties.autoplay) {
                    that._elements["play"].addEventListener("click", onPlayClick);
                }
            }

            that._elements.self.addEventListener("keydown", onKeyDown);

            if (!that._properties.autopauseDisabled) {
                that._elements.self.addEventListener("mouseenter", onMouseEnter);
                that._elements.self.addEventListener("mouseleave", onMouseLeave);
            }
        }

        /**
         * Handles carousel keydown events
         *
         * @private
         * @param {Object} event The keydown event
         */
        function onKeyDown(event) {
            var index = that._active;
            var lastIndex = that._elements["indicator"].length - 1;

            switch (event.keyCode) {
                case keyCodes.ARROW_LEFT:
                case keyCodes.ARROW_UP:
                    event.preventDefault();
                    if (index > 0) {
                        navigateAndFocusIndicator(index - 1);
                    }
                    break;
                case keyCodes.ARROW_RIGHT:
                case keyCodes.ARROW_DOWN:
                    event.preventDefault();
                    if (index < lastIndex) {
                        navigateAndFocusIndicator(index + 1);
                    }
                    break;
                case keyCodes.HOME:
                    event.preventDefault();
                    navigateAndFocusIndicator(0);
                    break;
                case keyCodes.END:
                    event.preventDefault();
                    navigateAndFocusIndicator(lastIndex);
                    break;
                case keyCodes.SPACE:
                    if (that._properties.autoplay && (event.target !== that._elements["previous"] && event.target !== that._elements["next"])) {
                        event.preventDefault();
                        if (!that._paused) {
                            pause();
                        } else {
                            play();
                        }
                    }
                    if (event.target === that._elements["pause"]) {
                        that._elements["play"].focus();
                    }
                    if (event.target === that._elements["play"]) {
                        that._elements["pause"].focus();
                    }
                    break;
                default:
                    return;
            }
        }

        /**
         * Handles carousel mouseenter events
         *
         * @private
         * @param {Object} event The mouseenter event
         */
        function onMouseEnter(event) {
            clearAutoplayInterval();
        }

        /**
         * Handles carousel mouseleave events
         *
         * @private
         * @param {Object} event The mouseleave event
         */
        function onMouseLeave(event) {
            resetAutoplayInterval();
        }

        /**
         * Handles pause element click events
         *
         * @private
         * @param {Object} event The click event
         */
        function onPauseClick(event) {
            pause();
            that._elements["play"].focus();
        }

        /**
         * Handles play element click events
         *
         * @private
         * @param {Object} event The click event
         */
        function onPlayClick() {
            play();
            that._elements["pause"].focus();
        }

        /**
         * Pauses the playing of the Carousel. Sets {@code Carousel#_paused} marker.
         * Only relevant when autoplay is enabled
         *
         * @private
         */
        function pause() {
            that._paused = true;
            clearAutoplayInterval();
            refreshPlayPauseActions();
        }

        /**
         * Enables the playing of the Carousel. Sets {@code Carousel#_paused} marker.
         * Only relevant when autoplay is enabled
         *
         * @private
         */
        function play() {
            that._paused = false;

            // If the Carousel is hovered, don't begin auto transitioning until the next mouse leave event
            var hovered = false;
            if (that._elements.self.parentElement) {
                hovered = that._elements.self.parentElement.querySelector(":hover") === that._elements.self;
            }
            if (that._properties.autopauseDisabled || !hovered) {
                resetAutoplayInterval();
            }

            refreshPlayPauseActions();
        }

        /**
         * Refreshes the play/pause action markup based on the {@code Carousel#_paused} state
         *
         * @private
         */
        function refreshPlayPauseActions() {
            setActionDisabled(that._elements["pause"], that._paused);
            setActionDisabled(that._elements["play"], !that._paused);
        }

        /**
         * Refreshes the item markup based on the current {@code Carousel#_active} index
         *
         * @private
         */
        function refreshActive() {
            var items = that._elements["item"];
            var indicators = that._elements["indicator"];

            if (items) {
                if (Array.isArray(items)) {
                    for (var i = 0; i < items.length; i++) {
                        if (i === parseInt(that._active)) {
                            items[i].classList.add("cmp-carousel__item--active");
                            items[i].removeAttribute("aria-hidden");
                            indicators[i].classList.add("cmp-carousel__indicator--active");
                            indicators[i].setAttribute("aria-selected", true);
                            indicators[i].setAttribute("tabindex", "0");
                        } else {
                            items[i].classList.remove("cmp-carousel__item--active");
                            items[i].setAttribute("aria-hidden", true);
                            indicators[i].classList.remove("cmp-carousel__indicator--active");
                            indicators[i].setAttribute("aria-selected", false);
                            indicators[i].setAttribute("tabindex", "-1");
                        }
                    }
                } else {
                    // only one item
                    items.classList.add("cmp-carousel__item--active");
                    indicators.classList.add("cmp-carousel__indicator--active");
                }
            }
        }

        /**
         * Focuses the element and prevents scrolling the element into view
         *
         * @param {HTMLElement} element Element to focus
         */
        function focusWithoutScroll(element) {
            var x = window.scrollX || window.pageXOffset;
            var y = window.scrollY || window.pageYOffset;
            element.focus();
            window.scrollTo(x, y);
        }

        /**
         * Retrieves the next active index, with looping
         *
         * @private
         * @returns {Number} Index of the next carousel item
         */
        function getNextIndex() {
            return that._active === (that._elements["item"].length - 1) ? 0 : that._active + 1;
        }

        /**
         * Retrieves the previous active index, with looping
         *
         * @private
         * @returns {Number} Index of the previous carousel item
         */
        function getPreviousIndex() {
            return that._active === 0 ? (that._elements["item"].length - 1) : that._active - 1;
        }

        /**
         * Navigates to the item at the provided index
         *
         * @private
         * @param {Number} index The index of the item to navigate to
         */
        function navigate(index) {
            if (index < 0 || index > (that._elements["item"].length - 1)) {
                return;
            }

            that._active = index;
            refreshActive();

            if (dataLayerEnabled) {
                var carouselId = that._elements.self.id;
                var activeItem = getDataLayerId(that._elements.item[index].dataset.cmpDataLayer);
                var updatePayload = { component: {} };
                updatePayload.component[carouselId] = { shownItems: [activeItem] };

                var removePayload = { component: {} };
                removePayload.component[carouselId] = { shownItems: undefined };

                dataLayer.push(removePayload);
                dataLayer.push(updatePayload);
            }

            // reset the autoplay transition interval following navigation, if not already hovering the carousel
            if (that._elements.self.parentElement) {
                if (that._elements.self.parentElement.querySelector(":hover") !== that._elements.self) {
                    resetAutoplayInterval();
                }
            }
        }

        /**
         * Navigates to the item at the provided index and ensures the active indicator gains focus
         *
         * @private
         * @param {Number} index The index of the item to navigate to
         */
        function navigateAndFocusIndicator(index) {
            navigate(index);
            focusWithoutScroll(that._elements["indicator"][index]);

            if (dataLayerEnabled) {
                dataLayer.push({
                    event: "cmp:show",
                    eventInfo: {
                        path: "component." + getDataLayerId(that._elements.item[index].dataset.cmpDataLayer)
                    }
                });
            }
        }

        /**
         * Starts/resets automatic slide transition interval
         *
         * @private
         */
        function resetAutoplayInterval() {
            if (that._paused || !that._properties.autoplay) {
                return;
            }
            clearAutoplayInterval();
            that._autoplayIntervalId = window.setInterval(function() {
                if (document.visibilityState && document.hidden) {
                    return;
                }
                var indicators = that._elements["indicators"];
                if (indicators !== document.activeElement && indicators.contains(document.activeElement)) {
                    // if an indicator has focus, ensure we switch focus following navigation
                    navigateAndFocusIndicator(getNextIndex());
                } else {
                    navigate(getNextIndex());
                }
            }, that._properties.delay);
        }

        /**
         * Clears/pauses automatic slide transition interval
         *
         * @private
         */
        function clearAutoplayInterval() {
            window.clearInterval(that._autoplayIntervalId);
            that._autoplayIntervalId = null;
        }

        /**
         * Sets the disabled state for an action and toggles the appropriate CSS classes
         *
         * @private
         * @param {HTMLElement} action Action to disable
         * @param {Boolean} [disable] {@code true} to disable, {@code false} to enable
         */
        function setActionDisabled(action, disable) {
            if (!action) {
                return;
            }
            if (disable !== false) {
                action.disabled = true;
                action.classList.add("cmp-carousel__action--disabled");
            } else {
                action.disabled = false;
                action.classList.remove("cmp-carousel__action--disabled");
            }
        }
    }

    /**
     * Reads options data from the Carousel wrapper element, defined via {@code data-cmp-*} data attributes
     *
     * @private
     * @param {HTMLElement} element The Carousel element to read options data from
     * @returns {Object} The options read from the component data attributes
     */
    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    /**
     * Parses the dataLayer string and returns the ID
     *
     * @private
     * @param {String} componentDataLayer the dataLayer string
     * @returns {String} dataLayerId or undefined
     */
    function getDataLayerId(componentDataLayer) {
        return Object.keys(JSON.parse(componentDataLayer))[0];
    }

    /**
     * Document ready handler and DOM mutation observers. Initializes Carousel components as necessary.
     *
     * @private
     */
    function onDocumentReady() {
      dataLayerEnabled = document.body.hasAttribute("data-cmp-data-layer-enabled");
      dataLayer = (dataLayerEnabled)? window.adobeDataLayer = window.adobeDataLayer || [] : undefined;

      var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Carousel({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Carousel({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

}());

/*******************************************************************************
 * Copyright 2017 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
if (window.Element && !Element.prototype.closest) {
    // eslint valid-jsdoc: "off"
    Element.prototype.closest =
        function(s) {
            "use strict";
            var matches = (this.document || this.ownerDocument).querySelectorAll(s);
            var el      = this;
            var i;
            do {
                i = matches.length;
                while (--i >= 0 && matches.item(i) !== el) {
                    // continue
                }
            } while ((i < 0) && (el = el.parentElement));
            return el;
        };
}

if (window.Element && !Element.prototype.matches) {
    Element.prototype.matches =
        Element.prototype.matchesSelector ||
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector ||
        Element.prototype.oMatchesSelector ||
        Element.prototype.webkitMatchesSelector ||
        function(s) {
            "use strict";
            var matches = (this.document || this.ownerDocument).querySelectorAll(s);
            var i       = matches.length;
            while (--i >= 0 && matches.item(i) !== this) {
                // continue
            }
            return i > -1;
        };
}

if (!Object.assign) {
    Object.assign = function(target, varArgs) { // .length of function is 2
        "use strict";
        if (target === null) {
            throw new TypeError("Cannot convert undefined or null to object");
        }

        var to = Object(target);

        for (var index = 1; index < arguments.length; index++) {
            var nextSource = arguments[index];

            if (nextSource !== null) {
                for (var nextKey in nextSource) {
                    if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                        to[nextKey] = nextSource[nextKey];
                    }
                }
            }
        }
        return to;
    };
}

(function(arr) {
    "use strict";
    arr.forEach(function(item) {
        if (item.hasOwnProperty("remove")) {
            return;
        }
        Object.defineProperty(item, "remove", {
            configurable: true,
            enumerable: true,
            writable: true,
            value: function remove() {
                this.parentNode.removeChild(this);
            }
        });
    });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);

/*******************************************************************************
 * Copyright 2016 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "image";

    var EMPTY_PIXEL = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
    var LAZY_THRESHOLD_DEFAULT = 0;
    var SRC_URI_TEMPLATE_WIDTH_VAR = "{.width}";

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]',
        image: '[data-cmp-hook-image="image"]',
        map: '[data-cmp-hook-image="map"]',
        area: '[data-cmp-hook-image="area"]'
    };

    var lazyLoader = {
        "cssClass": "cmp-image__image--is-loading",
        "style": {
            "height": 0,
            "padding-bottom": "" // will be replaced with % ratio
        }
    };

    var properties = {
        /**
         * An array of alternative image widths (in pixels).
         * Used to replace a {.width} variable in the src property with an optimal width if a URI template is provided.
         *
         * @memberof Image
         * @type {Number[]}
         * @default []
         */
        "widths": {
            "default": [],
            "transform": function(value) {
                var widths = [];
                value.split(",").forEach(function(item) {
                    item = parseFloat(item);
                    if (!isNaN(item)) {
                        widths.push(item);
                    }
                });
                return widths;
            }
        },
        /**
         * Indicates whether the image should be rendered lazily.
         *
         * @memberof Image
         * @type {Boolean}
         * @default false
         */
        "lazy": {
            "default": false,
            "transform": function(value) {
                return !(value === null || typeof value === "undefined");
            }
        },
        /**
         * The lazy threshold.
         * This is the number of pixels, in advance of becoming visible, when an lazy-loading image should begin
         * to load.
         *
         * @memberof Image
         * @type {Number}
         * @default 0
         */
        "lazythreshold": {
            "default": 0,
            "transform": function(value) {
                const val =  parseInt(value);
                if (isNaN(val)) {
                    return LAZY_THRESHOLD_DEFAULT;
                }
                return val;
            }
        },
        /**
         * The image source.
         *
         * Can be a simple image source, or a URI template representation that
         * can be variable expanded - useful for building an image configuration with an alternative width.
         * e.g. '/path/image.coreimg{.width}.jpeg/1506620954214.jpeg'
         *
         * @memberof Image
         * @type {String}
         */
        "src": {
            "transform": function(value) {
                return decodeURIComponent(value);
            }
        }
    };

    var devicePixelRatio = window.devicePixelRatio || 1;

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function Image(config) {
        var that = this;

        function init(config) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");

            setupProperties(config.options);
            cacheElements(config.element);

            if (!that._elements.noscript) {
                return;
            }

            that._elements.container = that._elements.link ? that._elements.link : that._elements.self;

            unwrapNoScript();

            if (that._properties.lazy) {
                addLazyLoader();
            }

            if (that._elements.map) {
                that._elements.image.addEventListener("load", onLoad);
            }

            window.addEventListener("resize", onWindowResize);
            ["focus", "click", "load", "transitionend", "animationend", "scroll"].forEach(function(name) {
                document.addEventListener(name, that.update);
            });

            that._elements.image.addEventListener("cmp-image-redraw", that.update);
            that.update();
        }

        function loadImage() {
            var hasWidths = that._properties.widths && that._properties.widths.length > 0;
            var replacement = hasWidths ? "." + getOptimalWidth() : "";
            var url = that._properties.src.replace(SRC_URI_TEMPLATE_WIDTH_VAR, replacement);

            if (that._elements.image.getAttribute("src") !== url) {
                that._elements.image.setAttribute("src", url);
                if (!hasWidths) {
                    window.removeEventListener("scroll", that.update);
                }
            }

            if (that._lazyLoaderShowing) {
                that._elements.image.addEventListener("load", removeLazyLoader);
            }
        }

        function getOptimalWidth() {
            var container = that._elements.self;
            var containerWidth = container.clientWidth;
            while (containerWidth === 0 && container.parentNode) {
                container = container.parentNode;
                containerWidth = container.clientWidth;
            }
            var optimalWidth = containerWidth * devicePixelRatio;
            var len = that._properties.widths.length;
            var key = 0;

            while ((key < len - 1) && (that._properties.widths[key] < optimalWidth)) {
                key++;
            }

            return that._properties.widths[key].toString();
        }

        function addLazyLoader() {
            var width = that._elements.image.getAttribute("width");
            var height = that._elements.image.getAttribute("height");

            if (width && height) {
                var ratio = (height / width) * 100;
                var styles = lazyLoader.style;

                styles["padding-bottom"] = ratio + "%";

                for (var s in styles) {
                    if (styles.hasOwnProperty(s)) {
                        that._elements.image.style[s] = styles[s];
                    }
                }
            }
            that._elements.image.setAttribute("src", EMPTY_PIXEL);
            that._elements.image.classList.add(lazyLoader.cssClass);
            that._lazyLoaderShowing = true;
        }

        function unwrapNoScript() {
            var markup = decodeNoscript(that._elements.noscript.textContent.trim());
            var parser = new DOMParser();

            // temporary document avoids requesting the image before removing its src
            var temporaryDocument = parser.parseFromString(markup, "text/html");
            var imageElement = temporaryDocument.querySelector(selectors.image);
            imageElement.removeAttribute("src");
            that._elements.container.insertBefore(imageElement, that._elements.noscript);

            var mapElement = temporaryDocument.querySelector(selectors.map);
            if (mapElement) {
                that._elements.container.insertBefore(mapElement, that._elements.noscript);
            }

            that._elements.noscript.parentNode.removeChild(that._elements.noscript);
            if (that._elements.container.matches(selectors.image)) {
                that._elements.image = that._elements.container;
            } else {
                that._elements.image = that._elements.container.querySelector(selectors.image);
            }

            that._elements.map = that._elements.container.querySelector(selectors.map);
            that._elements.areas = that._elements.container.querySelectorAll(selectors.area);
        }

        function removeLazyLoader() {
            that._elements.image.classList.remove(lazyLoader.cssClass);
            for (var property in lazyLoader.style) {
                if (lazyLoader.style.hasOwnProperty(property)) {
                    that._elements.image.style[property] = "";
                }
            }
            that._elements.image.removeEventListener("load", removeLazyLoader);
            that._lazyLoaderShowing = false;
        }

        function isLazyVisible() {
            if (that._elements.container.offsetParent === null) {
                return false;
            }

            var wt = window.pageYOffset;
            var wb = wt + document.documentElement.clientHeight;
            var et = that._elements.container.getBoundingClientRect().top + wt;
            var eb = et + that._elements.container.clientHeight;

            return eb >= wt - that._properties.lazythreshold && et <= wb + that._properties.lazythreshold;
        }

        function resizeAreas() {
            if (that._elements.areas && that._elements.areas.length > 0) {
                for (var i = 0; i < that._elements.areas.length; i++) {
                    var width = that._elements.image.width;
                    var height = that._elements.image.height;

                    if (width && height) {
                        var relcoords = that._elements.areas[i].dataset.cmpRelcoords;
                        if (relcoords) {
                            var relativeCoordinates = relcoords.split(",");
                            var coordinates = new Array(relativeCoordinates.length);

                            for (var j = 0; j < coordinates.length; j++) {
                                if (j % 2 === 0) {
                                    coordinates[j] = parseInt(relativeCoordinates[j] * width);
                                } else {
                                    coordinates[j] = parseInt(relativeCoordinates[j] * height);
                                }
                            }

                            that._elements.areas[i].coords = coordinates;
                        }
                    }
                }
            }
        }

        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                var capitalized = IS;
                capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                var key = hook.dataset[NS + "Hook" + capitalized];
                that._elements[key] = hook;
            }
        }

        function setupProperties(options) {
            that._properties = {};

            for (var key in properties) {
                if (properties.hasOwnProperty(key)) {
                    var property = properties[key];
                    if (options && options[key] != null) {
                        if (property && typeof property.transform === "function") {
                            that._properties[key] = property.transform(options[key]);
                        } else {
                            that._properties[key] = options[key];
                        }
                    } else {
                        that._properties[key] = properties[key]["default"];
                    }
                }
            }
        }

        function onWindowResize() {
            that.update();
            resizeAreas();
        }

        function onLoad() {
            resizeAreas();
        }

        that.update = function() {
            if (that._properties.lazy) {
                if (isLazyVisible()) {
                    loadImage();
                }
            } else {
                loadImage();
            }
        };

        if (config && config.element) {
            init(config);
        }
    }

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Image({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body             = document.querySelector("body");
        var observer         = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Image({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

    /*
        on drag & drop of the component into a parsys, noscript's content will be escaped multiple times by the editor which creates
        the DOM for editing; the HTML parser cannot be used here due to the multiple escaping
     */
    function decodeNoscript(text) {
        text = text.replace(/&(amp;)*lt;/g, "<");
        text = text.replace(/&(amp;)*gt;/g, ">");
        return text;
    }

})();

/*******************************************************************************
 * Copyright 2017 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "search";

    var DELAY = 300; // time before fetching new results when the user is typing a search string
    var LOADING_DISPLAY_DELAY = 300; // minimum time during which the loading indicator is displayed
    var PARAM_RESULTS_OFFSET = "resultsOffset";

    var keyCodes = {
        TAB: 9,
        ENTER: 13,
        ESCAPE: 27,
        ARROW_UP: 38,
        ARROW_DOWN: 40
    };

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]',
        item: {
            self: "[data-" + NS + "-hook-" + IS + '="item"]',
            title: "[data-" + NS + "-hook-" + IS + '="itemTitle"]',
            focused: "." + NS + "-search__item--is-focused"
        }
    };

    var properties = {
        /**
         * The minimum required length of the search term before results are fetched.
         *
         * @memberof Search
         * @type {Number}
         * @default 3
         */
        minLength: {
            "default": 3,
            transform: function(value) {
                value = parseFloat(value);
                return isNaN(value) ? null : value;
            }
        },
        /**
         * The maximal number of results fetched by a search request.
         *
         * @memberof Search
         * @type {Number}
         * @default 10
         */
        resultsSize: {
            "default": 10,
            transform: function(value) {
                value = parseFloat(value);
                return isNaN(value) ? null : value;
            }
        }
    };

    var idCount = 0;

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function toggleShow(element, show) {
        if (element) {
            if (show !== false) {
                element.style.display = "block";
                element.setAttribute("aria-hidden", false);
            } else {
                element.style.display = "none";
                element.setAttribute("aria-hidden", true);
            }
        }
    }

    function serialize(form) {
        var query = [];
        if (form && form.elements) {
            for (var i = 0; i < form.elements.length; i++) {
                var node = form.elements[i];
                if (!node.disabled && node.name) {
                    var param = [node.name, encodeURIComponent(node.value)];
                    query.push(param.join("="));
                }
            }
        }
        return query.join("&");
    }

    function mark(node, regex) {
        if (!node || !regex) {
            return;
        }

        // text nodes
        if (node.nodeType === 3) {
            var nodeValue = node.nodeValue;
            var match = regex.exec(nodeValue);

            if (nodeValue && match) {
                var element = document.createElement("mark");
                element.className = NS + "-search__item-mark";
                element.appendChild(document.createTextNode(match[0]));

                var after = node.splitText(match.index);
                after.nodeValue = after.nodeValue.substring(match[0].length);
                node.parentNode.insertBefore(element, after);
            }
        } else if (node.hasChildNodes()) {
            for (var i = 0; i < node.childNodes.length; i++) {
                // recurse
                mark(node.childNodes[i], regex);
            }
        }
    }

    function Search(config) {
        if (config.element) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");
        }

        this._cacheElements(config.element);
        this._setupProperties(config.options);

        this._action = this._elements.form.getAttribute("action");
        this._resultsOffset = 0;
        this._hasMoreResults = true;

        this._elements.input.addEventListener("input", this._onInput.bind(this));
        this._elements.input.addEventListener("focus", this._onInput.bind(this));
        this._elements.input.addEventListener("keydown", this._onKeydown.bind(this));
        this._elements.clear.addEventListener("click", this._onClearClick.bind(this));
        document.addEventListener("click", this._onDocumentClick.bind(this));
        this._elements.results.addEventListener("scroll", this._onScroll.bind(this));

        this._makeAccessible();
    }

    Search.prototype._displayResults = function() {
        if (this._elements.input.value.length === 0) {
            toggleShow(this._elements.clear, false);
            this._cancelResults();
        } else if (this._elements.input.value.length < this._properties.minLength) {
            toggleShow(this._elements.clear, true);
        } else {
            this._updateResults();
            toggleShow(this._elements.clear, true);
        }
    };

    Search.prototype._onScroll = function(event) {
        // fetch new results when the results to be scrolled down are less than the visible results
        if (this._elements.results.scrollTop + 2 * this._elements.results.clientHeight >= this._elements.results.scrollHeight) {
            this._resultsOffset += this._properties.resultsSize;
            this._displayResults();
        }
    };

    Search.prototype._onInput = function(event) {
        var self = this;
        self._cancelResults();
        // start searching when the search term reaches the minimum length
        this._timeout = setTimeout(function() {
            self._displayResults();
        }, DELAY);
    };

    Search.prototype._onKeydown = function(event) {
        var self = this;

        switch (event.keyCode) {
            case keyCodes.TAB:
                if (self._resultsOpen()) {
                    event.preventDefault();
                }
                break;
            case keyCodes.ENTER:
                event.preventDefault();
                if (self._resultsOpen()) {
                    var focused = self._elements.results.querySelector(selectors.item.focused);
                    if (focused) {
                        focused.click();
                    }
                }
                break;
            case keyCodes.ESCAPE:
                self._cancelResults();
                break;
            case keyCodes.ARROW_UP:
                if (self._resultsOpen()) {
                    event.preventDefault();
                    self._stepResultFocus(true);
                }
                break;
            case keyCodes.ARROW_DOWN:
                if (self._resultsOpen()) {
                    event.preventDefault();
                    self._stepResultFocus();
                } else {
                    // test the input and if necessary fetch and display the results
                    self._onInput();
                }
                break;
            default:
                return;
        }
    };

    Search.prototype._onClearClick = function(event) {
        event.preventDefault();
        this._elements.input.value = "";
        toggleShow(this._elements.clear, false);
        toggleShow(this._elements.results, false);
    };

    Search.prototype._onDocumentClick = function(event) {
        var inputContainsTarget =  this._elements.input.contains(event.target);
        var resultsContainTarget = this._elements.results.contains(event.target);

        if (!(inputContainsTarget || resultsContainTarget)) {
            toggleShow(this._elements.results, false);
        }
    };

    Search.prototype._resultsOpen = function() {
        return this._elements.results.style.display !== "none";
    };

    Search.prototype._makeAccessible = function() {
        var id = NS + "-search-results-" + idCount;
        this._elements.input.setAttribute("aria-owns", id);
        this._elements.results.id = id;
        idCount++;
    };

    Search.prototype._generateItems = function(data, results) {
        var self = this;

        data.forEach(function(item) {
            var el = document.createElement("span");
            el.innerHTML = self._elements.itemTemplate.innerHTML;
            el.querySelectorAll(selectors.item.title)[0].appendChild(document.createTextNode(item.title));
            el.querySelectorAll(selectors.item.self)[0].setAttribute("href", item.url);
            results.innerHTML += el.innerHTML;
        });
    };

    Search.prototype._markResults = function() {
        var nodeList = this._elements.results.querySelectorAll(selectors.item.self);
        var escapedTerm = this._elements.input.value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
        var regex = new RegExp("(" + escapedTerm + ")", "gi");

        for (var i = this._resultsOffset - 1; i < nodeList.length; ++i) {
            var result = nodeList[i];
            mark(result, regex);
        }
    };

    Search.prototype._stepResultFocus = function(reverse) {
        var results = this._elements.results.querySelectorAll(selectors.item.self);
        var focused = this._elements.results.querySelector(selectors.item.focused);
        var newFocused;
        var index = Array.prototype.indexOf.call(results, focused);
        var focusedCssClass = NS + "-search__item--is-focused";

        if (results.length > 0) {

            if (!reverse) {
                // highlight the next result
                if (index < 0) {
                    results[0].classList.add(focusedCssClass);
                } else if (index + 1 < results.length) {
                    results[index].classList.remove(focusedCssClass);
                    results[index + 1].classList.add(focusedCssClass);
                }

                // if the last visible result is partially hidden, scroll up until it's completely visible
                newFocused = this._elements.results.querySelector(selectors.item.focused);
                if (newFocused) {
                    var bottomHiddenHeight = newFocused.offsetTop + newFocused.offsetHeight - this._elements.results.scrollTop - this._elements.results.clientHeight;
                    if (bottomHiddenHeight > 0) {
                        this._elements.results.scrollTop += bottomHiddenHeight;
                    } else {
                        this._onScroll();
                    }
                }

            } else {
                // highlight the previous result
                if (index >= 1) {
                    results[index].classList.remove(focusedCssClass);
                    results[index - 1].classList.add(focusedCssClass);
                }

                // if the first visible result is partially hidden, scroll down until it's completely visible
                newFocused = this._elements.results.querySelector(selectors.item.focused);
                if (newFocused) {
                    var topHiddenHeight = this._elements.results.scrollTop - newFocused.offsetTop;
                    if (topHiddenHeight > 0) {
                        this._elements.results.scrollTop -= topHiddenHeight;
                    }
                }
            }
        }
    };

    Search.prototype._updateResults = function() {
        var self = this;
        if (self._hasMoreResults) {
            var request = new XMLHttpRequest();
            var url = self._action + "?" + serialize(self._elements.form) + "&" + PARAM_RESULTS_OFFSET + "=" + self._resultsOffset;

            request.open("GET", url, true);
            request.onload = function() {
                // when the results are loaded: hide the loading indicator and display the search icon after a minimum period
                setTimeout(function() {
                    toggleShow(self._elements.loadingIndicator, false);
                    toggleShow(self._elements.icon, true);
                }, LOADING_DISPLAY_DELAY);
                if (request.status >= 200 && request.status < 400) {
                    // success status
                    var data = JSON.parse(request.responseText);
                    if (data.length > 0) {
                        self._generateItems(data, self._elements.results);
                        self._markResults();
                        toggleShow(self._elements.results, true);
                    } else {
                        self._hasMoreResults = false;
                    }
                    // the total number of results is not a multiple of the fetched results:
                    // -> we reached the end of the query
                    if (self._elements.results.querySelectorAll(selectors.item.self).length % self._properties.resultsSize > 0) {
                        self._hasMoreResults = false;
                    }
                } else {
                    // error status
                }
            };
            // when the results are loading: display the loading indicator and hide the search icon
            toggleShow(self._elements.loadingIndicator, true);
            toggleShow(self._elements.icon, false);
            request.send();
        }
    };

    Search.prototype._cancelResults = function() {
        clearTimeout(this._timeout);
        this._elements.results.scrollTop = 0;
        this._resultsOffset = 0;
        this._hasMoreResults = true;
        this._elements.results.innerHTML = "";
    };

    Search.prototype._cacheElements = function(wrapper) {
        this._elements = {};
        this._elements.self = wrapper;
        var hooks = this._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

        for (var i = 0; i < hooks.length; i++) {
            var hook = hooks[i];
            var capitalized = IS;
            capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
            var key = hook.dataset[NS + "Hook" + capitalized];
            this._elements[key] = hook;
        }
    };

    Search.prototype._setupProperties = function(options) {
        this._properties = {};

        for (var key in properties) {
            if (properties.hasOwnProperty(key)) {
                var property = properties[key];
                if (options && options[key] != null) {
                    if (property && typeof property.transform === "function") {
                        this._properties[key] = property.transform(options[key]);
                    } else {
                        this._properties[key] = options[key];
                    }
                } else {
                    this._properties[key] = properties[key]["default"];
                }
            }
        }
    };

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Search({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Search({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

})();

/*******************************************************************************
 * Copyright 2016 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var NS = "cmp";
    var IS = "formText";
    var IS_DASH = "form-text";

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]'
    };

    var properties = {
        /**
         * A validation message to display if there is a type mismatch between the user input and expected input.
         *
         * @type {String}
         */
        constraintMessage: {
        },
        /**
         * A validation message to display if no input is supplied, but input is expected for the field.
         *
         * @type {String}
         */
        requiredMessage: {
        }
    };

    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    function FormText(config) {
        if (config.element) {
            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");
        }

        this._cacheElements(config.element);
        this._setupProperties(config.options);

        this._elements.input.addEventListener("invalid", this._onInvalid.bind(this));
        this._elements.input.addEventListener("input", this._onInput.bind(this));
    }

    FormText.prototype._onInvalid = function(event) {
        event.target.setCustomValidity("");
        if (event.target.validity.typeMismatch) {
            if (this._properties.constraintMessage) {
                event.target.setCustomValidity(this._properties.constraintMessage);
            }
        } else if (event.target.validity.valueMissing) {
            if (this._properties.requiredMessage) {
                event.target.setCustomValidity(this._properties.requiredMessage);
            }
        }
    };

    FormText.prototype._onInput = function(event) {
        event.target.setCustomValidity("");
    };

    FormText.prototype._cacheElements = function(wrapper) {
        this._elements = {};
        this._elements.self = wrapper;
        var hooks = this._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS_DASH + "]");
        for (var i = 0; i < hooks.length; i++) {
            var hook = hooks[i];
            var capitalized = IS;
            capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
            var key = hook.dataset[NS + "Hook" + capitalized];
            this._elements[key] = hook;
        }
    };

    FormText.prototype._setupProperties = function(options) {
        this._properties = {};

        for (var key in properties) {
            if (properties.hasOwnProperty(key)) {
                var property = properties[key];
                if (options && options[key] != null) {
                    if (property && typeof property.transform === "function") {
                        this._properties[key] = property.transform(options[key]);
                    } else {
                        this._properties[key] = options[key];
                    }
                } else {
                    this._properties[key] = properties[key]["default"];
                }
            }
        }
    };

    function onDocumentReady() {
        var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new FormText({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new FormText({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }

})();

/*******************************************************************************
 * Copyright 2019 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/

/**
 * Element.matches()
 * https://developer.mozilla.org/enUS/docs/Web/API/Element/matches#Polyfill
 */
if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
}

// eslint-disable-next-line valid-jsdoc
/**
 * Element.closest()
 * https://developer.mozilla.org/enUS/docs/Web/API/Element/closest#Polyfill
 */
if (!Element.prototype.closest) {
    Element.prototype.closest = function(s) {
        "use strict";
        var el = this;
        if (!document.documentElement.contains(el)) {
            return null;
        }
        do {
            if (el.matches(s)) {
                return el;
            }
            el = el.parentElement || el.parentNode;
        } while (el !== null && el.nodeType === 1);
        return null;
    };
}

/*******************************************************************************
 * Copyright 2019 Adobe
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/
(function() {
    "use strict";

    var dataLayerEnabled;
    var dataLayer;

    var NS = "cmp";
    var IS = "accordion";

    var keyCodes = {
        ENTER: 13,
        SPACE: 32,
        END: 35,
        HOME: 36,
        ARROW_LEFT: 37,
        ARROW_UP: 38,
        ARROW_RIGHT: 39,
        ARROW_DOWN: 40
    };

    var selectors = {
        self: "[data-" + NS + '-is="' + IS + '"]'
    };

    var cssClasses = {
        button: {
            disabled: "cmp-accordion__button--disabled",
            expanded: "cmp-accordion__button--expanded"
        },
        panel: {
            hidden: "cmp-accordion__panel--hidden",
            expanded: "cmp-accordion__panel--expanded"
        }
    };

    var dataAttributes = {
        item: {
            expanded: "data-cmp-expanded"
        }
    };

    var properties = {
        /**
         * Determines whether a single accordion item is forced to be expanded at a time.
         * Expanding one item will collapse all others.
         *
         * @memberof Accordion
         * @type {Boolean}
         * @default false
         */
        "singleExpansion": {
            "default": false,
            "transform": function(value) {
                return !(value === null || typeof value === "undefined");
            }
        }
    };

    /**
     * Accordion Configuration.
     *
     * @typedef {Object} AccordionConfig Represents an Accordion configuration
     * @property {HTMLElement} element The HTMLElement representing the Accordion
     * @property {Object} options The Accordion options
     */

    /**
     * Accordion.
     *
     * @class Accordion
     * @classdesc An interactive Accordion component for toggling panels of related content
     * @param {AccordionConfig} config The Accordion configuration
     */
    function Accordion(config) {
        var that = this;

        if (config && config.element) {
            init(config);
        }

        /**
         * Initializes the Accordion.
         *
         * @private
         * @param {AccordionConfig} config The Accordion configuration
         */
        function init(config) {
            that._config = config;

            // prevents multiple initialization
            config.element.removeAttribute("data-" + NS + "-is");

            setupProperties(config.options);
            cacheElements(config.element);

            if (that._elements["item"]) {
                // ensures multiple element types are arrays.
                that._elements["item"] = Array.isArray(that._elements["item"]) ? that._elements["item"] : [that._elements["item"]];
                that._elements["button"] = Array.isArray(that._elements["button"]) ? that._elements["button"] : [that._elements["button"]];
                that._elements["panel"] = Array.isArray(that._elements["panel"]) ? that._elements["panel"] : [that._elements["panel"]];

                // Expand the item based on deep-link-id if it matches with any existing accordion item id
                var deepLinkItem = CQ.CoreComponents.container.utils.getDeepLinkItem(that, "item");
                if (deepLinkItem && !deepLinkItem.hasAttribute(dataAttributes.item.expanded)) {
                    setItemExpanded(deepLinkItem, true);
                }

                if (that._properties.singleExpansion) {
                    // No deep linking
                    if (!deepLinkItem) {
                        var expandedItems = getExpandedItems();
                        // no expanded item annotated, force the first item to display.
                        if (expandedItems.length === 0) {
                            toggle(0);
                        }
                        // multiple expanded items annotated, display the last item open.
                        if (expandedItems.length > 1) {
                            toggle(expandedItems.length - 1);
                        }
                    } else {
                        // Deep link case
                        // Collapse the items other than which is deep linked
                        for (var j = 0; j < that._elements["item"].length; j++) {
                            if (that._elements["item"][j].id !== deepLinkItem.id &&
                                that._elements["item"][j].hasAttribute(dataAttributes.item.expanded)) {
                                setItemExpanded(that._elements["item"][j], false);
                            }
                        }
                    }
                }

                refreshItems();
                bindEvents();

                if (window.Granite && window.Granite.author && window.Granite.author.MessageChannel) {
                    /*
                     * Editor message handling:
                     * - subscribe to "cmp.panelcontainer" message requests sent by the editor frame
                     * - check that the message data panel container type is correct and that the id (path) matches this specific Accordion component
                     * - if so, route the "navigate" operation to enact a navigation of the Accordion based on index data
                     */
                    CQ.CoreComponents.MESSAGE_CHANNEL = CQ.CoreComponents.MESSAGE_CHANNEL || new window.Granite.author.MessageChannel("cqauthor", window);
                    CQ.CoreComponents.MESSAGE_CHANNEL.subscribeRequestMessage("cmp.panelcontainer", function(message) {
                        if (message.data && message.data.type === "cmp-accordion" && message.data.id === that._elements.self.dataset["cmpPanelcontainerId"]) {
                            if (message.data.operation === "navigate") {
                                // switch to single expansion mode when navigating in edit mode.
                                var singleExpansion = that._properties.singleExpansion;
                                that._properties.singleExpansion = true;
                                toggle(message.data.index);

                                // revert to the configured state.
                                that._properties.singleExpansion = singleExpansion;
                            }
                        }
                    });
                }
            }
        }

        /**
         * Caches the Accordion elements as defined via the {@code data-accordion-hook="ELEMENT_NAME"} markup API.
         *
         * @private
         * @param {HTMLElement} wrapper The Accordion wrapper element
         */
        function cacheElements(wrapper) {
            that._elements = {};
            that._elements.self = wrapper;
            var hooks = that._elements.self.querySelectorAll("[data-" + NS + "-hook-" + IS + "]");

            for (var i = 0; i < hooks.length; i++) {
                var hook = hooks[i];
                if (hook.closest("." + NS + "-" + IS) === that._elements.self) { // only process own accordion elements
                    var capitalized = IS;
                    capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
                    var key = hook.dataset[NS + "Hook" + capitalized];
                    if (that._elements[key]) {
                        if (!Array.isArray(that._elements[key])) {
                            var tmp = that._elements[key];
                            that._elements[key] = [tmp];
                        }
                        that._elements[key].push(hook);
                    } else {
                        that._elements[key] = hook;
                    }
                }
            }
        }

        /**
         * Sets up properties for the Accordion based on the passed options.
         *
         * @private
         * @param {Object} options The Accordion options
         */
        function setupProperties(options) {
            that._properties = {};

            for (var key in properties) {
                if (properties.hasOwnProperty(key)) {
                    var property = properties[key];
                    var value = null;

                    if (options && options[key] != null) {
                        value = options[key];

                        // transform the provided option
                        if (property && typeof property.transform === "function") {
                            value = property.transform(value);
                        }
                    }

                    if (value === null) {
                        // value still null, take the property default
                        value = properties[key]["default"];
                    }

                    that._properties[key] = value;
                }
            }
        }

        /**
         * Binds Accordion event handling.
         *
         * @private
         */
        function bindEvents() {
            var buttons = that._elements["button"];
            if (buttons) {
                for (var i = 0; i < buttons.length; i++) {
                    (function(index) {
                        buttons[i].addEventListener("click", function(event) {
                            toggle(index);
                            focusButton(index);
                        });
                        buttons[i].addEventListener("keydown", function(event) {
                            onButtonKeyDown(event, index);
                        });
                    })(i);
                }
            }
        }

        /**
         * Handles button keydown events.
         *
         * @private
         * @param {Object} event The keydown event
         * @param {Number} index The index of the button triggering the event
         */
        function onButtonKeyDown(event, index) {
            var lastIndex = that._elements["button"].length - 1;

            switch (event.keyCode) {
                case keyCodes.ARROW_LEFT:
                case keyCodes.ARROW_UP:
                    event.preventDefault();
                    if (index > 0) {
                        focusButton(index - 1);
                    }
                    break;
                case keyCodes.ARROW_RIGHT:
                case keyCodes.ARROW_DOWN:
                    event.preventDefault();
                    if (index < lastIndex) {
                        focusButton(index + 1);
                    }
                    break;
                case keyCodes.HOME:
                    event.preventDefault();
                    focusButton(0);
                    break;
                case keyCodes.END:
                    event.preventDefault();
                    focusButton(lastIndex);
                    break;
                case keyCodes.ENTER:
                case keyCodes.SPACE:
                    event.preventDefault();
                    toggle(index);
                    focusButton(index);
                    break;
                default:
                    return;
            }
        }

        /**
         * General handler for toggle of an item.
         *
         * @private
         * @param {Number} index The index of the item to toggle
         */
        function toggle(index) {
            var item = that._elements["item"][index];
            if (item) {
                if (that._properties.singleExpansion) {
                    // ensure only a single item is expanded if single expansion is enabled.
                    for (var i = 0; i < that._elements["item"].length; i++) {
                        if (that._elements["item"][i] !== item) {
                            var expanded = getItemExpanded(that._elements["item"][i]);
                            if (expanded) {
                                setItemExpanded(that._elements["item"][i], false);
                            }
                        }
                    }
                    setItemExpanded(item, true);
                } else {
                    setItemExpanded(item, !getItemExpanded(item));
                }

                if (dataLayerEnabled) {
                    var accordionId = that._elements.self.id;
                    var expandedItems = getExpandedItems()
                        .map(function(item) {
                            return Object.keys(JSON.parse(item.dataset.cmpDataLayer))[0];
                        });

                    var uploadPayload = {component: {}};
                    uploadPayload.component[accordionId] = { shownItems: expandedItems };

                    var removePayload = {component: {}};
                    removePayload.component[accordionId] = { shownItems: undefined };

                    dataLayer.push(removePayload);
                    dataLayer.push(uploadPayload);
                }
            }
        }

        /**
         * Sets an item's expanded state based on the provided flag and refreshes its internals.
         *
         * @private
         * @param {HTMLElement} item The item to mark as expanded, or not expanded
         * @param {Boolean} expanded true to mark the item expanded, false otherwise
         */
        function setItemExpanded(item, expanded) {
            if (expanded) {
                item.setAttribute(dataAttributes.item.expanded, "");
                if (dataLayerEnabled) {
                    dataLayer.push({
                        event: "cmp:show",
                        eventInfo: {
                            path: "component." + getDataLayerId(item.dataset.cmpDataLayer)
                        }
                    });
                }

            } else {
                item.removeAttribute(dataAttributes.item.expanded);
                if (dataLayerEnabled) {
                    dataLayer.push({
                        event: "cmp:hide",
                        eventInfo: {
                            path: "component." + getDataLayerId(item.dataset.cmpDataLayer)
                        }
                    });
                }
            }
            refreshItem(item);
        }

        /**
         * Gets an item's expanded state.
         *
         * @private
         * @param {HTMLElement} item The item for checking its expanded state
         * @returns {Boolean} true if the item is expanded, false otherwise
         */
        function getItemExpanded(item) {
            return item && item.dataset && item.dataset["cmpExpanded"] !== undefined;
        }

        /**
         * Refreshes an item based on its expanded state.
         *
         * @private
         * @param {HTMLElement} item The item to refresh
         */
        function refreshItem(item) {
            var expanded = getItemExpanded(item);
            if (expanded) {
                expandItem(item);
            } else {
                collapseItem(item);
            }
        }

        /**
         * Refreshes all items based on their expanded state.
         *
         * @private
         */
        function refreshItems() {
            for (var i = 0; i < that._elements["item"].length; i++) {
                refreshItem(that._elements["item"][i]);
            }
        }

        /**
         * Returns all expanded items.
         *
         * @private
         * @returns {HTMLElement[]} The expanded items
         */
        function getExpandedItems() {
            var expandedItems = [];

            for (var i = 0; i < that._elements["item"].length; i++) {
                var item = that._elements["item"][i];
                var expanded = getItemExpanded(item);
                if (expanded) {
                    expandedItems.push(item);
                }
            }

            return expandedItems;
        }

        /**
         * Annotates the item and its internals with
         * the necessary style and accessibility attributes to indicate it is expanded.
         *
         * @private
         * @param {HTMLElement} item The item to annotate as expanded
         */
        function expandItem(item) {
            var index = that._elements["item"].indexOf(item);
            if (index > -1) {
                var button = that._elements["button"][index];
                var panel = that._elements["panel"][index];
                button.classList.add(cssClasses.button.expanded);
                button.setAttribute("aria-expanded", true);
                panel.classList.add(cssClasses.panel.expanded);
                panel.classList.remove(cssClasses.panel.hidden);
                panel.setAttribute("aria-hidden", false);

                if (that._properties.singleExpansion) {
                    button.classList.add(cssClasses.button.disabled);
                    button.setAttribute("aria-disabled", true);
                }
            }
        }

        /**
         * Annotates the item and its internals with
         * the necessary style and accessibility attributes to indicate it is not expanded.
         *
         * @private
         * @param {HTMLElement} item The item to annotate as not expanded
         */
        function collapseItem(item) {
            var index = that._elements["item"].indexOf(item);
            if (index > -1) {
                var button = that._elements["button"][index];
                var panel = that._elements["panel"][index];
                button.classList.remove(cssClasses.button.disabled);
                button.classList.remove(cssClasses.button.expanded);
                button.removeAttribute("aria-disabled");
                button.setAttribute("aria-expanded", false);
                panel.classList.add(cssClasses.panel.hidden);
                panel.classList.remove(cssClasses.panel.expanded);
                panel.setAttribute("aria-hidden", true);
            }
        }

        /**
         * Focuses the button at the provided index.
         *
         * @private
         * @param {Number} index The index of the button to focus
         */
        function focusButton(index) {
            var button = that._elements["button"][index];
            button.focus();
        }
    }

    /**
     * Reads options data from the Accordion wrapper element, defined via {@code data-cmp-*} data attributes.
     *
     * @private
     * @param {HTMLElement} element The Accordion element to read options data from
     * @returns {Object} The options read from the component data attributes
     */
    function readData(element) {
        var data = element.dataset;
        var options = [];
        var capitalized = IS;
        capitalized = capitalized.charAt(0).toUpperCase() + capitalized.slice(1);
        var reserved = ["is", "hook" + capitalized];

        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                var value = data[key];

                if (key.indexOf(NS) === 0) {
                    key = key.slice(NS.length);
                    key = key.charAt(0).toLowerCase() + key.substring(1);

                    if (reserved.indexOf(key) === -1) {
                        options[key] = value;
                    }
                }
            }
        }

        return options;
    }

    /**
     * Parses the dataLayer string and returns the ID
     *
     * @private
     * @param {String} componentDataLayer the dataLayer string
     * @returns {String} dataLayerId or undefined
     */
    function getDataLayerId(componentDataLayer) {
        return Object.keys(JSON.parse(componentDataLayer))[0];
    }

    /**
     * Document ready handler and DOM mutation observers. Initializes Accordion components as necessary.
     *
     * @private
     */
    function onDocumentReady() {
      dataLayerEnabled = document.body.hasAttribute("data-cmp-data-layer-enabled");
      dataLayer = (dataLayerEnabled)? window.adobeDataLayer = window.adobeDataLayer || [] : undefined;

      var elements = document.querySelectorAll(selectors.self);
        for (var i = 0; i < elements.length; i++) {
            new Accordion({ element: elements[i], options: readData(elements[i]) });
        }

        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var body = document.querySelector("body");
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                // needed for IE
                var nodesArray = [].slice.call(mutation.addedNodes);
                if (nodesArray.length > 0) {
                    nodesArray.forEach(function(addedNode) {
                        if (addedNode.querySelectorAll) {
                            var elementsArray = [].slice.call(addedNode.querySelectorAll(selectors.self));
                            elementsArray.forEach(function(element) {
                                new Accordion({ element: element, options: readData(element) });
                            });
                        }
                    });
                }
            });
        });

        observer.observe(body, {
            subtree: true,
            childList: true,
            characterData: true
        });
    }

    if (document.readyState !== "loading") {
        onDocumentReady();
    } else {
        document.addEventListener("DOMContentLoaded", onDocumentReady);
    }
}());

document.addEventListener("DOMContentLoaded", function(event) {
    var splashScreen = document.querySelector('.ss-outer-container');
    var sections = document.querySelectorAll('section');
    var header = document.querySelector('header');
    if (splashScreen) {
        var splashIdentifier = sanitizeString(sessionStorage.getItem("_tab_id"));
        if (sanitizeString(getCookie('spId')) === splashIdentifier) {
            var logos = document.querySelectorAll('.splash-logos');
            if (logos && logos.length > 0) {
                for (var i = 0; i < logos.length; i++) {
                    logos[i].removeAttribute('class');
                }
            }
            var splash50 = document.querySelector('.splash-center-logo');
            if (splash50) {
                splash50.innerHTML = '';
            }
            splashScreen.style.display = 'none';
            if (!splashScreen.classList.contains('fixed')) {
                splashScreen.classList.add('fixed');
            }
        } else {
            //document.cookie = "spId=" + splashIdentifier;
            if (header) {
                if (header.classList.contains('show-header')) {
                    header.classList.remove('show-header');
                }
            }
            if (splashScreen.classList.contains('fixed')) {
                splashScreen.classList.remove('fixed');
            }
        }
        showSections();
    }
    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) return parts.pop().split(";").shift();
    }
    function showSections() {
        var sectionsLength = sections.length;
        if (sectionsLength > 0) {
            for (var i = 0; i < sectionsLength; i++) {
                sections[i].style.visibility = 'visible';
            }
        }
    }
    function sanitizeString(filterString) {
        var sanitizedText = '';
        if (filterString) {
            var whiteListRegEx = /[^a-z0-9-]/gi;
            sanitizedText = filterString.replace(whiteListRegEx,'');
            return sanitizedText;
        }
    };
});
/* Define Global Variables */
var utils = {}; // All utils will be available on this object
var def = {}; // All defenitions required in global will be appneded to this object
var obj = {}; // All objects created and requird in global scope will be available in this object

(function() {
    utils.getScrollY = function() {
        return window.scrollY || document.documentElement.scrollTop;
    };

    utils.clamp = function(a, b, c) {
        return Math.max(b, Math.min(c, a));;
    };

    utils.isMobile = (function() {
        if (window.innerWidth <= 768) {
            return true;
        }
        return false;
    })();

    utils.isTablet = (function() {
        if (window.innerWidth <= 992) {
            return true;
        }
        return false;
    })();

    utils.isTouchDevice = function() {
        if (window.innerWidth < 1024) {
            return true;
        }
        return false;
    };
    
    utils.isTouchDevice1024 = function() {
        if (window.innerWidth <= 1024) {
            return true;
        }
        return false;
    };

    utils.isTabLandscape = function() {
        if (window.innerWidth >= 1024 && window.innerWidth < 1280) {
            return true;
        }
        return false;
    };
    utils.isSliderRequired = (function() {
        if (window.innerWidth <= 992) {
            return true;
        }
        return false;
    })();
    utils.isRecruiterSliderRequired = (function() {
        if (window.innerWidth < 768) {
            return true;
        }
        return false;
    })();


    utils.isIE = (function() {
        if (window.navigator.userAgent.indexOf("MSIE") !== -1 || window.navigator.userAgent.indexOf("Trident") !== -1) {
            return true;
        }
        return false;
    })();

	utils.mobileOsType = (function() {
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;
      // Windows Phone must come first because its UA also contains "Android"
    if (/windows phone/i.test(userAgent)) {
        return "Windows";
    }
    if (/android/i.test(userAgent)) {
        return "Android";
    }
    // iOS detection from: http://stackoverflow.com/a/9039885/177710
    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        return "iOS";
    }
    return "unknown";
    })();

	
    // Throttle scroll events to one per given time frame
    utils.throttle = function(callback, limit) {
        var wait = false;
        return function() {
            if (!wait) {
                callback.call();
                wait = true;
                setTimeout(function() {
                    wait = false;
                }, limit);
            }
        };
    };

    // Get hash object from URL
    utils.getURLHash = function() {
        var hash = {};
        var hashString = location.hash.substring(1); // Removes initial #
        var hashArray = hashString.split('&');
        var hashArrayLength = hashArray.length;
        var items;
        var key;
        var value;

        for (var i = 0; i < hashArrayLength; ++i) {
            items = hashArray[i].split('=');

            key = items[0];
            value = items[1];
            hash[key] = value;
        }

        return hash;
    };

    // Clear hash from URL
    utils.clearURLHash = function() {
        if (location.hash) {
            location.hash = '0';
        }
    };

    // Get sanitized URL
    // This will just removes any hashed data
    // TODO: need to add more sanitization logic's
    utils.getSanitizedURL = function() {
        var url = location.origin + location.pathname;
        return url;
    };
    // Get sanitized innerTEXT
    // This will remove html tags from inner text
    utils.getSanitizedText = function(text) {
        var sanitizedText = '';
        if (typeof(text) === 'string') {
            sanitizedText = text.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
        } else {
            sanitizedText = text;
        }
        return sanitizedText;
    };
    utils.supportsPassive = function() {
        var supportsPassive = false;
        // Check for passive event listener support
        try {
            var opts = Object.defineProperty({}, 'passive', {
                get: function() {
                    supportsPassive = true;
                }
            });
            window.addEventListener('test', null, opts);
        } catch (e) {}
        return supportsPassive;
    };
    // Get number of viewable card components in slider
    utils.getCardViewCount = function() {
    	if (utils.cardViewCount) {
            return utils.cardViewCount;
        }
        if (window.innerWidth >= 1440) {
            utils.cardViewCount = 3;
            return 3;
        } else if (window.innerWidth < 1440 && window.innerWidth > 900) {
            // utils.cardViewCount = 2;
            utils.cardViewCount = 3;
            return 3;
        } else {
            utils.cardViewCount = 0;
            return 0;
        }
    };
    utils.getCardsCount = function() {
        if (window.innerWidth >= 1440) {
            utils.cardViewCount = 1;
            return 1;
        } else if (window.innerWidth < 1440 && window.innerWidth > 900) {
            // utils.cardViewCount = 2;
            utils.cardViewCount = 1;
            return 1;
        } else {
            utils.cardViewCount = 0;
            return 0;
        }
    };
    utils.hasTouchSupport = function() {
        return ('ontouchstart' in window) ||
            window.DocumentTouch && document instanceof window.DocumentTouch ||
            navigator.msMaxTouchPoints > 0;
    };


    utils.serializeForm = function(form) {
        if (!form || form.nodeName !== "FORM") {
            return;
        }
        var i, j, q = [];
        for (i = form.elements.length - 1; i >= 0; i = i - 1) {
            if (form.elements[i].name === "") {
                continue;
            }
            switch (form.elements[i].nodeName) {
                case 'INPUT':
                    switch (form.elements[i].type) {
                        case 'text':
						case 'date':
                        case 'number':
                        case 'hidden':
                        case 'password':
                        case 'button':
                        case 'reset':
                        case 'submit':
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            break;
                        case 'checkbox':
                        case 'radio':
                            if (form.elements[i].checked) {
                            	 if (form.elements[i].getAttribute('data-attr') == "no-add") {
                                     break;
                                 }
                                 else {
                                      q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                                 }

                            }
                            break;
                        case 'file':
                            break;
                    }
                    break;
                case 'TEXTAREA':
                	 q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value.replace(/(\r\n|\n|\r)/gm," ")));
                    break;
                case 'SELECT':
                    switch (form.elements[i].type) {
                        case 'select-one':
                        	if (form.elements[i].getAttribute('data-attr') == "no-add") {
                                break;
                            }
                            else {
	                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
	                            break;
                            }
                        case 'select-multiple':
                            for (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {
                                if (form.elements[i].options[j].selected) {
                                    q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].options[j].value));
                                }
                            }
                            break;
                    }
                    break;
                case 'BUTTON':
                    switch (form.elements[i].type) {
                        case 'reset':
                        case 'submit':
                        case 'button':
                            q.push(form.elements[i].name + "=" + encodeURIComponent(form.elements[i].value));
                            break;
                    }
                    break;
            }
        }
        return q.join("&");
    };

    utils.getQueryStringFromUrl = function(key, url) {
        var regex;
        var results = [];
        var value;
        // Set url if not-available
        if (!url) url = window.location.href;
        // Sanitize key
        key = key.replace(/[\[\]]/g, "\\$&");
        // Set RegExp
        regex = new RegExp("[?&]" + key + "(=([^&#]*)|&|#|$)");
        // Get Results
        results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        // Sanitize and decode value
        value = results[2].replace(/\+/g, " ");
        return decodeURIComponent(value);
    };

    utils.updateQueryStringInUrl = function(key, value, url) {
        var regEx;
        var hash = [];
        // Set url if not-available
        if (!url) url = window.location.href;
        // Set RegExp
        regEx = new RegExp("([?&])" + key + "=.*?(&|#|$)(.*)", "gi");
        // Check url already have the key
        if (regEx.test(url)) {
            // Check for value
            if (typeof value !== 'undefined' && value !== null) {
                return url.replace(regEx, '$1' + key + '=' + value + '$2$3');
            }
            // Handle cases with '#'
            else {
                // Update query
                hash = url.split('#');
                url = hash[0].replace(regEx, '$1$3').replace(/(&|\?)$/, '');
                // Add Hash
                if (typeof hash[1] !== 'undefined' && hash[1] !== null) {
                    url += '#' + hash[1];
                }
                return url;
            }
        }
        else {
            // Check for value
            if (typeof value !== 'undefined' && value !== null) {
                // Add new query
                var separator = url.indexOf('?') !== -1 ? '&' : '?';
                hash = url.split('#');
                url = hash[0] + separator + key + '=' + value;
                // Add Hash
                if (typeof hash[1] !== 'undefined' && hash[1] !== null) {
                    url += '#' + hash[1];
                }
                return url;
            }
            // Return unmodified url
            else {
                return url;
            }
        }
    };

    /* Checking whether the date is valid or not */
    utils.isValidDate = function(s) {
        var day, A= s.split('-');
        A[1] -= 1;
        day= new Date(A[2], A[1], A[0]);
        if (day.getMonth() == A[1] && day.getDate() == A[0]) {
            return true;
        }
        return false;
    }

})();
(function() {
    'use strict';

    var Router = function() {
        this.init = init;
        this.addEvents = addEvents;
        this.getURLHash = getURLHash;
        this.clearURLHash = clearURLHash;
        this.router = router;
        this.init();

        function init() {
            this.name = 'Router';
            this.searchIcon = document.querySelector('.search-icon');
            this.previousUrl = '#0';
            this.addEvents();
        };

        function addEvents() {
            var _this = this;
            if (this.searchIcon) {
                this.searchIcon.href = '#0';
            }

            window.addEventListener("hashchange", function() {
                _this.router();
                var hashObject = _this.getURLHash();
                if (hashObject.type !== 'search') {
                    _this.previousUrl = utils.getSanitizedText(location.hash);
                } else {
                    _this.previousUrl = '#0';
                }
            }, false);
        };

        function router() {
            var hashObject = this.getURLHash();
            //if (hashObject.type || window.location.hash === '#0') {
                if (!hashObject.type) {
                    hashObject.type = utils.getSanitizedText(window.location.hash);
                }
                switch (hashObject.type) {
                    case 'search':
                        if (this.previousUrl) {
                            this.searchIcon.href = this.previousUrl;
                        }
                        obj.header.onHashChange();
                        break;

                    case 'overlay':
                        obj.overlay.onHashChange();
                        break;
						
					case 'overlay-perspectives':
                    obj.overlay.onHashChange();
                    break;

                    case 'open':
                        obj.InvestorGlossaryContent.onHashChange();
                        break;

                    case '#0':
                        obj.header.onHashChange();
                        obj.overlay.onHashChange();
                        break;

                    default:
                        obj.header.onHashChange();
                        obj.overlay.onHashChange();
                        break;
                }
           // }
        };

        function getURLHash() {
            var hash = {};
            var hashString = location.hash.substring(1); // Removes initial #
            var hashArray = hashString.split('&');
            var hashArrayLength = hashArray.length;
            var items;
            var key;
            var value;
            for (var i = 0; i < hashArrayLength; ++i) {
                items = hashArray[i].split('=');
                key = utils.getSanitizedText(items[0]);
                value = utils.getSanitizedText(items[1]);
                hash[key] = utils.getSanitizedText(value);
            }
            return hash;
        };

        function clearURLHash() {
            if (location.hash) {
                location.hash = '0';
            }
        };
    };
    window.def.Router = Router;
    obj.router = new def.Router();
})();
(function() {
    'use strict';
    def.Accordion = function(element, accordianStatus) {
        this.name = 'Accordion';
        this.contactWrapper = document.querySelector('.contactus-content-wrapper');
        this.header = document.querySelector('header');
        this.overlayWrapper = document.querySelector('.page-overlay .show');
        this.eventBinded = (typeof accordianStatus === "undefined") ? true : accordianStatus;
        this.glossaryContent = document.querySelector('.investor-glossary-content');

        if (element) {
            this.elm = element;
            this.aHeaders = element.querySelectorAll('.accordion-head');
            this.items = element.querySelectorAll('.accordion-item');
            this.aExpandCollOption = element.querySelector('.accord-expand-collapse-all');
            this.aExpandAllLabel = element.querySelector('.expand-all-label');
            this.aCollapseAllLabel = element.querySelector('.collapse-all-label');
            this.init();
        }
    };
    var p = def.Accordion.prototype;
    def.Accordion.prototype.constructor = def.Accordion;

    p.init = function() {
        var _this = this;
        if (this.eventBinded) {
            //console.log(this.aHeaders.length);
            for (var i = 0; i < this.aHeaders.length; i++) {
                _this.aHeaders[i].addEventListener('click', function(event) {
                    _this.onClickAccordion(event, this);
                }, false);
                _this.aHeaders[i].addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13)
                        _this.onClickAccordion(event, this);
                }, false);
            }
            if (this.aExpandCollOption) {
                _this.aExpandCollOption.addEventListener('click', function(event) {
                    if (_this.aExpandAllLabel.classList.contains('active')) {
                        _this.aExpandAllLabel.classList.remove('active');
                        _this.aCollapseAllLabel.classList.add('active');
                        _this.aExpandCollOption.querySelector('span').classList.remove('icon-ic_expand');
                        _this.aExpandCollOption.querySelector('span').classList.add('icon-ic_collapse');
                        _this.setAllExpanded(_this.aHeaders);
                    } else {
                        _this.aCollapseAllLabel.classList.remove('active');
                        _this.aExpandAllLabel.classList.add('active');
                        _this.aExpandCollOption.querySelector('span').classList.remove('icon-ic_collapse');
                        _this.aExpandCollOption.querySelector('span').classList.add('icon-ic_expand');
                    _this.setAllCollapsed(_this.aHeaders);
                    }

                }, false);
            }
        }
    };

    p.onClickAccordion = function(event, element) {
        var parentElm = element.parentNode;
        var alreadyExpanded = parentElm.classList.contains('expanded');
        var isAccordCollapseAllLabelActive, expandedItem,expandedItemsCount;

         if (this.aExpandCollOption) {
            isAccordCollapseAllLabelActive = this.aCollapseAllLabel.classList.contains('active')
         }

        if (isAccordCollapseAllLabelActive) {
            if (alreadyExpanded) {
                expandedItem = parentElm;
            }
        } else {
            expandedItem = this.elm.querySelector('.accordion-item.expanded');
        }


        this.panelItem = parentElm.childNodes[3];
        this.panelHead = parentElm.querySelector('.accordion-head');
        this.accordionContentItems = document.querySelectorAll('.accordion-content');
        this.accordionHeaders = document.querySelectorAll('.accordion-head');
        if (expandedItem) {
             if (this.aExpandCollOption) {
                if (this.aCollapseAllLabel.classList.contains('active')){
                    expandedItemsCount = this.elm.querySelectorAll('.accordion-item.expanded').length;
                    //change Collapse All icon and label , if user try to collapse the last expandedItem
                    if(expandedItemsCount == 1){
                        this.aCollapseAllLabel.classList.remove('active');
                        this.aExpandAllLabel.classList.add('active');
                        this.aExpandCollOption.querySelector('span').classList.remove('icon-ic_collapse');
                        this.aExpandCollOption.querySelector('span').classList.add('icon-ic_expand');
                    }
                }
             }
            expandedItem.classList.remove('expanded');
            expandedItem.classList.add('collapsed');
            element.setAttribute('aria-expanded', 'false');
            element.setAttribute('aria-selected', 'false');
            expandedItem.querySelector('.accordion-head span').classList.remove('icon-ic_collapse');
            expandedItem.querySelector('.accordion-head span').classList.add('icon-ic_expand');
            this.panelItem.setAttribute('aria-hidden', true);
            this.panelHead.setAttribute('aria-selected', false);
            this.panelHead.setAttribute('aria-expanded', false);
        }

        if (!alreadyExpanded) {
            parentElm.classList.remove('collapsed');
            parentElm.classList.add('expanded');
            element.setAttribute('aria-expanded', 'true');
            element.setAttribute('aria-selected', 'true');
            parentElm.querySelector('.accordion-head span').classList.remove('icon-ic_expand');
            parentElm.querySelector('.accordion-head span').classList.add('icon-ic_collapse');
            for (var i = 0; i < this.accordionHeaders.length; i++) {
                this.accordionHeaders[i].setAttribute('aria-selected', false);
                this.accordionHeaders[i].setAttribute('aria-expanded', false);
            }
            this.panelHead.setAttribute('aria-selected', true);
            this.panelHead.setAttribute('aria-expanded', true);
            for (var j = 0; j < this.accordionContentItems.length; j++) {
                this.accordionContentItems[j].setAttribute('aria-hidden', true);
            }
            this.panelItem.setAttribute('aria-hidden', false);
            if (this.glossaryContent) {
                setTimeout(function() {
                    window.scrollTo(parentElm.offsetLeft, parentElm.offsetTop);
                }, 1000);
            }
        }
    };

    p.setExpanded = function(itemName) {
        var itemLength = this.items.length;
        var item;

        if (!itemName) return;

        if (this.elm.querySelector('.accordion-item.expanded')) {
            this.elm.querySelector('.accordion-item.expanded').classList.remove('expanded');
        }

        for (var i = 0; i < itemLength; ++i) {
            item = this.items[i]
            if (item.getAttribute('data-item-name') === itemName) {
                item.classList.add('expanded');
                break;
            }

        }
    };

    p.setAllExpanded = function(items) {
        var itemLength = items.length;
        var scrollPosition = window.pageYOffset;
        this.scrollPosition = scrollPosition;
        for (var i = 0; i < itemLength; ++i) {
            var item = items[i];
            var itemParentNode = item.parentNode;
            if (!itemParentNode.classList.contains('expanded')) {
                itemParentNode.classList.add('expanded');
                itemParentNode.classList.remove('collapsed');

                item.setAttribute('aria-expanded', 'false');
                item.setAttribute('aria-selected', 'false');
                item.querySelector('span').classList.remove('icon-ic_expand');
                item.querySelector('span').classList.add('icon-ic_collapse');
                itemParentNode.setAttribute('aria-hidden', true);
                itemParentNode.setAttribute('aria-selected', false);
                itemParentNode.setAttribute('aria-expanded', false);
            }
        }
        //this.tagName = document.querySelectorAll('.form-info a');
        //var _this = this;
        //if (this.tagName) {
            //for (var i = 0; i < this.tagName.length; i++){
                //this.tagName[i].addEventListener('click', function(e) {
                  //  _this.setAllCollapsed(_this.aHeaders);
               // }, false);
            //}
        //}
    };

    p.setAllCollapsed = function(items) {
        var itemLength = items.length;
        for (var i = 0; i < itemLength; ++i) {
            var item = items[i];
            var itemParentNode = item.parentNode;
            if (!itemParentNode.classList.contains('collapsed')) {
                itemParentNode.classList.remove('expanded');
                itemParentNode.classList.add('collapsed');

                item.setAttribute('aria-expanded', 'false');
                item.setAttribute('aria-selected', 'false');
                item.querySelector('span').classList.remove('icon-ic_collapse');
                item.querySelector('span').classList.add('icon-ic_expand');
                itemParentNode.setAttribute('aria-hidden', true);
                itemParentNode.setAttribute('aria-selected', false);
                itemParentNode.setAttribute('aria-expanded', false);
            }
            window.scrollTo(window.scrollX, this.scrollPosition);
        }
    };
})();
(function () {
    'use strict';
      def.AudioControlHub = {
            isPlaying: false,
            isPlayingInNormalMode: function(element, isPlaying) {
                this.isPlaying = isPlaying;
            },
            isAudioPlaying: function() {
                return (this.isPlaying);
            }
        };

        def.Audio = function(element) {

        if (!element) {
            return;
        }
        this.name = 'Audio';
        this.elm = element;
        this.audioDuration;
        this.audioPlay = element.querySelector('.audio-container .audio-play');
        this.audioControl = element.querySelector('.audio-play-button');
        this.audioPlayhead = element.querySelector('.audio-container .audio-control .audio-stream .audio-timeline .audio-playhead');
        this.audioProgressbar = element.querySelector('.audio-container .audio-control .audio-stream .audio-timeline .play-progress');
        this.audioProgressbuffer = element.getElementsByClassName('play-buffer')[0];
        this.audioTimeLine = element.querySelector('.audio-container .audio-control .audio-stream .audio-timeline');
        this.audioDuration = element.querySelector('.audio-container .audio-control .audio-stream .audio-full-duration');
        this.audioCurrentTime = element.querySelector('.audio-container .audio-control .audio-stream .audio-current-position');
        this.muteButton = element.querySelector('.audio-container .audio-control .audio-buttons .audio-volume-button');
        this.audioVolumeProgressbar = element.querySelector('.audio-container .audio-control .audio-buttons .audio-volume-timeline .audio-volume-progress');
        this.audioVolumePlayhead = element.querySelector('.audio-container .audio-control .audio-buttons .audio-volume-timeline .audio-volume-playhead');
        this.audioVolumeTimeLine = element.querySelector('.audio-container .audio-control .audio-buttons .audio-volume-timeline');
        this.audioVolumeWrapper = element.getElementsByClassName('audio-volume-wrapper')[0];
        this.progressBar = element.querySelector('.audio-progress');
        this.init();
    };
    var p = def.Audio.prototype;
    def.Audio.prototype.constructor = def.Audio;

    p.init = function () {
        var _this = this;
        _this.audioPlay.volume =  0.5;
         _this.audioVolumePlayhead.style.left = 50 + '%';
         _this.audioVolumeProgressbar.style.width = 50 + '%';
         _this.touchStartX = 0;
         _this.touchOffset = 0;
         if (this.audioPlay) {
        	 eventFunction(this.audioPlay); //  For audio analytics
             this.audioPlay.addEventListener('loadedmetadata', function() {
                 var durationInSeconds = parseInt(_this.audioPlay.duration, 10);
                 _this.audioDuration.innerHTML = _this.timeFormat(durationInSeconds)
             }, false);
         }
         this.callPlayPauseAudio();
       //Hide Volume Controlles in Ipad
         if (navigator.userAgent.match(/iPad/i) != null) {
             this.muteButton.classList.add("hide");
             this.audioVolumeWrapper.classList.add("hide");
         }
         this.preloadImages();
    };
    
    p.clickPercent = function(e) {
    	var clickPerc = 0;
        if (e.offsetX  === undefined)
        {
        	clickPerc =  this.touchOffset / this.audioTimeLine.offsetWidth ;
        }
        else{
             
        	clickPerc = e.offsetX / this.audioTimeLine.offsetWidth;
        }
        
        if(clickPerc > 1){
            clickPerc = 1;
        }
        
        else if(clickPerc < 0){
            clickPerc = 0;
        }

        return clickPerc;
    };
    p.audioPercent = function (e) {
        return e.offsetX / this.audioVolumeTimeLine.offsetWidth;
    };
    p.timeFormat = function (durationInSeconds) {
        var hours = Math.floor(durationInSeconds / 3600);
        var minutes = Math.floor((durationInSeconds - (hours * 3600)) / 60);
        var seconds = durationInSeconds - (hours * 3600) - (minutes * 60);
        var time = 0;
        if (hours < 10) {
            hours = "0" + hours;
        }
        if (minutes < 10) {
            minutes = "0" + minutes;
        }
        if (seconds < 10) {
            seconds = "0" + seconds;
        }
        if (hours === '00') {
            if (minutes === '00') {
                time = '0' + ':' + seconds;
            } else {
                time = minutes + ':' + seconds;
            }
        } else {
            time = hours + ':' + minutes + ':' + seconds;
        }
        return time;
    }
    p.moveAudio = function(event) {
        var _this = this;
        if (event.target.className != "audio-playhead") {
            if (_this.progressBar.classList.contains('hide')) {
                _this.progressBar.classList.remove('hide');
            }
            _this.audioProgressbuffer.style.width = _this.clickPercent(event) * 100 + '%';
            _this.audioPlayhead.style.left = _this.clickPercent(event) * 100 + '%';
            _this.audioProgressbar.style.width = _this.clickPercent(event) * 100 + '%';
            _this.audioPlay.currentTime = _this.audioPlay.duration * (_this.clickPercent(event));
            var durationInSeconds = parseInt(_this.audioPlay.currentTime, 10); // don't forget the second param
            _this.timeFormat(durationInSeconds);
            if (_this.audioPlay.paused) {
                _this.audioPlay.play();
            }
            _this.audioControl.classList.remove('audio-play-button');
            _this.audioControl.classList.add('audio-pause-button');
        }
    }

     p.moveVolume = function(event) {
        var _this = this;
        if (event.target.className != "audio-volume-playhead") {
            event.preventDefault();
            var audioPercentage = _this.audioPercent(event);
            _this.audioVolumePlayhead.style.left = audioPercentage * 100 + '%';
            _this.audioVolumeProgressbar.style.width = audioPercentage * 100 + '%';
            _this.audioPlay.volume = audioPercentage.toFixed(1);
            if (_this.audioPlay.muted === true) {
                _this.audioPlay.muted = false;
            }
            if (_this.audioPlay.volume < 0.5) {
                if (_this.audioPlay.volume === 0 ||_this.audioPlay.volume < 0 ) {
                    _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_off.svg)';
                } else {
                    _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_low.svg)';
                }
            }
            else if (_this.audioPlay.volume > 0.5) {
                _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_high.svg)';
            }

        }
    }

     p.callPlayPauseAudio = function() {
        var _this = this;
        if (this.audioControl) {
            this.audioControl.addEventListener('play', function() {
                 if (_this.audioPlay.paused) {
                    _this.audioPlay.play();
                }
                _this.audioControl.classList.remove('audio-play-button');
                _this.audioControl.classList.add('audio-pause-button');
                def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, true);
            }, false);

            this.audioControl.addEventListener('click', function() {
                if (_this.audioPlay.paused) {
                    def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, true);
                    _this.audioPlay.play();
                    _this.audioControl.classList.remove('audio-play-button');
                    _this.audioControl.classList.add('audio-pause-button');
                    if (_this.audioPlay.readyState !== 4) {
                        _this.progressBar.classList.remove('hide');
                    }
                } else {
                    _this.audioPlay.pause();
                    _this.audioControl.classList.remove('audio-pause-button');
                    _this.audioControl.classList.add('audio-play-button');
                    def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, false);
                }
                return false;
            }, false);
            this.audioControl.addEventListener('keydown', function(event) {
                if (event.which == 13) {
                    if (_this.audioPlay.paused) {
                        def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, true);
                        _this.audioPlay.play();
                        _this.audioControl.classList.remove('audio-play-button');
                        _this.audioControl.classList.add('audio-pause-button');
                        if (_this.audioPlay.readyState !== 4) {
                            _this.progressBar.classList.remove('hide');
                        }
                    } else {
                        _this.audioPlay.pause();
                        _this.audioControl.classList.remove('audio-pause-button');
                        _this.audioControl.classList.add('audio-play-button');
                        def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, false);
                    }
                }
                return false;
            }, false);
        }

        if (this.audioPlay) {
            this.audioPlay.addEventListener('ended', function myHandler(e) {
                _this.audioControl.classList.remove('audio-pause-button');
                _this.audioControl.classList.add('audio-play-button');
                def.AudioControlHub.isPlayingInNormalMode(_this.audioPlay, false);
            }, false);

            this.audioPlay.addEventListener('progress', function() {
                if (_this.audioPlay.buffered.length > 0) {
                    var bufferedEnd = _this.audioPlay.buffered.end(_this.audioPlay.buffered.length - 1);
                    var bufferedStart = _this.audioPlay.buffered.start(_this.audioPlay.buffered.length - 1);
                    var duration = _this.audioPlay.duration;

                    var time = _this.audioPlay.currentTime;
                    var range = 0;
                    var falgDisplay = 0;

                    for (var i = 0; i < _this.audioPlay.buffered.length; i++) {
                        if ((_this.audioPlay.buffered.start(range) <= time && time <= _this.audioPlay.buffered.end(range))) {
                            range = range + 1;
                            falgDisplay = 1;
                            break;
                        } else {
                            range += 1;
                        }
                    }
                    if ((_this.audioPlay.buffered.length > 0 && falgDisplay == 1) || (_this.audioPlay.buffered.length > 0 && falgDisplay == 0 && bufferedEnd < time)) {
                        var bufferPercent = ((_this.audioPlay.buffered.end(range - 1) / duration) * 100);
                        _this.audioProgressbuffer.style.width = bufferPercent + '%';
                    }
                }
            
            });

            this.audioPlay.addEventListener('timeupdate', function () {
                var playPercent = 100 * (_this.audioPlay.currentTime / _this.audioPlay.duration);
                _this.audioPlayhead.style.left = playPercent + '%';
                _this.audioProgressbar.style.width = playPercent + '%';
                var durationInSeconds = parseInt(_this.audioPlay.currentTime, 10);
                _this.audioCurrentTime.innerHTML = _this.timeFormat(durationInSeconds);
                if (_this.audioPlay.readyState < 2) {
                    if (_this.progressBar.classList.contains('hide')) {
                        _this.progressBar.classList.remove('hide');
                    }
                
                }
                else {
                    if (!_this.progressBar.classList.contains('hide')) {
                        _this.progressBar.classList.add('hide');
                    }
                }

           
                return false;
            }, false);

            this.audioPlay.addEventListener('waiting', function() {
                _this.progressBar.classList.remove('hide');
            }, false);
        }

        

        if (this.audioTimeLine) {
            this.audioTimeLine.addEventListener('click', function(e) {
                this.moveAudio(e);
            }.bind(this), false);
        }

        if (this.audioVolumeWrapper) {
            this.audioVolumeWrapper.addEventListener('click', function(e) {
                this.moveVolume(e);
            }.bind(this), false);
        }

        if (this.muteButton) {
            this.muteButton.addEventListener("click", function() {
                if (_this.audioPlay.muted == false) {
                    _this.audioPlay.muted = true;
                    _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_off.svg)';
                     _this.audioVolumeProgressbar.style.width ='0%';
                    _this.audioVolumePlayhead.style.left = '0%';
                    _this.audioplay.volume = 0;

                 //   _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_off.svg)';

                } else {
                     _this.muteButton.style.backgroundImage = 'url(/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_high.svg)';
                     _this.audioVolumeProgressbar.style.width ='50%';
                    _this.audioPlay.muted = false;
                    _this.audioVolumePlayhead.style.left = '50%';
                    _this.audioplay.volume = 0.5;


                }
            });
        }

        if (this.audioPlayhead) {
            
            this.audioPlayhead.onmousedown = function(ev) {
            	ev.preventDefault();
                this.audioTimeLine.onmousemove = function(event) {
                        this.moveAudio(event)
                }.bind(this);
                document.onmouseup = function() {
                        this.audioTimeLine.onmousemove = null;
                }.bind(this);
            }.bind(this);
             
            this.audioPlayhead.ondrag = function() {
                 this.audioTimeLine.onmousemove = null;
            
            }.bind(this);

            this.audioTimeLine.addEventListener('touchstart', function(e) {
                this.touchStartX = e.changedTouches[0].pageX;
            }.bind(this),utils.supportsPassive() ? {
                passive: true
            } : false);


            this.audioTimeLine.addEventListener('touchmove', function(e) {
                e.preventDefault();
            }.bind(this));

            this.audioTimeLine.addEventListener('touchend', function(e) {
                var touchEndX = e.changedTouches[0].pageX;
                var leftOffset = parseInt(this.audioPlayhead.style.left) * this.audioTimeLine.offsetWidth / 100;
                var touchMoveDiff = touchEndX - this.touchStartX;
                if (touchMoveDiff > 0) {
                    this.touchOffset = leftOffset + touchMoveDiff;
                }
                else {
                    this.touchOffset = leftOffset - Math.abs(touchMoveDiff);
                }
                if (touchMoveDiff != 0) {
                    e.preventDefault();
                }
                this.moveAudio(e);
            }.bind(this));
        }

        if (this.audioVolumePlayhead) {
            this.audioVolumePlayhead.onmousedown = function(ev) {
            	ev.preventDefault();
                this.audioVolumeWrapper.onmousemove = function(event) {
                    this.moveVolume(event);
                }.bind(this);
                document.onmouseup = function() {
                    this.audioVolumeWrapper.onmousemove = null;
                }.bind(this);
            }.bind(this);
            this.audioVolumePlayhead.ondrag = function() {
                this.audioVolumeWrapper.onmousemove = null;
            }.bind(this);
        }
    };
    p.preloadImages = function() {
        var objImages = new Array();
        var imageCollection = ['/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_off.svg',
                               '/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_low.svg'];
        for (var index = 0; index < imageCollection.length; index++) {
            objImages[index] = new Image();
            objImages[index].src = imageCollection[index];
        }
    };

})();

(function() {
    'use strict';
    /**
     * @function
     * @name Slider
     * @param sliderConfig {Object} The config object through which the slider is getting invoked
     * And it must have the properties as follows
     * cardListContainerWrapper {HTMLObject} : The wrapper container for all the cards through which the slider is getting invoked
     * cardListContainer {HTMLObject} : The list container for all the cards to which the transform is done
     * cards {NodeList} : The cards through which the navigation of the slider is attached
     * navButtons {NodeList} : The nav buttons through which the navigation of the slider is attached
     * navArrowButtons {NodeList} : The arrow buttons for which the slider is going to implement
     * cardViewCount {number} : The number of viewable card count in desktop devices
     * gutterWidth {number} : The white space taken in between the cards , it should get added to get the total width of the list
     * @desc The factory function for the card slider
     * @returns {null}
     */
    var Slider = function(sliderConfig) {
        // Instance Methods
        this.init = init;
        this.addEvents = addEvents;
        this.setLayout = setLayout;
        this.touchStartHandler = touchStartHandler;
        this.touchEndHandler = touchEndHandler;
        this.decideSlideForMobile = decideSlideForMobile;
        this.changeActiveSelection = changeActiveSelection;
        this.slide = slide;
        this.navSlideHandler = navSlideHandler;
        this.decideSlideForLargeScreen = decideSlideForLargeScreen;
        // Invoke the init method
        this.init(sliderConfig);
        // Init slider
        function init(config) {
            this.cardListContainerWrapper = config.cardListContainerWrapper || {};
            this.cardListContainer = config.cardListContainer || {};
            this.cards = config.cards || [];
            this.navButtons = config.navButtons || [];
            this.navArrowButtons = config.navArrowButtons || [];
            this.cardViewCount = config.cardViewCount || 0;
            this.gutterWidth = config.gutterWidth || 0;
            this.startPageX = 0;
            this.endPageX = 0;
            this.activeIndex = 1; // Set the first card as active initially
            this.viewAllRequired = config.viewAllRequired;
            this.cardListContainerWidth = 0;
            this.cardWrapWidth = config.wrapperWidth || 0;
            this.viewAllgreaterThanFour = config.viewAllgreaterThanFour;
            // Invoke addEvents method
            window.addEventListener("load", this.addEvents.bind(this));
        };
        // Setlayout for slider implementation
        function setLayout(width) {
            if (utils.isTouchDevice()) {
                this.cardListContainer.style.width = width + 'px';
            } else {
                this.cardListContainer.style.width = width + this.gutterWidth + 'px';
            }
        }
        // Attach touch events to cards and nav buttons
        function addEvents() {
            try {
            	
                var _this = this;
                var cardListContainerWidth = 0;
                var minCardWidth = 0;
                var hashObject = utils.getURLHash();
                if (this.navArrowButtons.length > 0) {
                    this.cardListContainerWrapper.querySelector(".cws-arrows.right").classList.remove('hide');
                    this.cardListContainerWrapper.querySelector(".cws-arrows.left").classList.remove('hide');
                }
                // Add touch events to cards
                for (var iterator = 0; iterator < this.cards.length; iterator++) {
                    // Add "active" class to first card
                    if (iterator === 0) {
                        this.cards[iterator].classList.add('active');
                        this.navButtons[iterator].classList.add('active');
                        if (this.navArrowButtons.length > 0) {
                            this.navArrowButtons[iterator].classList.add('hide');
                        }
                    }
                    cardListContainerWidth += this.cards[iterator].getBoundingClientRect().width;
                    if ((iterator === (this.cards.length - 1)) && (this.cards.length > 3))
                    {
                        cardListContainerWidth += 30;
                    }
                    minCardWidth = this.cards[0].getBoundingClientRect().width * 3;
                    if (utils.isTouchDevice() && !this.viewAllRequired) {
                    	 this.cards[iterator].addEventListener('touchstart', _this.touchStartHandler.bind(_this),utils.supportsPassive() ? {
                             passive: true
                         } : false);

                        this.cards[iterator].addEventListener('touchend', _this.touchEndHandler.bind(_this));
                        this.navButtons[iterator].addEventListener('touchstart', _this.navSlideHandler.bind(_this),utils.supportsPassive() ? {
                            passive: true
                        } : false);

                        this.navButtons[iterator].setAttribute('data-slider-index', iterator + 1);
                    } else {
                        if (iterator < this.navArrowButtons.length) {
                            this.navArrowButtons[iterator].setAttribute('data-direction', 'dir-' + (iterator + 1));
                            this.navArrowButtons[iterator].addEventListener('click', function(event) {
                                _this.decideSlideForLargeScreen(event);
                            }, false);
                        }
                    }
                    this.cards[iterator].setAttribute('data-slider-index', iterator + 1);
                }

                this.cardListContainerWidth = cardListContainerWidth;
                if (this.cardWrapWidth >= this.cardListContainerWidth) {
                    this.navArrowButtons[1].classList.add('hide');
                }

                if (hashObject && hashObject.type === "cardwrapslide") {
                    if (hashObject.section && hashObject.section === this.cardListContainerWrapper.getAttribute('data-card-id')) {
                        if (parseInt(hashObject.index) === this.cards.length - 2) {
                            this.cardListContainerWrapper.querySelector(".cws-arrows.right").classList.add('hide');
                            this.cardListContainerWrapper.querySelector(".cws-arrows.left").classList.remove('hide');
                        } else if (parseInt(hashObject.index) !== 1) {
                            this.cardListContainerWrapper.querySelector(".cws-arrows.left").classList.remove('hide');
                        }
                        this.activeIndex = parseInt(hashObject.index);
                        if (parseInt(hashObject.index)) {
                            this.slide(parseInt(hashObject.index), parseInt(hashObject.index));
                            this.changeActiveSelection(1, parseInt(hashObject.index));

                        }
                    }
                }
                if (document.querySelector(".card-list-container .view-all") && typeof this.viewAllRequired !== 'undefined'){
                     if(!this.viewAllRequired)
                     {
                         document.querySelector(".card-list-container .view-all").classList.remove("show-viewAll" ,"view-all-required");
                         document.querySelector(".card-list-container .view-all").classList.add("hide-viewAll");
                     }
                     else if(utils.isMobile && this.cards.length > 1 &&  this.viewAllRequired)
                     {
                         document.querySelector(".card-list-container .view-all").classList.remove("hide-viewAll");
                         document.querySelector(".card-list-container .view-all").classList.add("show-viewAll", "view-all-required");
                     }
                     else if(utils.isMobile && this.cards.length <= 1 &&  this.viewAllRequired)
                     {
                         document.querySelector(".card-list-container .view-all").classList.add("hide-viewAll");
                         document.querySelector(".card-list-container .view-all").classList.remove("show-viewAll", "view-all-required");
                     }
                     else if(utils.isTablet && this.cards.length > 1 && this.viewAllRequired)
                     {
                         this.cardListContainerWrapper.querySelector(".card-list-container .view-all").classList.remove("hide-viewAll");
                         this.cardListContainerWrapper.querySelector(".card-list-container .view-all").classList.add("show-viewAll", "view-all-required");
                     }
                     else if(!utils.isMobile && this.cards.length <= 3 && this.viewAllRequired){
                         document.querySelector(".card-list-container .view-all").classList.remove("show-viewAll", "view-all-required");
                         document.querySelector(".card-list-container .view-all").classList.add("hide-viewAll");
                         
                     }
					 else if (!utils.isMobile && this.cards.length <= 4 && this.viewAllRequired && this.viewAllgreaterThanFour) {
                        this.cardListContainerWrapper.querySelector(".card-list-container .view-all").classList.remove("show-viewAll", "view-all-required");
                        this.cardListContainerWrapper.querySelector(".card-list-container .view-all").classList.add("hide-viewAll");
                        }
                     else{
                         document.querySelector(".card-list-container .view-all").classList.remove("hide-viewAll");
                         document.querySelector(".card-list-container .view-all").classList.add("show-viewAll" ,"view-all-required");
                     }
                 }
                this.setLayout(cardListContainerWidth > minCardWidth ? cardListContainerWidth : minCardWidth);
            } catch (e) {
               // console.log(e);
            }
        }
        // Event handler for "touchstart"
        function touchStartHandler(e) {
            this.startPageX = e.changedTouches[0].pageX;
        }
        // Event handler for "touchend"
        function touchEndHandler(e) {
            this.endPageX = e.changedTouches[0].pageX;
            this.decideSlideForMobile();
        }
        // Handle hav button events
        function navSlideHandler(e) {
            this.slide(this.activeIndex, e.target.getAttribute('data-slider-index'));
            this.changeActiveSelection(this.activeIndex, parseInt(e.target.getAttribute('data-slider-index')));
        }

        // Decision making on slider on desktop devices
        function decideSlideForLargeScreen(event) {
            if ((event.target.getAttribute('data-direction') === 'dir-1') && (this.activeIndex > 1)) {
                this.slide(this.activeIndex, (this.activeIndex - 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex - 1));
            } else if ((event.target.getAttribute('data-direction') === 'dir-2') && (this.activeIndex < (this.cards.length + 1 - this.cardViewCount))) {
                this.slide(this.activeIndex, (this.activeIndex + 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
            } else if ((event.target.getAttribute('data-direction') === 'dir-2') && window.innerWidth < 1440 && this.cards.length < 4) {
                this.slide(this.activeIndex, (this.activeIndex + 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
            } else {
                return false;
            }

            // Hide or show the left arrow button according to the selected index
            if (this.activeIndex === 1) {
                this.cardListContainerWrapper.querySelector('[data-direction="dir-1"]').classList.add('hide');
                this.cardListContainerWrapper.querySelector('[data-direction="dir-2"]').classList.remove('hide');
            }
            // Hide or show the right arrow button according to the selected index
            else if (this.activeIndex === (this.cards.length + 1 - this.cardViewCount)) {
                this.cardListContainerWrapper.querySelector('[data-direction="dir-1"]').classList.remove('hide');
                this.cardListContainerWrapper.querySelector('[data-direction="dir-2"]').classList.add('hide');
            } else if ((event.target.getAttribute('data-direction') === 'dir-2') && window.innerWidth < 1440 && this.cards.length < 4) {
                this.cardListContainerWrapper.querySelector('[data-direction="dir-1"]').classList.remove('hide');
                this.cardListContainerWrapper.querySelector('[data-direction="dir-2"]').classList.add('hide');
            } else {
                this.cardListContainerWrapper.querySelector('[data-direction="dir-1"]').classList.remove('hide');
                this.cardListContainerWrapper.querySelector('[data-direction="dir-2"]').classList.remove('hide');
            }
        }
        // Decision making on slider on mobile devices
        function decideSlideForMobile() {
            if (Math.abs(this.startPageX - this.endPageX) < 10) {
                return false;
            }
            if (this.startPageX < this.endPageX && this.activeIndex > 1) {
                this.slide(this.activeIndex, (this.activeIndex - 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex - 1));
            } else if (this.startPageX > this.endPageX && this.cards.length > this.activeIndex) {
                this.slide(this.activeIndex, (this.activeIndex + 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
            } else {
                return false;
            }
        }
        // Change active Selection
        function changeActiveSelection(currentIndex, swipedIndex) {
            this.activeIndex = swipedIndex;
            if (utils.isTouchDevice()) {
                // Change active Nav button
                this.cardListContainerWrapper.querySelector('a[data-slider-index="' + currentIndex + '"]').classList.remove('active');
                this.cardListContainerWrapper.querySelector('a[data-slider-index="' + swipedIndex + '"]').classList.add('active');
            }
            // Change active card
            this.cardListContainerWrapper.querySelector('div[data-slider-index="' + currentIndex + '"]').classList.remove('active');
            this.cardListContainerWrapper.querySelector('div[data-slider-index="' + swipedIndex + '"]').classList.add('active');
        }
        // slide container for slide effect
        function slide(currentIndex, swipedIndex) {

            var translateValue = 0;
            var sectionId = this.cardListContainerWrapper.getAttribute('data-card-id');
            if (utils.isTabLandscape()) {
                if (swipedIndex != 1) {
                    for (var iterator = 1; iterator < swipedIndex; iterator++) {
                        translateValue += this.cards[iterator].offsetWidth;
                    }

                    if (window.innerWidth < 1440 && this.cards.length < 4) {
                        translateValue = this.cards[0].offsetWidth / 2;
                    } else {
                        translateValue += (this.cards[0].offsetWidth) / 1.75;
                    }
                } else {
                    translateValue = 0;
                }
            } else if (utils.isTouchDevice()) {
                var widthtouch = this.cards[0].getBoundingClientRect().width.toFixed(2);
                translateValue = ((swipedIndex - 1) * (widthtouch));
            } else {
                for (var iterator = 1; iterator < swipedIndex; iterator++) {
                    translateValue += this.cards[iterator].offsetWidth;
                }
            }
            this.cardListContainer.style.transform = "translateX(-" + translateValue + "px)";
            this.cardListContainer.style.webkitTransform = "translateX(-" + translateValue + "px)";
            //Fix For More Like This Component Browser Back Button Issue.
            if (!this.cardListContainerWrapper.classList.contains('three-cards'))
            {
                 window.location.hash = "type=cardwrapslide&section=" + sectionId + "&index=" + swipedIndex;
            }

        };
    };
    // Slider will available to the entire app through it is assigned to the global window
    window.def.Slider = Slider || {};

})();
(function() {
    'use strict';

    function addSliders() {
        var wrapperContainers = document.querySelectorAll('.cws-wrap');
        if (wrapperContainers) {
            var wrapperContainersLength = wrapperContainers.length;
        }

        if (!document.getElementsByClassName('cws-wrap').length) {
            var wrapperWidth = 0;
        } else {
            var wrapperWidth = document.querySelector('.cws-wrap').offsetWidth;
        }

        var container;
        var config;
        if (wrapperContainersLength && wrapperContainersLength > 0) {
            for (var i = 0; i < wrapperContainersLength; ++i) {
                container = wrapperContainers[i];
                config = {
                    cardListContainerWrapper: container,
                    cardListContainer: container.querySelector('.cws-card-list'),
                    cards: container.querySelectorAll('.cws-card-wrap'),
                    navButtons: container.querySelectorAll('.cws-nav .cws-nav-link'),
                    navArrowButtons: container.querySelectorAll('.cws-arrows'),
                    cardViewCount: utils.getCardViewCount(),
                    gutterWidth: 20,
                    viewAllRequired: container.querySelector('.view-all').classList.contains('view-all-required'),
                    wrapperWidth: wrapperWidth,
                    viewAllgreaterThanFour: container.querySelector('.view-all').classList.contains('bancs-show-viewall')

                }
                new window.def.Slider(config);
            }
        }
        window.addEventListener("keydown", function(event) {
            if (event.target.classList.contains('view-all-link')) {
                if (event.which == 32 || event.which == 13) {
                    event.preventDefault();
                    event.target.click();
                    event.target.blur();
                }
            }
        }, true);
    }
    addSliders();
})();
(function(context) {
    var scrollMenu = [];
    var readyCallbacks = [];
    var sideMenus = document.querySelectorAll('.cwm-side-menu');
    scrollMenu.ready = function ready(callback) {
        readyCallbacks.push(callback);
    };

    function ScrollMenu(domElement) {
        var previousIndex;
        var mainMenuPreviousIndex;
        var itemsPerMenu = [];
        var callbackHooks = [];
        var callbackHooksForMain = [];
        var header = domElement.querySelector('.scroll-header');
        var mainMenuHeaders = domElement.querySelectorAll('.text-style-46');
        var mainMenus = domElement.querySelectorAll('ul');
        var menuItems = domElement.querySelectorAll('li');
        var mainMenuSelector = domElement.querySelector('.main-menu-selector');
        var menuSelector = domElement.querySelectorAll('.menu-selector');
        var menuActive = domElement.querySelector(".card-wrap-menu .text-style-46.selected");
        var viewAllFocus = domElement.querySelector('.view-all .selected');
        var selectedCardsList = domElement.nextElementSibling.querySelector('.cwm-card-list.selected');
        var cwmCardDescriptions = selectedCardsList.querySelectorAll('.cwm-card-description');
        var cwmCardHeadings = selectedCardsList.querySelectorAll('.cwm-card-heading');
        var cardWrapFilterId = domElement.closest(".card-wrap-menu").getAttribute("card-wrap-section");
        domElement.setAttribute('sectionid', cardWrapFilterId);
        var sectionId = domElement.getAttribute("sectionid");
        this.selectMenu = function(index) {
            selectMainMenu(index);
            selectItem(0);
        };

        this.onSelectMain = function(callback) {
            callbackHooksForMain.push(callback);
        };

        this.onSelect = function(callback) {
            callbackHooks.push(callback);
        };
        if (mainMenuSelector && menuActive) {
            //mainMenuSelector.style.top = menuActive.offsetTop + 'px';
            mainMenuSelector.style.top = '0px';
            mainMenuSelector.style.height = menuActive.offsetHeight + 'px';
        }

        if (mainMenuHeaders.length < 1) return;
        for (var i = 0; i < mainMenuHeaders.length; i++) {
            mainMenuHeaders[i].index = i;
            mainMenuHeaders[i].addEventListener('click', function() {
                domElement.classList.remove('open');
                selectMainMenu(this.index);
                setTimeout(function() {
                    domElement.nextElementSibling.querySelector('.cwm-card-list.selected .selected a').focus();
                }, 50)

            }, false);
            if (mainMenuHeaders[i].classList.contains('selected')) {
                mainMenuPreviousIndex = i;
            }
            itemsPerMenu.push(mainMenus[i] ? mainMenus[i].children.length : 0);
        }

        if (header) {
            header.addEventListener('click', toggleDeviceMainMenu);
        }

        var startIndices = itemsPerMenu.reduce(function(indices, i) {
            indices.push(indices.slice(-1)[0] + i - 1);
            return indices;
        }, [0]);

        if (menuItems.length < 1) return;

        for (var j = 0; j < menuItems.length; j++) {
            menuItems[j].index = j;
            menuItems[j].addEventListener('click', function() {
                selectItem(this.index);
            }, false);
            if (menuItems[j].classList.contains('selected')) {
                previousIndex = j;
            }
        }
        window.requestAnimationFrame(function() {
            setTimeout(function() {
                selectMainMenu(0);
            }, 50);
        });

        function selectMainMenu(index) {
            if (index == null || index === mainMenuPreviousIndex || sectionId == null) return;
            var sectionContent = document.querySelector('[card-wrap-section="' + sectionId + '"]');
            var mainMenuHeaders = sectionContent.querySelectorAll('.cwm-side-menu .text-style-46');
            var mainMenus = sectionContent.querySelectorAll('ul');
            if (mainMenuPreviousIndex != null) {
                mainMenuHeaders[mainMenuPreviousIndex].classList.remove('selected');
                if (mainMenus[mainMenuPreviousIndex]) {
                    mainMenus[mainMenuPreviousIndex].classList.remove('selected');
                }
            }

            setTimeout(function() {
                if (mainMenus[index]) {
                    mainMenus[index].classList.add('selected');
                }
                mainMenuHeaders[index].classList.add('selected');
                menuActive = domElement.querySelector(".card-wrap-menu .text-style-46.selected");
                if (mainMenuSelector && menuActive) {
                    mainMenuSelector.style.top = menuActive.offsetTop + 'px';
                    mainMenuSelector.style.height = menuActive.offsetHeight + 'px';
                }

                mainMenuPreviousIndex = index;
                callbackHooksForMain.forEach(function(callback) {
                    if (typeof callback === 'function') {
                        callback(index, 'main');
                    }
                });
                selectItem(startIndices[index]);
                // Change card slider with drop down change

                var cardListContainerWrapper = domElement.nextElementSibling.querySelector('.cwm-card-list.selected');
                var config = {
                    cardListContainerWrapper: cardListContainerWrapper,
                    cardListContainer: cardListContainerWrapper.querySelector('.row'),
                    cards: cardListContainerWrapper.querySelectorAll('.cwm-card-wrap'),
                    navButtons: cardListContainerWrapper.querySelectorAll('.cwm-nav .cwm-nav-link'),
                    navArrowButtons: [],
                    cardViewCount: utils.getCardViewCount(),
                    gutterWidth: 20
                }

                if (cardListContainerWrapper.querySelector('.row').style.width.length === 0 && (utils.isTablet || utils.isMobile)) {
                    new window.def.Slider(config);
                }

            }, mainMenus[mainMenuPreviousIndex] ? 50 : 0);
        }



        function selectItem(index) {
            if (index == null) return;
            if (previousIndex != null) {
                menuItems[previousIndex].classList.remove('selected');
            }

            if (menuItems[index]) {
                if (menuSelector[mainMenuPreviousIndex]) {
                    var menuHeight = menuSelector[mainMenuPreviousIndex].offsetTop;
                    menuSelector[mainMenuPreviousIndex].style.transform = 'translate(0, ' + (menuItems[index].offsetTop - menuHeight) + 'px)';
                }
                menuItems[index].classList.add('selected');
                previousIndex = index;
                callbackHooks.forEach(function(callback) {
                    if (typeof callback === 'function') {
                        callback(index, 'main');
                    }
                });
            }

        }

        window.addEventListener('onresize', function() {
            window.requestAnimationFrame(function() {
                selectMainMenu(previousIndex);
            });
        });


    }
    var cardWrapMenu = document.querySelectorAll(".card-wrap-menu");
    var sideMenuLength = sideMenus.length;
    var sideMenu;
    var scrollmenuObjArray = [];
    if (sideMenuLength) {
        for (var i = 0; i < sideMenuLength; ++i) {
            cardWrapMenu[i].setAttribute("card-wrap-section", "cardwrap_" + i);
            sideMenu = sideMenus[i];
            scrollMenu.push(new ScrollMenu(sideMenu));
        }
    }
    readyCallbacks.forEach(function(callback) {
        if (typeof callback === 'function') {
            callback();
        }
    });

    window.ScrollMenu1 = ScrollMenu;
    var prevSideMenuIndex = 0;
    var prevViewAllIndex = 0;
    var sideMainMenus = document.querySelectorAll('.cwm-side-menu');
    //var menuItems = document.querySelectorAll('.cwm-side-menu .text-style-46');
    //var sideMenus = document.querySelectorAll('.cwm-card-list');
    //var viewAll = document.querySelectorAll('.cwm-card-group .view-all');
    var keepIndex =  [];
    //var totalcardsCount = document.querySelectorAll('.cwm-card-group .total-cards-count');
    var hashObject = utils.getURLHash();
    window.addEventListener("keyup", function(e) {
        if (e.keyCode === 27 && document.activeElement === document.querySelector('.view-all.selected a')) {
            document.querySelector('.menu-item.selected').focus();
        }
    }, true);
    if (hashObject.type === "cardwrapmenu") {
        if (hashObject.cardsection) {
            if (hashObject.index) {
                selectSection(parseInt(hashObject.index), hashObject.cardsection);
                var sideMenu = document.querySelector('[sectionid="' + hashObject.cardsection + '"]');
                if (sideMenu) {
                    var scrollMenu = new ScrollMenu(sideMenu);
                    setTimeout(function() { scrollMenu.selectMenu(hashObject.index); }, 500)
                }
            }
        }
    }

    if (sideMainMenus) {
        for (var j = 0; j < sideMainMenus.length; j++){
            var menuItems = sideMainMenus[j].querySelectorAll('.text-style-46');

            for (var i = 0; i < menuItems.length; i++) {
                var cardWrapId = sideMainMenus[j].closest(".card-wrap-menu").getAttribute("card-wrap-section");
                sideMainMenus[j].setAttribute('sectionid', cardWrapId);
                menuItems[i].sectionId = sideMainMenus[j].getAttribute("sectionid");
                menuItems[i].index = i;
                menuItems[i].addEventListener('click', function() {
                    selectSection(this.index, this.sectionId);
                }, false);
                menuItems[i].addEventListener('keydown', function() {
                    if (event.which == 32 || event.which == 13) {
                        this.click();
                    }
                }, false);
                if (hashObject.index && hashObject.cardsection == menuItems[i].sectionId) {
                    showHideViewAllLinkBycardsCount(hashObject.index, menuItems[i].sectionId);
                } else {
                    showHideViewAllLinkBycardsCount(0, menuItems[i].sectionId);
                }
            }
        }
    }


        var slideSwipeX = 0;
        var keepIndex;
        function findCardCollection() {
            var cardSection = document.querySelector('.cwm-card-list.selected');
            return cardSection;
        }
        function intializeIndexArray() {
            var keepIndex = [];
            for (var j = 0; j < sideMainMenus.length; j++){
                 sectionId = sideMainMenus[j].getAttribute("sectionid");
                 keepIndex[sectionId] = sectionId;
                 keepIndex[sectionId] = [];
                keepIndex[sectionId]["prevSideMenuIndex"] = 0;
                keepIndex[sectionId]["prevViewAllIndex"] = 0;
            }
             return keepIndex;

        }

        function selectSection(index, sectionId) {
            var sectionContent = document.querySelector('[card-wrap-section="' + sectionId + '"]');
            var sideMenus = sectionContent.querySelectorAll('.cwm-card-list');
            var viewAll = sectionContent.querySelectorAll('.cwm-card-group .view-all');
            if (keepIndex === undefined || (typeof keepIndex[sectionId] === 'undefined')) {
                keepIndex = intializeIndexArray();
            }
            prevSideMenuIndex = keepIndex[sectionId]["prevSideMenuIndex"];
            prevViewAllIndex = keepIndex[sectionId]["prevViewAllIndex"];
            if (prevSideMenuIndex != null) {
                sideMenus[prevSideMenuIndex].classList.remove('selected');
            }
            if (prevViewAllIndex != null) {
                viewAll[prevViewAllIndex].classList.remove('selected');
            }
            if (sideMenus[index]) {
                sideMenus[index].classList.add('selected');
                keepIndex[sectionId]["prevSideMenuIndex"] = index;
            }
            if (viewAll[index]) {
                viewAll[index].classList.add('selected');
                keepIndex[sectionId]["prevViewAllIndex"] = index;
            }

            showHideViewAllLinkBycardsCount(index, sectionId);
            window.location.hash = "type=cardwrapmenu&cardsection="+sectionId+"&index=" + index;
        }

        function showHideViewAllLinkBycardsCount(index, sectionId) {
            var sectionContent = document.querySelector('[card-wrap-section="' + sectionId + '"]');
            var totalcardsCount = sectionContent.querySelectorAll('.cwm-card-group .total-cards-count');
            var viewAll = sectionContent.querySelectorAll('.cwm-card-group .view-all');
            if (totalcardsCount && totalcardsCount[index] && totalcardsCount[index].innerHTML != 'undefined') {
                var cardsCount = totalcardsCount[index].innerHTML;
                if (utils.isMobile && cardsCount <= 1) {
                    viewAll[index].classList.add('hide-view-all');
                } else if (!utils.isMobile && cardsCount <= 3) {
                    viewAll[index].classList.add('hide-view-all');
                } else if (viewAll[index].classList.contains('hide-view-all')) {
                    viewAll[index].classList.remove('hide-view-all');
                }
            }
        }

        function findCardSelected(attribute, value) {
            var cardCollection = findCardCollection();
            var allCards = cardCollection.querySelectorAll('.cwm-card-wrap');
            if (allCards) {
                for (var i = 0; i < allCards.length; i++) {
                    if (allCards[i].getAttribute(attribute) === value) {
                        return allCards[i];
                    }
                }
            }

        }

        function findCardNotInIndex(anchorIndex) {
            var cardCollection = findCardCollection();
            var allCards = cardCollection.querySelectorAll('.cwm-card-wrap');
            var cardsNotInIndex = [];
            if (allCards) {
                for (var i = 0; i < allCards.length; i++) {
                    if (allCards[i].getAttribute('data-card-index') !== anchorIndex) {
                        cardsNotInIndex.push(allCards[i]);
                    }
                }
            }

            return cardsNotInIndex;
        }

        function changeNavOpacity(anchorIndex) {
            var navLink = document.querySelectorAll('.cwm-card-list.selected .card-collection-nav .card-collection-nav-but a');
            if (navLink) {
                for (var i = 0; i < navLink.length; i++) {
                    if ('' + anchorIndex !== navLink[i].getAttribute('data-card-nav-index')) {
                        navLink[i].classList.remove('selected');
                    }
                }
            }

        }

        var slideFunction = function(event) {
            var anchorIndex = event.target.getAttribute('data-card-nav-index');
            // marking the slide nav as selected
            var cardcollection = findCardCollection();
            var index = event.target.getAttribute('data-card-index');
            cardcollection.querySelector('[data-card-index="' + index + '"]').classList.add('selected');
            // event.target.style.backgroundColor = '#ffffff';
            // event.target.style.border = '1px solid  #0e8ff9';
            changeNavOpacity(anchorIndex);
            var cardSelected = findCardSelected('data-card-index', anchorIndex);
            // cardSelected.style.position = 'relative';
            // cardSelected.style.visibility = 'visible';
            // cardSelected.classList.add('selected');
            // cardSelected.style.opacity = 1;
            var cardToBeHidden = findCardNotInIndex(anchorIndex);
            for (var i = 0; i < cardToBeHidden.length; i++) {
                // cardToBeHidden[i].style.opacity = 0;
                // cardToBeHidden[i].style.position = 'absolute';
                // cardToBeHidden[i].style.visibility = 'hidden';
                // cardToBeHidden[i].classList.remove('selected');
            }
        };

        //Method for slide screen
        /* var swipeFunction = function(event) {
             var sourceElement = this.querySelector('.cwm-card-wrap.selected');
             event.target.classList.add('selected');
             //get total number of cards in the selected caontainer
             var totalCards = document.querySelectorAll('.cwm-card-list .selected ').length;
             var currentSwipeX = event.targetTouches[0].clientX;
             // var sourceElement = event.target;
             if (sourceElement.classList.contains('selected')) {
                 var anchorIndex = sourceElement.getAttribute('data-card-index');
                 var index = sourceElement.getAttribute('data-card-index');
                 //find index value and +1 to select the next card on swipe right
                 if (currentSwipeX > slideSwipeX) {
                     if (index < totalCards && anchorIndex < totalCards) {
                         index = parseInt(index) + 1;
                         anchorIndex = parseInt(anchorIndex) + 1;
                     } else {
                         index = totalCards;
                         anchorIndex = totalCards;
                     }
                 }
                 //find index value and -1 to select the next card on swipe left
                 else {
                     if (index > 1 && anchorIndex > 1) {
                         index = parseInt(index) - 1;
                         anchorIndex = parseInt(anchorIndex) - 1;
                     } else {
                         index = 1;
                         anchorIndex = 1;
                     }
                 }
                 //set value to slideSwipeX
                 slideSwipeX = currentSwipeX;
                 //marking the slide nav as selected
                 var cardcollection = findCardCollection();
                 cardcollection.querySelector('[data-card-index="' + index.toString() + '"]').classList.add('selected');
                 var containerParent = event.target.parentNode.parentNode.parentNode.parentNode;
                 var allCards = containerParent.querySelectorAll('.cwm-card-wrap');
                 var singleCardWidth = 0;
                 changeNavOpacity(anchorIndex, containerParent);
                 singleCardWidth = containerParent.querySelectorAll('.cwm-card-wrap')[0].offsetWidth;
                 for (var incre = 0; incre < allCards.length; incre++) {
                     if (allCards[incre].getAttribute('data-card-index') === '' + anchorIndex) {
                         allCards[incre].classList.add('selected');
                     } else {
                         allCards[incre].classList.remove('selected');
                     }
                 }
                 //  containerParent.querySelector('.cwm-card-list').style.width = (singleCardWidth * allCards.length) + 'px';
                 var translateWidth = (anchorIndex - 1) * singleCardWidth
                     //containerParent.querySelector('.cwm-card-list').style.transform = "translateX(-" + translateWidth + "px)";
                 document.querySelector('.cwm-card-list.selected .row').style.transform = "translateX(-" + translateWidth + "px)";*/
        /*  setSelectedCardRow(anchorIndex);*/
        //  var cardSelected = containerParent.querySelector('.cwm-card-wrap.selected');
        //changeNavOpacity(anchorIndex.toString());
        // var cardSelected = findCardSelected('data-card-index', anchorIndex.toString());
        // cardSelected.style.position = 'relative';
        // cardSelected.style.visibility = 'visible';
        // cardSelected.classList.add('selected');
        // cardSelected.style.opacity = 1;
        // var cardToBeHidden = findCardNotInIndex(anchorIndex.toString());
        // for (var i = 0; i < cardToBeHidden.length; i++) {
        // cardToBeHidden[i].style.opacity = 0;
        // cardToBeHidden[i].style.position = 'absolute';
        // cardToBeHidden[i].style.visibility = 'hidden';
        // cardToBeHidden[i].classList.remove('selected');
        // }
        // }
        //};

        this.scrollFunction = function(event) {
            var sourceElement = this.querySelector('.cwm-card-wrap.selected');
            event.target.classList.add('selected');
            //get total number of cards in the selected caontainer
            var totalCards = document.querySelectorAll('.cwm-card-list .selected ').length;
            var currentSwipeX = event.targetTouches[0].clientX;
            // var sourceElement = event.target;
            if (sourceElement.classList.contains('selected')) {
                var anchorIndex = sourceElement.getAttribute('data-card-index');
                var index = sourceElement.getAttribute('data-card-index');
                //find index value and +1 to select the next card on swipe right
                if (currentSwipeX > slideSwipeX) {
                    if (index < totalCards && anchorIndex < totalCards) {
                        index = parseInt(index) + 1;
                        anchorIndex = parseInt(anchorIndex) + 1;
                    } else {
                        index = totalCards;
                        anchorIndex = totalCards;
                    }
                }
                //find index value and -1 to select the next card on swipe left
                else {
                    if (index > 1 && anchorIndex > 1) {
                        index = parseInt(index) - 1;
                        anchorIndex = parseInt(anchorIndex) - 1;
                    } else {
                        index = 1;
                        anchorIndex = 1;
                    }
                }
                //set value to slideSwipeX
                slideSwipeX = currentSwipeX;
                //marking the slide nav as selected
                var cardcollection = findCardCollection();
                cardcollection.querySelector('[data-card-index="' + index.toString() + '"]').classList.add('selected');
                var containerParent = event.target.parentNode.parentNode.parentNode.parentNode;
                var allCards = containerParent.querySelectorAll('.cwm-card-wrap');
                var singleCardWidth = 0;
                changeNavOpacity(anchorIndex, containerParent);
                singleCardWidth = containerParent.querySelectorAll('.cwm-card-wrap')[0].offsetWidth;
                for (var incre = 0; incre < allCards.length; incre++) {
                    if (allCards[incre].getAttribute('data-card-index') === '' + anchorIndex) {
                        allCards[incre].classList.add('selected');
                    } else {
                        allCards[incre].classList.remove('selected');
                    }
                }
                //  containerParent.querySelector('.cwm-card-list').style.width = (singleCardWidth * allCards.length) + 'px';
                var translateWidth = (anchorIndex - 1) * singleCardWidth
                //containerParent.querySelector('.cwm-card-list').style.transform = "translateX(-" + translateWidth + "px)";
                document.querySelector('.cwm-card-list.selected .row').style.transform = "translateX(-" + translateWidth + "px)";
                /*  setSelectedCardRow(anchorIndex);*/
                var cardSelected = containerParent.querySelector('.cwm-card-wrap.selected');
                //changeNavOpacity(anchorIndex.toString());
                // var cardSelected = findCardSelected('data-card-index', anchorIndex.toString());
                // cardSelected.style.position = 'relative';
                // cardSelected.style.visibility = 'visible';
                // cardSelected.classList.add('selected');
                // cardSelected.style.opacity = 1;
                // var cardToBeHidden = findCardNotInIndex(anchorIndex.toString());
                // for (var i = 0; i < cardToBeHidden.length; i++) {
                // cardToBeHidden[i].style.opacity = 0;
                // cardToBeHidden[i].style.position = 'absolute';
                // cardToBeHidden[i].style.visibility = 'hidden';
                // cardToBeHidden[i].classList.remove('selected');
                // }
            }
        };

        // event listener for slide button click
        /* var slideButton = document.querySelectorAll('.card-collection-nav-but a');
         for (var i = 0; i < slideButton.length; i++) {
             slideButton[i].addEventListener('click', slideFunction);
         }
         //  event listener for swipe card
         var swipeCard = document.querySelector('.cwm-card-list');
         if (swipeCard) {
             swipeCard.addEventListener('touchstart', swipeFunction);
         }*/

        var init = function(me) {
            addEvents();
        };

        function addEvents() {
            // Cards with dropdown
            var cardListContainerWrapper = document.querySelector('.cwm-card-list.selected');
            var slider;
            if (cardListContainerWrapper) {
                var config = {
                    cardListContainerWrapper: cardListContainerWrapper,
                    cardListContainer: cardListContainerWrapper.querySelector('.row'),
                    cards: cardListContainerWrapper.querySelectorAll('.cwm-card-wrap'),
                    navButtons: cardListContainerWrapper.querySelectorAll('.cwm-nav .cwm-nav-link'),
                    navArrowButtons: [],
                    cardViewCount: utils.getCardViewCount(),
                    gutterWidth: 20,
                    viewAllRequired: true
                };
                if (!config.viewAllRequired) {
                      slider = new window.def.Slider(config);
                }
                if (!parseInt(hashObject.index)) {
                  //  showHideViewAllLinkBycardsCount(0);
                }
            }
        }

        function toggleDeviceMainMenu() {
            if (utils.isTablet || utils.isMobile) {
                this.parentNode.classList.toggle('open');
            }
        }

       // init();

    })();

(function() {
    'use strict';
    var DropDown = function(element) {
        if (!element) {
            return;
        }
        var _this = this;
        this.init = init;
        this.addEvents = addEvents;
        this.toggleDD = toggleDD;
        this.closeDD = closeDD;
        this.onClickItem = onClickItem;
        this.subscribe = subscribe;
        this.dispatch = dispatch;
        this.reset = reset;
        this.getSelectedValue = getSelectedValue;
        this.selectedValue = "";

        this.init();

        function init() {
            this.name = 'DropDown';

            this.elm = element;
            this.listeners = [];
            this.pageBody = document.querySelector('body');
            this.pageOverlay = document.querySelector('.page-overlay');
            this.overlayWithDD = document.querySelector('.dropdown-overlay-container');
            if (this.elm) {
                this.header = this.elm.querySelector('.dropdown-header');
                this.title = this.elm.querySelector('.dropdown-header').querySelector('.dropdown-measure').querySelector('.title');
            }

            if (this.header) {
                this.headerLabelSelected = this.header.querySelector('.dropdown-selected');
                this.contents = this.elm.querySelector('.dropdown-content');
                this.items = this.contents.querySelectorAll('.dropdown-item');
                this.addEvents();
            }
            
            this.getSelectedValue();
        };
        
        function getSelectedValue(){
        	if(this.contents.querySelector('.dropdown-item.selected'))
        	this.selectedValue = this.contents.querySelector('.dropdown-item.selected').getAttribute("data-item");
        
        }

        function addEvents() {
            this.header.addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13)
                    this.click();
            }, false);

            this.header.addEventListener('click', function(event) {
                _this.toggleDD(event);
            }, false);

            // For DD Items
            var itemCount = this.items.length;
            var item;
            for (var i = 0; i < itemCount; ++i) {
                item = this.items[i];
                item.index = i;
                item.addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13)
                        this.click();
                }, false);
                item.addEventListener('click', function(event) {
                    _this.onClickItem(event, this);
                }, false);
            }
            if (this.pageBody) {
                this.pageBody.addEventListener('keyup', function(event) {
                    var code = event.keyCode ? event.keyCode : event.which;
                    if (code === 27) {
                        _this.closeDD(event);
                    }
                }, false);
            }

        };
           
      

        function closeDD() {
            _this.elm.classList.remove('open');
            _this.elm.classList.remove('bs-depth-3');
            if (_this.pageOverlay && !_this.overlayWithDD) {
                _this.pageOverlay.classList.toggle('dropdown-overlay');
                _this.pageOverlay.style.visibility = 'hidden';
            }

            if (_this.pageBody) {
                _this.pageBody.removeEventListener('click', _this.closeDD, false);
            }

        };

        function toggleDD(event) {
            this.elm.classList.toggle('open');
            this.elm.classList.toggle('bs-depth-3');
            if (this.pageOverlay && !_this.overlayWithDD) {
                this.pageOverlay.classList.toggle('dropdown-overlay');
            }
            if (this.elm.classList.contains('open')) {
                if (this.pageOverlay && !_this.overlayWithDD) {
                    this.pageOverlay.style.visibility = 'visible';
                }

                if (this.pageBody) {
                    this.pageBody.addEventListener('click', _this.closeDD, false);
                    obj.closeDDHandler = _this.closeDD;
                }
            }
            else {
                if (this.pageOverlay && !_this.overlayWithDD) {
                    this.pageOverlay.style.visibility = 'hidden';
                }

                if (this.pageBody) {
                    this.pageBody.removeEventListener('click', _this.closeDD, false);
                }

            }

            event.stopPropagation();
        };

        function onClickItem(event, element) {
            var index = element.index;
            var itemText = element.innerHTML;
            var itemSelected = this.contents.querySelector('.dropdown-item.selected');

            this.headerLabelSelected.innerHTML = itemText.trim();
            if (itemSelected) {
                itemSelected.classList.remove('selected');
            }
            element.classList.add('selected');
           // this.selectedValue = this.contents.querySelector('.dropdown-item.selected').getAttribute("data-item");
            this.getSelectedValue();
            this.closeDD();

            this.dispatch('onItemChange', index);
        };

        function reset() {
            var itemSelected = this.contents.querySelector('.dropdown-item.selected');
            if (itemSelected) {
                itemSelected.classList.remove('selected');
            }
            if(document.getElementById("newsRoomInitialAll") && document.getElementById("newsRoomInitialAll").value ){
			    this.headerLabelSelected.innerHTML = utils.getSanitizedText(
										document.getElementById("newsRoomInitialAll").value); //"All";
                //console.log("Value :: "+document.getElementById("newsRoomInitialAll").value);
			}
			else{
				 this.headerLabelSelected.innerHTML = "All";
               // console.log("Value :: "+document.getElementById("newsRoomInitialAll").value);
			}
            
             this.header.querySelector('.text-style-46').classList.add('dropdown-selected');
             this.contents.querySelector('.dropdown-item').classList.add('selected');
        };

        function subscribe(event, callback) {
            this.listeners[event] = this.listeners[event] || [];
            this.listeners[event].push(callback);
        };

        function dispatch(event, index) {
            if (this.listeners && this.listeners[event]) {
                window.Array.prototype.forEach.call(this.listeners[event], function(callback) {
                    callback && callback.call(_this, index);
                });
            }
        };
    };
    def.DropDown = DropDown;
})();
document.addEventListener('DOMContentLoaded', function(bindedStatus) {

    this.footerContent = document.getElementsByClassName('footer-mobile-submenu-content')[0];
    this.eventBind = (typeof bindedStatus === "undefined") ? true : bindedStatus;
    if (this.footerContent) {
    var accordionComponent = this.footerContent.getElementsByClassName('accordion')
    for (var i = 0; i < accordionComponent.length; i++) {
        var accordionElement = accordionComponent[i]
        var accordion = new def.Accordion(accordionElement, this.eventBind);
    }
    }
    this.elm = document.querySelector('.footer')
    if (this.elm) {
    this.footerBlock =this.elm.querySelectorAll('.accordion-head');
    this.footerSubBlock = this.elm.querySelectorAll('.accordion-content');

    for (var k = 0; k < this.footerBlock.length; k++) {
        if (this.footerBlock[k].classList.contains('no-sub-menu') === true) {

            if (this.footerBlock[k].querySelector('a.footerActionLink').classList.contains('hide')) {
                this.footerBlock[k].querySelector('a.footerActionLink').classList.remove("hide");
                this.footerBlock[k].querySelector('.icon-ic_expand').classList.add("hide"); // hiding
																							// icons
                if (typeof(this.footerSubBlock[k])!== "undefined") {
                    this.footerSubBlock[k].classList.add("hide"); // hiding
																	// sub items
                }
                this.footerBlock[k].querySelector('label').classList.add('hide'); // hiding
																					// label
            }
        }
        else {
        }
    }
    }
    var anchors = document.querySelectorAll('a');
    if (anchors && anchors.length > 0) {
        for (var i = 0; i < anchors; i++) {
            anchors[i].addEventListener('mousehover', function() {
                var title = this.getAttribute('title');
                if (title) {
                    var tempTitle = this.setAttribute('temp-title', title);
                    this.removeAttribute('title');
                }
            });
            anchors[i].addEventListener('mouseleave', function() {
                var tempTitle = this.getAttribute('temp-title');
                if (tempTitle) {
                    var title = this.setAttribute('title', tempTitle);
                    this.removeAttribute('temp-title');
                }
            });
        }
    }
    setTimeout(function() {
        var sectionCardsLayout = document.querySelectorAll('.section-cards-layout');
        if (sectionCardsLayout) {
            var sectionCardsLayoutLength = sectionCardsLayout.length;
            for (var i = 0; i < sectionCardsLayoutLength; i++) {
                var images = sectionCardsLayout[i].querySelectorAll('picture img');
                var imagesLength = images.length;
                for (var j = 0; j < imagesLength; j++) {
                    images[j].style.opacity = 1;
                }
            }
        }
    }, 1000);
    function footerMenuClicked(evt) {
        if (!utils.isMobile) {
            return;
        }
        var parent = evt.target.parentElement;
        if (!this.classList.contains('menu-item-heading-active')) {
            this.classList.add('menu-item-heading-active');
            if (!parent.classList.contains('active')) {
                parent.classList.add('active')
            }
        } else {
            this.classList.remove('menu-item-heading-active');
            parent.classList.remove('active');
        }
    }
    var cookieDuration = 90;
    var cookiePath = document.querySelector('.cookie-path');
    var cokkieClose= document.querySelector('.cookie-close');
    var cookieWrapper = document.querySelector('.cookie-details-header');
    var cookieCloseIcon = document.querySelector('.cookie-close-icon');
    if (cookiePath) {
        cookiePath.addEventListener('click', closeCookie);
    }
    if (cokkieClose) {
        cokkieClose.addEventListener('click', closeCookie);
    }

    if (cookieCloseIcon) {
        cookieCloseIcon.addEventListener('click', closeCookie);
    }

        function showCookie()
        {
            if (cookieWrapper) {
                if (cookieWrapper.classList.contains('hide') == true) {
                    cookieWrapper.classList.remove('hide');
                    cookieWrapper.classList.add('show');
                }
            }
        }
        function closeCookie() {
            createCookie("showCookieStrip", "false", cookieDuration);
            hideCookieStrip();
        };
        function hideCookieStrip() {
            if (cookieWrapper) {
                cookieWrapper.classList.remove('show');
                cookieWrapper.classList.add('hide');
                obj.captureNavigations = new def.CaptureNavigations();
            }
        }
        function createCookie(name,value,days) {
            if (days) {
                var date = new Date();
                date.setTime(date.getTime()+(days*24*60*60*1000));
                var expires = "; expires="+date.toGMTString();
            }
            else var expires = "";
            document.cookie = name+"="+value+expires+"; path=/";
        }
        function checkCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }

        var surveyThankyouPopup = document.querySelector('.survey-thankyou-popup');		
        var closeBtn = document.querySelector('.survey-thankyou-popup .close');		
        var surveyData = localStorage.getItem('survey.Data');

            window.onload = function(){
                if (checkCookie("showCookieStrip") != "false") {
                    showCookie();
                }
                var loginTime = new Date().getTime();		
                if (localStorage && surveyData !== null && surveyData !== undefined) {		
                    var surveyClickCaptureTime = JSON.parse(surveyData).surveyClickCaptureTime;		
                    if (surveyClickCaptureTime !== null && surveyClickCaptureTime !== undefined && surveyThankyouPopup !== null) {		
                        var diffTime = Math.abs(loginTime - surveyClickCaptureTime);		
                        var totalDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));		
                        fetchSurveyQuestions(surveyData, totalDays);		
                    }		
                }		
                else {		
                    return;		
                }
            }
            function fetchSurveyQuestions(surveyData, days) {		
                if (days >= 2 && days <= 30) {		
                    if (surveyData && (JSON.parse(surveyData).surveyStorageWhitepaper) == 'true') {	
                    	surveyThankyouPopup.classList.add('hide');
                        surveyThankyouPopup.classList.remove('model-open');		
                        surveyThankyouPopup.querySelector('.survey-thankyou-msg').classList.add('hide');		
                        return;		
                    }		
                    var pdfPath = JSON.parse(surveyData).surveyStoragePath;		
                    var url = '/services/tcs/FetchSurveyPathContent?' + 'pagepath=' + pdfPath;		
                    fetch(url, {		
                        method: 'GET',		
                        credentials: 'include'		
                    })		
                        .then(function(response) {		
                            // if (loaderDiv &&
							// !loaderDiv.classList.contains('hide')) {
                            // loaderDiv.classList.add('hide');
                            // document.querySelector('.page-overlay').classList.remove('dropdown-overlay');
                            // }
                            if (response.status !== 200) {		
                                return;		
                            }		
                            response.json().then(function(data) {		
                                if (data) {		
                                    if (data && data.statusCode === '401') {		
                                        return;		
                                    }		
                                    else {		
                                        var surveyStorageKey = obj.survey.getSurveyStorageKey(data.response.surveyName);		
                                        if (!obj.survey.isSurveyCompleted(surveyStorageKey)) {		
                                            surveyThankyouPopup.querySelector('.survey-thankyou-msg h2').innerHTML += JSON.parse(surveyData).surevyStoragePdfTitle ;		
                                            surveyThankyouPopup.classList.remove('hide');
                                            surveyThankyouPopup.classList.add('model-open');		
                                            surveyThankyouPopup.querySelector('.survey-thankyou-msg').classList.remove('hide');		
                                            showSurveyQuestions(data);		
                                        }		
                                    }		
                                }		
                            });		
                        })		
                        .catch(function(error) {		
                        });		
                }		
            }
            
            function showSurveyQuestions(data) {		
                this.surveyQuestionsResponse = utils.getSanitizedText(data.response);		
                this.surveyQuestions = document.querySelector('.survey-thankyou-popup .survey-thankyou-wrapper .survey-questions');		
                var surveyQuestionsDiv = '<div class="overlay-survey-wrapper survey hide" data-survey="' + this.surveyQuestionsResponse.surveyName + '">' +		
                    '<div class="section">' +		
                    '<div class="survey-content" data-survey-results="' + this.surveyQuestionsResponse.showResults + '">' +		
                    '<div class="survey-question-wrapper">' +		
                    '<div class="text-style-35 divider question">' + this.surveyQuestionsResponse.question +		
                    '</div >' +		
                    '</div>' +		
                    '<div class="survey-options">' +		
                    '<div class="choices">';		
                    for (var i = 0; i < this.surveyQuestionsResponse.choices.length; i++) {		
                        surveyQuestionsDiv += '<div data-survey="' + this.surveyQuestionsResponse.surveyName + '" class="choice">' + this.surveyQuestionsResponse.choices[i] +		
                            '</div>'		
                    }		
                    surveyQuestionsDiv += '</div>';		
                    if (this.surveyQuestionsResponse.showResults === "true") {		
                        surveyQuestionsDiv += '<div class="survey-results hide">';		
                        for (var i = 0; i < this.surveyQuestionsResponse.choices.length; i++) {		
                            surveyQuestionsDiv += '<div data-survey="' + this.surveyQuestionsResponse.surveyName + '" class="choice-section">' +		
                                '<div class="choice-value">' + this.surveyQuestionsResponse.choices[i] +		
                                '</div>' +		
                                '<div class="choice-bg">' +		
                                '</div>' +		
                                '<div class="choice-percentage">' +		
                                '</div>' +		
                                '</div>';		
                        }		
                    surveyQuestionsDiv += '</div>';		
                    }		
                    surveyQuestionsDiv += '</div>' +		
                    '</div>' +		
                    '<input type="hidden" name="dateRange" value="'+ this.surveyQuestionsResponse.dateRange +'" />'+		
                    '<div class="hide text-style-35 survey-response">' + this.surveyQuestionsResponse.message +		
                    '</div>' +		
                    '</div>' +		
                    '<div class="progress-wrapper hide">'+		
                    '<div class="survey-progress">' +		
                    '</div>' +		
                    '</div>' +		
                    '</div>';		
                this.surveyQuestions.insertAdjacentHTML('beforeend', surveyQuestionsDiv);		
                var surveyElem = this.surveyQuestions.querySelector(".survey");		
                obj.survey.enableSurvey(surveyElem);		
            }		
            if (closeBtn) {		
                closeBtn.addEventListener('click', function(event) {		
                    closeSurveyPopup();		
                }, false)		
            }		
            function closeSurveyPopup() {		
                var _this = this;		
                surveyThankyouPopup.classList.remove('model-open');		
                localStorage.removeItem('survey.Data');		
                if (utils.isTouchDevice()) {		
                    this.body.style.overflow = "auto";		
                }		
            };

    var footerMenuIndustries = document.getElementById('footer-menu-industries');
    var footerMenuProducts = document.getElementById('footer-menu-products');
    var footerMenuServices = document.getElementById('footer-menu-services');
    var footerMenuDiscover = document.getElementById('footer-menu-discover');
    if (footerMenuIndustries) {
        footerMenuIndustries.addEventListener('click', footerMenuClicked, false);
    }
    if (footerMenuProducts) {
        footerMenuProducts.addEventListener('click', footerMenuClicked, false);
    }
    if (footerMenuServices) {
        footerMenuServices.addEventListener('click', footerMenuClicked, false);
    }
    if (footerMenuDiscover) {
        footerMenuDiscover.addEventListener('click', footerMenuClicked, false);
    }

});
/*******************************************************************************
 * Copyright (c) 2017 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     IBM Corporation - initial API and implementation
 *******************************************************************************/
(function() {
    'use strict';

    def.formValidation = function(submitButton) {
      
        this.forgotPassword = document.getElementsByClassName('.forgotpassword-text');
        this.remembermeText = document.getElementsByClassName('.rememberme-text');

        this.submitButton = submitButton;
        this.isFormValid;
        this.init();
    };

    var p = def.formValidation.prototype;
    def.formValidation.prototype.constructor = def.formValidation;

    p.init = function() {
        this.addEvents();
    };
    p.addEvents = function() {
        var _this = this;
        for (var i = 0; i < _this.getInputElements().length; i++) {
            var element = _this.inputElements[i];
            element.addEventListener('keyup', _this.checkInput.bind(_this));
            element.addEventListener('change', _this.checkInput.bind(_this));
            element.addEventListener('blur', _this.checkRequired.bind(_this));
            element.addEventListener('change', _this.checkRequired.bind(_this));
            element.addEventListener('keyup', _this.checkRequired.bind(_this));
        }
        if (this.submitButton) {
            this.submitButton.addEventListener('click', _this.onsubmitButton.bind(_this));
        }
    };
    p.onsubmitButton = function() {
        var _this = this;
        this.isFormValid = true;
        if (this.submitButton.classList.contains('disabled')) {
            return;
        } else {
            for (var i = 0; i < this.getInputElements().length; i++) {
                var flag = _this.validateField(this.inputElements[i]);
                if (!flag) {
                    _this.isFormValid = false;
                }
            }
        }
    };
    p.validateField = function(field) {
        var validField = true;
        if (field.value.trim().length < 1 )
        {
            return !validField;
        }
        switch (field.getAttribute('validattype')) {
            case "firstname":
                validField = this.validateFirstname(field.value, field);
                break;
            case "lastname":
                 validField = this.validateLastname(field.value, field);
                break;
            case "email":
                validField = this.validateEmail(field.value, field);
                break;
            case "phone":
                validField = this.validatePhoneNumber(field.value, field);
                break;
            case "password":
                validField = this.validatePassword(field.value, field);
                break;
			case "company":
                   validField = this.validateCompanyName(field.value, field);
                   break;
            case "checkbox":
               	validField = this.validateCheckbox(field.value, field);
                break;
            case "bussinessemail":
                validField = this.validateBusinessEmail(field.value, field);
                break;
            default:
                break;
        }
        return validField;
    };
	
	p.validateFirstname = function(firstname, initialName) {
        if (firstname && firstname !== "") {
            if (/^[a-zA-Z0-9.,_' -]*$/.test(firstname)) {
                initialName.classList.remove('error');
                initialName.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                initialName.classList.add('error');
                initialName.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.validateLastname = function(lastname, scndName) {
        if (lastname && lastname !== "") {
            if (/^[a-zA-Z0-9.,_' -]*$/.test(lastname)) {
                scndName.classList.remove('error');
                scndName.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                scndName.classList.add('error');
                scndName.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.validateCompanyName = function(company, cmpnyName) {
        if (company && company !== "") {
            if (/^[a-zA-Z0-9.,_' -]*$/.test(company)) {
                cmpnyName.classList.remove('error');
                cmpnyName.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                cmpnyName.classList.add('error');
                cmpnyName.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };


     /* Validate checkbox */
    p.validateCheckbox = function(checkBoxValue, checkBoxField) {
        if (checkBoxField.checked === false) {
            checkBoxField.parentNode.querySelector('.required').classList.add('show');
            return false;
        } else {
            checkBoxField.parentNode.querySelector('.required').classList.remove('show');
            return true;
        }
    };

    p.validatePassword = function(password, passwordField) {
        if (password && password !== "") {
            if (password.length > 7) {
                passwordField.classList.remove('error');
                passwordField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                passwordField.classList.add('error');
                passwordField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.validateEmail = function(mail, emailField) {
        if (mail && mail !== "") {
           if (/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|((([a-zA-Z0-9]+(-[a-zA-Z0-9]+)*)([\.]))+[a-zA-Z]{2,3}))$/.test(mail)) {
                emailField.classList.remove('error');
                emailField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                emailField.classList.add('error');
                emailField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

};
p.validateBusinessEmail = function(mail, emailField) {
    if (mail && mail !== "") {
          if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(mail)) {
      emailField.classList.remove('error');
      emailField.parentNode.querySelector('.syntax').classList.remove('show');
      var invalidDomains = ["@gmail.", "@yahoo.", "@hotmail.", "@live.", "@aol.", "@outlook."];
      var validDomain = true;
       for(var i=0; i < invalidDomains.length; i++) {
          var domain = invalidDomains[i];
         if (mail.indexOf(domain) != -1) {
             validDomain = false;
           }
        }
        if (!validDomain)
        {
              emailField.classList.add('error');
              emailField.parentNode.querySelector('.invalid-domain').classList.add('show');
              return false;
        }
        else {
             emailField.classList.remove('error');
             emailField.parentNode.querySelector('.invalid-domain').classList.remove('show');
              return true;
         }


    } else {
        emailField.classList.add('error');
        emailField.parentNode.querySelector('.syntax').classList.add('show');
        return false;
    }
    }

};
    p.validatePhoneNumber = function(phone, phoneField) {
        if (phone && phone !== "") {
        	if (/^[0-9 +(,)-]*$/.test(phone)) {
                phoneField.classList.remove('error');
                phoneField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                phoneField.classList.add('error');
                phoneField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.checkRequired = function(event) {
        var field = event.currentTarget;
        var requiredFieldValidated = false;
        if (field.getAttribute('required') == "true" && (!field.value || field.value.trim().length < 1)) {
            field.parentNode.querySelector('.required').classList.add('show');
			 if (field.parentNode.querySelector('.synt-error')) {
            field.parentNode.querySelector('.synt-error').classList.remove('show');
           }
            requiredFieldValidated = false;
        } else {
            field.parentNode.querySelector('.required').classList.remove('show');
            requiredFieldValidated = true;
        }
        if (requiredFieldValidated) {
            this.validateField(field);
        }

    };
    p.checkInput = function() {
        var _this = this;
        this.isFormValid = true;
        for (var i = 0;
            (i < this.getInputElements().length && _this.isFormValid === true); i++) {
            var flag = _this.validateField(this.inputElements[i]);
            if (!this.inputElements[i].value || this.inputElements[i].value.trim().length < 1) {
                _this.isFormValid = false;
            } else if (this.inputElements[i].classList.contains('error') === true) {
                _this.isFormValid = false;
            }
            else if (!flag) {
                _this.isFormValid = false;
            }
        }
        if (this.isFormValid && this.isCaptchaValidated()) {
            this.submitButton.classList.remove('disabled');
            clearErrMsgContainer('subscribe-server-error-msg');
            clearErrMsgContainer('ir-toolkitform-server-error-msg');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.add('hide');
                this.remembermeText.classList.remove('hide');
            }
        } else {
            this.submitButton.classList.add('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.remove('hide');
                this.remembermeText.classList.add('hide');
            }
        }

    };

    p.isValidated = function() {
        return this.isFormValid;

    };

    p.getInputElements = function() {
        return this.inputElements || (this.inputElements = document.getElementsByClassName('required-field'));
    };
   
    p.dropDowncheck = function(submitButton) {
        var _this = this;
        this.isFormValid = true;
        this.submitButton = submitButton;
        for (var i = 0;
            (i < this.getInputElements().length && _this.isFormValid === true); i++) {
            if (!this.inputElements[i].value || !this.validateField(this.inputElements[i])) {
                _this.isFormValid = false;

            }
        }
        if (this.isFormValid && this.isCaptchaValidated()) {
            this.submitButton.classList.remove('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.add('hide');
                this.remembermeText.classList.remove('hide');
            }
        } else {
            this.submitButton.classList.add('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.remove('hide');
                this.remembermeText.classList.add('hide');
            }
        }

    };
     p.isCaptchaValidated = function() {
         var isCaptchaValid = true;
         if (window.grecaptcha) {
             try {
                 if (window.grecaptcha.getResponse(0) != "") {
                     isCaptchaValid = true;
                 } else {
                     isCaptchaValid = false;
                 }
             } catch (e) {
                 
                 isCaptchaValid = true;
             }
         }

         return isCaptchaValid;
     };

     p.resetCaptcha = function() {
         if (window.grecaptcha) {
             try {
                 console.log("Reseting captcha");
                 window.grecaptcha.reset(0);
                 this.submitButton.classList.add('disabled');
             } catch (e) {
                 console.log("Error while reseting captcha");
             }
         }
      };


})();
recaptcha_callback = function(response) {
	if(response){
	    _satellite.track("contactUsCaptcha");
	     }
     console.log("contact us captcha callback invoked");
     var isFormAndCaptchaValid = def.formValidation.prototype.isCaptchaValidated();
     var inputFormElements = def.formValidation.prototype.getInputElements();
     for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {
         if (!inputFormElements[i].value || !def.formValidation.prototype.validateField(inputFormElements[i])) {
             isFormAndCaptchaValid = false;
         }
     }
     var formSendButton = document.querySelector('.form-send-button');
     console.log(isFormAndCaptchaValid);
     if (isFormAndCaptchaValid) {
         formSendButton.classList.remove('disabled');
         clearErrMsgContainer('ir-toolkitform-server-error-msg');
     } else {
         formSendButton.classList.add('disabled');
     }
 };

 callback = function() {
     console.log("ir toolkit us captcha callback invoked");
     var isFormAndCaptchaValid = def.formValidation.prototype.isCaptchaValidated();
     var inputFormElements = def.formValidation.prototype.getInputElements();
     for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {
         if (!inputFormElements[i].value || !def.formValidation.prototype.validateField(inputFormElements[i])) {
             isFormAndCaptchaValid = false;
         }
     }
     var formSubmitBtn = document.querySelector(".submit-btn");
     console.log(isFormAndCaptchaValid);
     if (isFormAndCaptchaValid) {
         formSubmitBtn.classList.remove('disabled');
         clearErrMsgContainer('subscribe-server-error-msg');
     } else {

         formSubmitBtn.classList.add('disabled');
     }
 };
 clearErrMsgContainer = function(errMsgContainer) {
	    var subscribeErrMsgContainer = document.getElementsByClassName(errMsgContainer)[0];
	    if (subscribeErrMsgContainer) {
	        if (!subscribeErrMsgContainer.classList.contains('hide')) {
	            subscribeErrMsgContainer.classList.add('hide');
	        }
	    }
	};

/*******************************************************************************
 * Copyright (c) 2017 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     IBM Corporation - initial API and implementation
 *******************************************************************************/
(function() {
    'use strict';

    def.commonFormValidation = function(formIdentity ="") {
        //  this.element = element;
        // this.remembermeText = this.element.querySelector('rememberme-text');
        this.forgotPassword = document.getElementsByClassName('.forgotpassword-text');
        this.remembermeText = document.getElementsByClassName('.rememberme-text');



        this.widgetId = "";
        if (formIdentity) {
            this.form = document.querySelector(formIdentity);
            if (this.form) {
		        this.submitButton = this.form.querySelector(".submit-btn");
		        /*if (this.form.querySelector(".g-recaptcha")) {
		            this.widgetId = this.form.querySelector(".g-recaptcha").getAttribute("widgetid");
		        }*/
	            this.isFormValid;
	            this.init();
	        }
        }
    };

    var p = def.commonFormValidation.prototype;
    def.commonFormValidation.prototype.constructor = def.commonFormValidation;

    p.init = function() {
        this.addEvents();
    };
    p.addEvents = function() {
        var _this = this;
       var InputLength = _this.getInputElements().length;
        for (var i = 0; i < InputLength; i++) {
            var element = _this.inputElements[i];
            element.addEventListener('keyup', _this.checkInput.bind(_this));
            element.addEventListener('change', _this.checkInput.bind(_this));
            element.addEventListener('blur', _this.checkRequired.bind(_this));
            element.addEventListener('change', _this.checkRequired.bind(_this));
            element.addEventListener('keyup', _this.checkRequired.bind(_this));
        }
		//Change for non mandatory fields -START
        var nonMandatoryFieldsLength = _this.getNonMandatoryElements().length;
        if (nonMandatoryFieldsLength > 0) {
            for (var i = 0; i < nonMandatoryFieldsLength; i++) {
                var ele = _this.nonMandatoryElements[i];
                ele.addEventListener('keyup', _this.checkNonMandatory.bind(_this));
            }
        }
        //Change for non mandatory fields -END

        if (this.submitButton) {
            this.submitButton.addEventListener('click', _this.onsubmitButton.bind(_this));
        }
    };
    p.onsubmitButton = function() {
        var _this = this;
        this.isFormValid = true;
        if (this.submitButton.classList.contains('disabled')) {
            return;
        } else {
           var InputLength = _this.getInputElements().length;
            for (var i = 0; i < InputLength; i++) {
                var flag = _this.validateField(this.inputElements[i]);
                if (!flag) {
                    _this.isFormValid = false;
                }
            }
        }
    };
    p.validateField = function(field) {
        var validField = true;
        if (field.value.trim().length < 1 )
        {
            return !validField;
        }
        switch (field.getAttribute('validattype')) {
			case "firstname":
				validField = this.validateFirstname(field.value, field);
				break;
			case "lastname":
				validField = this.validateLastname(field.value, field);
                break;
			case "primaryskill":
                validField = this.validatePrimaryskills(field.value, field);
                break;
            case "secondaryskill":
                validField = this.validateSecondaryskills(field.value, field);
                break;
            case "email":
                validField = this.validateEmail(field.value, field);
                break;
            case "phone":
                validField = this.validatePhoneNumber(field.value, field);
                break;
            case "company":
                validField = this.validateCompanyName(field.value, field);
                 break;
            case "password":
                validField = this.validatePassword(field.value, field);
                break;
            case "checkbox":
               	validField = this.validateCheckbox(field.value, field);
                break;
            case "bussinessemail":
                validField = this.validateBusinessEmail(field.value, field);
                break;
            case "decimalnum":
                validField = this.validateDecimalNumber(field.value, field);
                break;
            case "linkedinUrl":
                validField = this.validateLinkedinUrl(field.value, field);
                break;
            default:
                break;
        }
        return validField;
    };
	
	p.validateFirstname = function(firstname, initialName) {
       if (firstname && firstname !== "") {
           if (/^[a-zA-Z0-9.,_' -]*$/.test(firstname)) {
               initialName.classList.remove('error');
               initialName.parentNode.querySelector('.syntax').classList.remove('show');
               return true;
           } else {
               initialName.classList.add('error');
               initialName.parentNode.querySelector('.syntax').classList.add('show');
               return false;
           }
       }
	};
	p.validatePrimaryskills = function(primaryskills, initialName) {
        if (primaryskills && primaryskills !== "") {
            if (/^[a-zA-Z0-9.,_' -]*$/.test(primaryskills)) {
                initialName.classList.remove('error');
                initialName.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                initialName.classList.add('error');
                initialName.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }
    };
    p.validateSecondaryskills = function(secondaryskills, initialName) {
        if (secondaryskills) {
            if (/^[a-zA-Z0-9.,_' -]*$/.test(secondaryskills)) {
                initialName.classList.remove('error');
                initialName.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                initialName.classList.add('error');
                initialName.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }
    };
	p.validateLastname = function(lastname, scndName) {
       if (lastname && lastname !== "") {
           if (/^[a-zA-Z0-9.,_' -]*$/.test(lastname)) {
               scndName.classList.remove('error');
               scndName.parentNode.querySelector('.syntax').classList.remove('show');
               return true;
           } else {
               scndName.classList.add('error');
               scndName.parentNode.querySelector('.syntax').classList.add('show');
               return false;
           }
       }

    };
	p.validateCompanyName = function(company, cmpnyName) {
       if (company && company !== "") {
           if (/^[a-zA-Z0-9.,&_' -]*$/.test(company)) {
               cmpnyName.classList.remove('error');
               cmpnyName.parentNode.querySelector('.syntax').classList.remove('show');
               return true;
           } else {
               cmpnyName.classList.add('error');
               cmpnyName.parentNode.querySelector('.syntax').classList.add('show');
               return false;
           }
       }
   };
     /* Validate checkbox */
    p.validateCheckbox = function(checkBoxValue, checkBoxField) {
        if (checkBoxField.checked === false) {
            checkBoxField.parentNode.querySelector('.required').classList.add('show');
            return false;
        } else {
            checkBoxField.parentNode.querySelector('.required').classList.remove('show');
            return true;
        }
    };

    p.validatePassword = function(password, passwordField) {
        if (password && password !== "") {
            if (password.length > 7) {
                passwordField.classList.remove('error');
                passwordField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                passwordField.classList.add('error');
                passwordField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.validateEmail = function(mail, emailField) {
        if (mail && mail !== "") {
           if (/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|((([a-zA-Z0-9]+(-[a-zA-Z0-9]+)*)([\.]))+[a-zA-Z]{2,3}))$/.test(mail)) {
                emailField.classList.remove('error');
                emailField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                emailField.classList.add('error');
                emailField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

	};
	p.validateBusinessEmail = function(mail, emailField) {
    if (mail && mail !== "") {
          if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(mail)) {
      emailField.classList.remove('error');
      emailField.parentNode.querySelector('.syntax').classList.remove('show');
      var invalidDomains = ["@gmail.", "@yahoo.", "@hotmail.", "@live.", "@aol.", "@outlook."];
      var validDomain = true;
       for(var i=0; i < invalidDomains.length; i++) {
          var domain = invalidDomains[i];
         if (mail.indexOf(domain) != -1) {
             validDomain = false;
           }
        }
        if (!validDomain)
        {
              emailField.classList.add('error');
              emailField.parentNode.querySelector('.invalid-domain').classList.add('show');
              return false;
        }
        else {
             emailField.classList.remove('error');
             emailField.parentNode.querySelector('.invalid-domain').classList.remove('show');
              return true;
         }


    } else {
        emailField.classList.add('error');
        emailField.parentNode.querySelector('.syntax').classList.add('show');
        return false;
    }
    }

	};
    p.validatePhoneNumber = function(phone, phoneField) {
        if (phone && phone !== "") {
        	if (/^[0-9 +(,)-]*$/.test(phone)) {
                phoneField.classList.remove('error');
                phoneField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                phoneField.classList.add('error');
                phoneField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
    p.validateDecimalNumber = function(decimalnum, decimalField) {
        if (decimalnum && decimalnum !== "") {
            if (/^\d+(\.\d{1,2})?$/.test(decimalnum)) {
                decimalField.classList.remove('error');
                decimalField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                decimalField.classList.add('error');
                decimalField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }

    };
	//Change for non mandatory fields -START
    /* Validation for linkedin URL*/
    p.validateLinkedinUrl = (linkedinUrl, linkedinUrlField) => {
        console.log(linkedinUrl, linkedinUrlField);
        if (linkedinUrl && linkedinUrl !== "") {
            if (/(ftp|http|https):\/\/?(?:www\.)?linkedin.com(\w+:{0,1}\w*@)?(\S+)(:([0-9])+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(linkedinUrl)) {
                linkedinUrlField.classList.remove('error');
                linkedinUrlField.parentNode.querySelector('.syntax').classList.remove('show');
                return true;
            } else {
                linkedinUrlField.classList.add('error');
                linkedinUrlField.parentNode.querySelector('.syntax').classList.add('show');
                return false;
            }
        }
    };
	//Change for non mandatory fields -END
    p.checkRequired = function(event) {
        var field = event.currentTarget;
        var requiredFieldValidated = false;
        if (field.getAttribute('required') == "true" && (!field.value || field.value.trim().length < 1)) {
            field.parentNode.querySelector('.required').classList.add('show');
            requiredFieldValidated = false;
        } else {
            field.parentNode.querySelector('.required').classList.remove('show');
            requiredFieldValidated = true;
        }
        if (requiredFieldValidated) {
            this.validateField(field);
        }

    };
    p.checkInput = function() {
        var _this = this;
        this.isFormValid = true;
		  var inputElements = this.getInputElements().length;
        for (var i = 0;
            (i < inputElements && _this.isFormValid === true); i++) {
            var flag = _this.validateField(this.inputElements[i]);
            if (!this.inputElements[i].value || this.inputElements[i].value.trim().length < 1) {
                _this.isFormValid = false;
            } else if (this.inputElements[i].classList.contains('error') === true) {
                _this.isFormValid = false;
            }
            else if (!flag) {
                _this.isFormValid = false;
            }
        }
        var widgetID = this.getWidgetID();
        if (this.isFormValid && this.isCaptchaValidated(widgetID)) {
            this.submitButton.classList.remove('disabled');
            clearErrMsgContainer('subscribe-server-error-msg');
            clearErrMsgContainer('ir-toolkitform-server-error-msg');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.add('hide');
                this.remembermeText.classList.remove('hide');
            }
        } else {
            this.submitButton.classList.add('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.remove('hide');
                this.remembermeText.classList.add('hide');
            }
        }

    };
	//Change for non mandatory fields -START
    p.checkNonMandatory = function() {
        //console.log("checkNonMandatory");
        var _this = this;
        this.isFormValid = true;
        var nonMandatoryElementsLength = this.getNonMandatoryElements().length;
        if (nonMandatoryElementsLength > 0 && _this.isFormValid) {
            for (var i = 0; i < nonMandatoryElementsLength; i++) {
                var flag = _this.validateField(this.nonMandatoryElements[i]);
                if (!this.nonMandatoryElements[i].value || this.nonMandatoryElements[i].value.trim().length < 1) {
                    _this.isFormValid = false;
                } else if (this.nonMandatoryElements[i].classList.contains('error') === true) {
                    _this.isFormValid = false;
                }
                else if (!flag) {
                    _this.isFormValid = false;
                }
            }
        }
    };
	//Change for non mandatory fields -END

    p.isValidated = function() {
        return this.isFormValid;

    };

   /* p.getInputElements = function() {
        return this.inputElements || (this.inputElements = this.form.getElementsByClassName('required-field'));
    }; */
	
	p.getInputElements = function(formIdentity) {

         if (formIdentity) {

             this.form = document.querySelector(formIdentity);

         }

        return this.inputElements = this.form.getElementsByClassName('required-field');

    };
	//Change for non mandatory fields -START
    p.getNonMandatoryElements = function(formIdentity) {
        //console.log("getNonMandatoryElements");
        if (formIdentity) {
            this.form = document.querySelector(formIdentity);
        }
        return this.nonMandatoryElements = this.form.getElementsByClassName('non-mandatory');
    }
	//Change for non mandatory fields -END

    //DropDown validation Check
    p.dropDowncheck = function(submitButton) {
        var _this = this;
        this.isFormValid = true;
        this.submitButton = submitButton;
		var InputLength = this.getInputElements().length
        for (var i = 0;
             (i < InputLength && _this.isFormValid === true); i++) {
            if (!this.inputElements[i].value || !this.validateField(this.inputElements[i])) {
                _this.isFormValid = false;

            }
        }
        var widgetID = this.getWidgetID();
        if (this.isFormValid && this.isCaptchaValidated(widgetID)) {
            this.submitButton.classList.remove('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.add('hide');
                this.remembermeText.classList.remove('hide');
            }
        } else {
            this.submitButton.classList.add('disabled');
            if (this.formName == 'signin') {
                this.forgotPassword.classList.remove('hide');
                this.remembermeText.classList.add('hide');
            }
        }

    };
    p.isCaptchaValidated = function(widgetId = "") {
        var isCaptchaValid = true;
        if (window.grecaptcha) {
            try {
                if (widgetId=="" && window.grecaptcha.getResponse() != "") {
                    isCaptchaValid = true;
                } else if(widgetId!="" && widgetId!=null && window.grecaptcha.getResponse(widgetId) != "") {
                    isCaptchaValid = true;
                } else {
                    isCaptchaValid = false;
                }
            } catch (e) {
                // Captcha is not present in loaded page
                isCaptchaValid = true;
            }
        }

        return isCaptchaValid;
    };

    p.resetCaptcha = function() {
         if (window.grecaptcha) {
             try {
                 console.log("Reseting captcha");
                 window.grecaptcha.reset(0);
                 this.submitButton.classList.add('disabled');
             } catch (e) {
                 console.log("Error while reseting captcha");
             }
         }
      };
      p.changeSubmitBtnState = function(isFormAndCaptchaValid) {
          if (isFormAndCaptchaValid) {
              this.submitButton.classList.remove('disabled');
              clearErrMsgContainer('ir-toolkitform-server-error-msg');
          } else {
              this.submitButton.classList.add('disabled');
          }
       }
	p.findParentForm = function(elem) {
          var parent = elem.parentNode;
          if (parent && parent.tagName != 'FORM') {
              parent = this.findParentForm(parent);
          }
          return parent;
      };
		
	p.getWidgetID = function() {
        if (this.form.querySelector(".g-recaptcha")) {
            this.widgetId = this.form.querySelector(".g-recaptcha").getAttribute("widgetid");
        }
        return this.widgetId;
    }

		
})();
var onloadCommonCaptchaCallback = function() {
    var gRecaptchaContainer = document.querySelectorAll('.g-recaptcha');
    var siteKey = "6LcUNxYUAAAAAKay5vQQQiz8ttjhaGk6jCHljsoQ";
    if (gRecaptchaContainer.length > 0) {
        gRecaptchaContainer.forEach(function (el, index) {
		try{
		  widgetID = grecaptcha.render(el, {
                'sitekey': "6LcUNxYUAAAAAKay5vQQQiz8ttjhaGk6jCHljsoQ",
                'callback': function() {
                    validationCheck(index)
                },
                'expired-callback': function() {
                    validationCheck(index)
                }
            });
            el.setAttribute('widgetid', widgetID);
		}catch(re){
			console.log('captcha exception');
		}
        });

    }
}
//recaptcha_callback = function(response) {
 //   console.log("contact us captcha callback invoked");
 //   validationCheck(".contact-form-identity");
 //};
 marketorecaptcha_callback = function(response) {
	    console.log("marketo captcha callback invoked");
	    validationCheck(".marketoFormIdentity");
 }
 
 /*validationCheck = function(formIdentity) {
	    var form = document.querySelector(formIdentity);
	    var widgetId = form.querySelector(".g-recaptcha").getAttribute("widgetid");
	    var formSubmitBtn = form.querySelector(".submit-btn");
	    var formValObj = new def.commonFormValidation(formIdentity);
	    var isFormAndCaptchaValid = formValObj.isCaptchaValidated(widgetId);
	    var inputFormElements = formValObj.getInputElements();
	    for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {
	        if (!inputFormElements[i].value || !formValObj.validateField(inputFormElements[i])) {
	            isFormAndCaptchaValid = false;
	        }
	    }
	    console.log(isFormAndCaptchaValid);
	    formValObj.changeSubmitBtnState(isFormAndCaptchaValid);
	}*/

	
	validationCheck = function(indexK) {

	var gRecaptchaContainer = document.querySelectorAll('.g-recaptcha')[indexK];
    var formIdentity = "#"+gRecaptchaContainer.closest(".form-id").getAttribute("id");
     var form = document.querySelector(formIdentity);

     var widgetId = form.querySelector(".g-recaptcha").getAttribute("widgetid");

     var formSubmitBtn = form.querySelector(".submit-btn");
	  //var formValObj = new def.commonFormValidation(formIdentity);
    var isFormAndCaptchaValid = def.commonFormValidation.prototype.isCaptchaValidated(widgetId);
    var inputFormElements = def.commonFormValidation.prototype.getInputElements(formIdentity);


     for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {

          if (!inputFormElements[i].value || !def.commonFormValidation.prototype.validateField(inputFormElements[i])) {

             isFormAndCaptchaValid = false;

         }

     }

     console.log(isFormAndCaptchaValid);
    if (isFormAndCaptchaValid) {
         formSubmitBtn.classList.remove('disabled');
     } else {
         formSubmitBtn.classList.add('disabled');
     }


    // formValObj.changeSubmitBtnState(isFormAndCaptchaValid);

 }
	
	
	
	
	
	
	
	
	
	
	

recaptcha_callback1 = function() {
     console.log("contact us captcha callback invoked");
     var isFormAndCaptchaValid = def.formValidation.prototype.isCaptchaValidated();
     var inputFormElements = def.formValidation.prototype.getInputElements();
     for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {
         if (!inputFormElements[i].value || !def.formValidation.prototype.validateField(inputFormElements[i])) {
             isFormAndCaptchaValid = false;
         }
     }
     var formSendButton = document.querySelector('.form-send-button');
     console.log(isFormAndCaptchaValid);
     if (isFormAndCaptchaValid) {
         formSendButton.classList.remove('disabled');
         clearErrMsgContainer('ir-toolkitform-server-error-msg');
     } else {
         formSendButton.classList.add('disabled');
     }
 };

 callback = function() {
     console.log("ir toolkit us captcha callback invoked");
     var isFormAndCaptchaValid = def.formValidation.prototype.isCaptchaValidated();
     var inputFormElements = def.formValidation.prototype.getInputElements();
     for (var i = 0; (i < inputFormElements.length && isFormAndCaptchaValid === true); i++) {
         if (!inputFormElements[i].value || !def.formValidation.prototype.validateField(inputFormElements[i])) {
             isFormAndCaptchaValid = false;
         }
     }
     var formSubmitBtn = document.querySelector(".submit-btn");
     console.log(isFormAndCaptchaValid);
     if (isFormAndCaptchaValid) {
         formSubmitBtn.classList.remove('disabled');
         clearErrMsgContainer('subscribe-server-error-msg');
     } else {

         formSubmitBtn.classList.add('disabled');
     }
 };
 clearErrMsgContainer = function(errMsgContainer) {
	    var subscribeErrMsgContainer = document.getElementsByClassName(errMsgContainer)[0];
	    if (subscribeErrMsgContainer) {
	        if (!subscribeErrMsgContainer.classList.contains('hide')) {
	            subscribeErrMsgContainer.classList.add('hide');
	        }
	    }
	};

(function() {
    'use strict';
    def.DropDownList = function() {
        this.name = 'dropDownList';

        this.init();
    };
    var p = def.DropDownList.prototype;
    def.DropDownList.prototype.constructor = def.DropDownList;

    p.init = function() {
        this.addEvents();
        this.pageBody = document.querySelector('body');
    };

    p.addEvents = function() {
        var _this = this;
        var dropDownListCount = _this.getDropDownElements().length;

        //select box focus event listener
        for (var i = 0; i < dropDownListCount; ++i) {
            var element = _this.DropDownElements[i];
            element.addEventListener('focus', this.openDropDownList.bind(_this), false);
        }

    };

    //append selected content to the input
    p.openDropDownList = function(event) {
        var _this = this;
        this.closeDropDownList();

        event.target.classList.add('open');
        var dropDownList = event.target.parentNode.querySelector('.custom-selectBox-content');
        dropDownList.classList.add('open');
        var dropDownOptions = document.querySelectorAll('.custom-selectBox-content.open li');
        if (dropDownOptions) {
            for (var i = 0; i < dropDownOptions.length; i++) {
                dropDownOptions[i].addEventListener('click', function() {
                    var selectedOption = this.textContent;
                    var dropDownContainer = this.parentNode.parentNode;
                    var targetInputField = dropDownContainer.querySelector('input');
                    targetInputField.blur();
                    targetInputField.value = selectedOption;
                    _this.closeDropDownList();
                   
                 // Remove error after appending value
                    if (targetInputField.value != '') {
                        if (targetInputField.classList.contains('error') === true) {
                            targetInputField.classList.remove('error');
                        }
                    }            
                                                           
                    dropDownContainer.querySelector('.required').classList.remove('show');
                    var requiredFieldValidated = true;
                    if (requiredFieldValidated) {
						this.contactUsSend = document.querySelector('.form-send-button');
                        var tblGrid = document.querySelectorAll('.table-grid');
                        this.marketoSibos = document.querySelector('.marketo-sibos');
                        // Update delete form
                        this.updatePersonalInfoExp = document.querySelector('.accordion-item.expanded .update-personal-info');
                        if (this.updatePersonalInfoExp) {
                            obj.UpdateFormValidation.dropDowncheck();
                        }

                        if (tblGrid.length > 0) {
                            // Update delete form
                            if (this.updatePersonalInfoExp) {
                                obj.UpdateFormValidation.validateField(targetInputField);
                            }
                            else {
                                obj.CareersFormValidation.validateField(targetInputField);
                            }
                        } else {
                           if(this.marketoSibos)
                         {
                             this.submitbtn = document.querySelector('.marketo-sibos').querySelector('.submit-btn');
                             this.formIdentity = ".marketoFormIdentity";
                             this.formValidation = new def.marketoFormValidation(this.formIdentity);
                             this.formValidation.dropDowncheck( this.submitbtn);
                         }
                         else
                         {
                            this.formValidation = new def.formValidation(targetInputField);
                        }

                            //Only for contact us submit -- Quick fix

                            if (this.contactUsSend && typeof this.contactUsSend !== "undefined") {
                                this.formValidation.dropDowncheck(this.contactUsSend);
                            }
                        }
                    }
                });
            }
        }
        var inputOpen = document.querySelector('input.open');
        var selectedListItem = inputOpen.parentNode.querySelector('.custom-selectBox-content.open li');
        if (selectedListItem.classList.contains('selected')) {
            selectedListItem.classList.remove('selected');
        }
        inputOpen.addEventListener('keydown', function(event) {
            event.stopImmediatePropagation();
            var selectedItem = inputOpen.parentNode.querySelector('.custom-selectBox-content.open li.selected');
            var listIems = inputOpen.parentNode.querySelectorAll('.custom-selectBox-content.open li');
            var length = listIems.length;
            //on downarrow press
            if (event.keyCode === 40) {
                if (selectedItem) {
                    for (var i = 0; i < length; i++) {
                        if (listIems[i].classList.contains('selected')) {
                            listIems[i].classList.remove('selected');
                            if (i === length - 1) {
                                listIems[0].classList.add('selected');
                            } else {
                                listIems[i + 1].classList.add('selected');
                            }
                            break;
                        }
                    }
                }
                else {
                    listIems[0].classList.add('selected');
                }
                event.preventDefault();
            }
            //on uparrow press
            if (event.keyCode === 38) {
                if (selectedItem) {
                    for (var i = length - 1; i < length; i--) {
                        if (listIems[i].classList.contains('selected')) {
                            listIems[i].classList.remove('selected');
                            if (i === 0) {
                                listIems[length - 1].classList.add('selected');
                            } else {
                                listIems[i - 1].classList.add('selected');
                            }
                            break;
                        }
                    }
                }
                event.preventDefault();
            }
            //select option on enter
            if (event.keyCode === 13) {
                if (selectedItem) {
                    var selectedOption = selectedItem.textContent;
                    inputOpen.value = selectedOption;
                    inputOpen.blur();
                    _this.closeDropDownList();
                }
                event.preventDefault();
            }
            return false;
        });
        //key press value hold array
        var keyPressObj = [];

        inputOpen.addEventListener('keypress', function(event) {

            event.stopImmediatePropagation();
            var firstItemExist = false;
            var listIems = inputOpen.parentNode.querySelectorAll('.custom-selectBox-content.open li');
            //fix for firefox
            var preesedKey = event.keyCode || event.charCode;
            var keyVal = String.fromCharCode(preesedKey);

            keyPressObj.push(keyVal);

            //Finding  the occurance of the key press value

            var occurancesObj = keyPressObj.filter(function(val) {
                return val === keyVal;
            });
            //Length of the keypress value
            var occurances = occurancesObj.length;
            //Fincding the key press value is aready in the array keyPressObj
            /* var alreadyIn = keyPressObj.indexOf(keyVal);
             Check the the key presss value is new
             if (alreadyIn > 0) {
                // keyPressObj = [];
             }*/
            var findedArray = [];
            listIems.forEach(function(element, index) {
                element.classList.remove("selected");
                var firstLetter = element.textContent.charAt(0);
                if (firstLetter.toLowerCase() === keyVal.toLowerCase()) {
                    findedArray.push(element);
                }
            }, this);
            var occuranceIndex = occurances - 1;
            var selectedElement = findedArray[occuranceIndex];
            var scrollContainer = inputOpen.parentNode.querySelector('.custom-selectBox-content');

            if (typeof selectedElement === "undefined") {
                selectedElement = findedArray[0];
                keyPressObj = [];
                keyPressObj.push(keyVal);

            }
            if (selectedElement) {
                selectedElement.classList.add("selected");
                //Set scroll to selected list item
                scrollContainer.scrollTop = selectedElement.offsetTop;
            }

        });
        if (this.pageBody) {
            this.pageBody.addEventListener('click', _this.onClkBody, false);
        }
    };

      p.onClkBody = function (event) {
        var _this = this;
        if (event.target.classList.contains('open')) {
            if (this.pageBody) {
                this.pageBody.removeEventListener('click', _this.onClkBody, false);
            }
        }
        else {
            p.closeDropDownList();
        }
    };

    //close select box options
    p.closeDropDownList = function() {
        var _this = this;
        var dropdDownListOpen = document.querySelector('.custom-selectBox-content.open');
        var inputOpen = document.querySelector('input.open');
        if (inputOpen) {
            inputOpen.classList.remove('open');
        }
        if (dropdDownListOpen) {
            dropdDownListOpen.classList.remove('open');
        }
        if (this.pageBody) {
            this.pageBody.removeEventListener('click', _this.onClkBody, false);
        }
    };

    //get selectbox input elements
    p.getDropDownElements = function() {
        return (this.DropDownElements = document.querySelectorAll('.custom-selectBox input'));
    };

    obj.dropDownList = new def.DropDownList();

})();

(function() {
    'use strict';

    var Header = function() {

        this.init = init;
        this.addEvents = addEvents;

        this.onSubmitSearchForm = onSubmitSearchForm;
        this.showSearchResults = showSearchResults;
        this.getContentTypes = getContentTypes;
        this.setContentTypes = setContentTypes;
        this.getSearchResults = getSearchResults;
        this.setSearchResults = setSearchResults;
        this.toggleContentTypeDropDown = toggleContentTypeDropDown;
        this.toggleMegaMenu = toggleMegaMenu;
        this.showOverlay = showOverlay;
        this.closeOverlay = closeOverlay;
        this.closeSubmenu = closeSubmenu;
        this.onBodyScroll = onBodyScroll;
        this.showSubmenu = showSubmenu;
        this.hideMenu = hideMenu;
        this.showSearchForm = showSearchForm;
        this.hideSearchForm = hideSearchForm;
        this.getRequestParams = getRequestParams;
        this.setUrlHash = setUrlHash;
        this.onChangeSearchInput = onChangeSearchInput;
        this.onHashChange = onHashChange;
        this.loadNextPageResults = loadNextPageResults;
        this.loadPrevPageResults = loadPrevPageResults;
        this.isInArray = isInArray;
        this.setSearchHref = setSearchHref;
        this.setSuggestions = setSuggestions;
        /* for third part links */
        this.showPromptSection = showPromptSection;
        this.hidePromptSection = hidePromptSection;
        this.getContentTypeArray = getContentTypeArray;
        this.navigateSearchPredictions = navigateSearchPredictions;
        this.showSearchResultsByPageNum = showSearchResultsByPageNum;
        var search=false; //for analytics
        this.init();

        function init() {
            this.name = 'Header';
            this.elm = document.querySelector('header');
            this.body = document.querySelector('body');
            this.main = this.body.querySelector('main');
            this.overlay = document.querySelector('.overlay');
            // this.pageOverlay = document.querySelector('.page-overlay');
            this.pageOverlay = document.querySelector('.page-overlay-header');

            this.brandOverlay = document.querySelector('.mobile-brand-overlay');
            this.navLocal = this.elm.querySelector('#nav-local');
            this.searchIcon = this.elm.querySelector('.search-icon');
            this.searchIconContainer = this.elm.querySelector('#search-icon-container');
            this.searchContainer = this.elm.querySelector('#search-container');
            this.searchForm = this.elm.querySelector('#search-form');
            this.searchInput = this.elm.querySelector('.header-search-text');
            this.searchSuggestions = this.elm.querySelector('#search-suggestions');
            this.searchListItems = this.elm.querySelectorAll('#search-suggestions .search-suggest-item');
            this.searchResultsContainer = this.elm.querySelector('.search-results-container');
            this.contentTypeWrapper = this.elm.querySelector('#content-type-wrapper');
            this.tileWrapper = this.elm.querySelector('.search-results-tile');
            this.tileWrapperRow = this.elm.querySelector('.search-results-tile .row');
            this.listWrapper = this.elm.querySelector('.search-results-list');
            this.contentTypeHeading = this.elm.querySelector('.content-type-heading');
            this.contentTypeDropDown = this.elm.querySelector('.content-type-drop-down');
            this.contentTypeSelect = this.elm.querySelector('.content-type-select');
            this.contentTypeContainer = this.elm.querySelector('.content-type-container');
            this.hamIcon = this.elm.querySelector('#header-hamberger');
            this.hamIconContainer = this.elm.querySelector('.header-hamberger-container');
            this.tcsHeaderLogo = this.elm.querySelector('.mobile-logo  a.tcs-50-brand-logo');
            this.multiBrandLogo = this.elm.querySelector('.mobile-logo a.multi-brand-logo');
            this.tataHeaderLogo = this.elm.querySelector('.mobile-logo a.tata-group-logo');
            this.searchIconNew = this.elm.querySelector('a.search-icon');
            this.subMenus = document.querySelectorAll('.menu-item .menu-item-content.main-menu-items');
            this.contactButton = this.elm.querySelector('a#contactus-banner');
            this.contactShrinkButton = this.elm.querySelector('.contact-overlay-button');
            this.megaMenu = this.elm.querySelector('.mega-menu');
            this.leftArrows = this.elm.querySelectorAll('.menu-item-left-arrow');
            this.mainMenuItems = this.elm.querySelectorAll('.menu-item-link');
            this.paginationInput = this.elm.querySelector('.pagination-from-text');
            this.searchLoadMoreButton = this.elm.querySelector('#search-load-more');
            this.searchPaginationNextIcon = this.elm.querySelector('#search-pagination-next');
            this.searchPaginationPrevIcon = this.elm.querySelector('#search-pagination-previous');
            this.totalSearchPages = this.elm.querySelector('.pagination-to');
            this.progressBar = document.querySelector('.progress');
            this.menuItemContent = this.elm.querySelectorAll('.menu-item-content');
            this.newsEventsFilter = document.querySelector('.news-events-filter');
            this.searchNoResults = this.elm.querySelector('#no-results-section');
            this.contentTagSelected = this.elm.querySelector('.content-tag-selected');

            //this.scrollTop = 0;
            this.updateContentTypes = true;
            /* for third part links */
            this.externalLinks = document.querySelectorAll('.external-link');
            this.externalOkLink = this.elm.querySelector('.prompt-ok');
            this.overlayWrapper = document.querySelector('.overlay-content-wrapper');
            this.promptSection = document.querySelector('.prompt-section');
            this.promptCancel = this.elm.querySelector('.prompt-cancel');
            this.isThirdParty = 0;
            this.filterTag = null;
            this.pageReload = true;
            this.prevUrlHash = "";
            this.addEvents();
            this.setSearchHref();
            this.onHashChange();
        };

        function addEvents() {
            var _this = this;
            var leftArrowsCount = this.leftArrows.length;
            var mainMenuItemsCount = this.mainMenuItems.length;
            if (document.querySelector('.debounce-delay')){
                var debounceDelay = document.querySelector('.debounce-delay').value;
                var debouncedKeyUp = debounce(searchdebounce, debounceDelay);
            }

            if (this.main && this.main.classList.contains('perspectiveContactus')) {
                if (document.querySelector('#contactus-banner').getAttribute('href')) {
                    document.querySelector('#contactus-banner').removeAttribute('href');
                }
                if (document.querySelector('#contactus-banner').getAttribute('data-href')) {
                    document.querySelector('#contactus-banner').removeAttribute('data-href');
                }
                if (!document.querySelector('#contactus-banner').classList.contains('perspective-contact')) {
                    document.querySelector('#contactus-banner').classList.add('perspective-contact');
                }
            }

            function searchdebounce(evt) {

                var key = evt.which || evt.keyCode;
                    if (key !== 13 && key !== 38 && key !== 40) {
                        search=false;	//for Analytics
                        _this.onChangeSearchInput(evt, this);
                     // _this.searchSuggestions.classList.remove('hide');
                     // _this.searchNoResults.classList.add('hide');
                    } else if (key === 38 || key === 40) {
                        _this.navigateSearchPredictions(key, this);
                    }
            }
            if (this.searchInput) {
                this.searchInput.addEventListener('keyup', debouncedKeyUp);
            }
            if(this.searchSuggestions) {
                this.searchSuggestions.addEventListener('click', function(evt) {
                    _this.searchInput.value = utils.getSanitizedText(evt.target.textContent).trim();
                    _this.paginationInput.value = 1;
                    _this.filterTag = 'All';
                    _this.setUrlHash();
                    _this.searchNoResults.classList.add('hide');
                }, false);
            }

            if(this.searchInput) {
                this.searchInput.addEventListener('keypress', function(evt) {
                    var key = evt.which || evt.keyCode;
                    if (key === 13) {
                        _this.prevUrlHash = utils.getSanitizedURL(location.hash);
                        _this.setUrlHash();
                        if (_this.prevUrlHash === location.hash)
                        {
                            _this.searchNoResults.classList.add('hide');
                            _this.searchResultsContainer.classList.add('hide');
                            _this.onHashChange();
                        }
                        _this.filterTag = 'All';
                        _this.paginationInput.value = 1;
                    }
                });
            }
            if(this.contentTypeHeading) {
                this.contentTypeHeading.addEventListener('click', function() {
                    _this.toggleContentTypeDropDown(this);
                }, false);
            }
			
			var element = document.querySelector('.mega-menu');
            var focusableElements = element.querySelectorAll('a:not([disabled]),button:not([disabled]),input[type="text"]:not([disabled]),input[type="radio"]:not([disabled]),input[type="checkbox"]:not([disabled]),textarea:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])'),
                firstFocusableElement = focusableElements[0];

            if(this.hamIcon) {
                 this.hamIcon.addEventListener('click', function(event) {
                    _this.toggleMegaMenu(event, this);
                }, false);
               

                this.hamIcon.addEventListener('keydown', function(event) {

                    if (event.which == 32 || event.which == 13){
                        _this.toggleMegaMenu(event, this);
                      //  _this.hamIcon.click();
                        if (_this.hamIcon.classList.contains('clicked')) {
                            firstFocusableElement.focus();
                        }
                        else {
                            _this.hamIcon.focus();
                        }
                    }
                     if (event.which == 9 && !event.currentTarget.classList.contains('clicked')) {

                        if (document.querySelector('a#contactus-banner')) {
                            document.querySelector('a#contactus-banner').focus();
                            event.preventDefault();
                        }
                        else {
                            //for contact us html
                            var templateFirstElm = document.querySelector('main').querySelectorAll('a:not([disabled]),button:not([disabled]),input[type="text"]:not([disabled]),input[type="radio"]:not([disabled]),input[type="checkbox"]:not([disabled]),textarea:not([disabled]),select:not([disabled]),[tabindex]:not([tabindex="-1"])');
                            templateFirstElm[0].focus(); // focusing first element outside hamberger menu
                        }
                    }
					if (event.which == 9 && event.shiftKey) {
                        if (!event.currentTarget.classList.contains('clicked')) {
                            document.querySelector('a.search-icon').focus();
                            event.preventDefault();
                        }
                        if (event.currentTarget.classList.contains('clicked')) {
                            event.preventDefault();
                        }
                    }

                }, false);

            }
			
			if (this.megaMenu) {
                let element = document.querySelector('.mega-menu');
                //let focusableElements = element.querySelectorAll('li.menu-item.main-menu-items a:not([tabindex="-1"]),li.thin-header-item a:not([tabindex="-1"])'),
               let focusableElements = element.querySelectorAll('li.menu-item.main-menu-items:not([hide]) span a'),
               firstFocusableElement = focusableElements[0];
             this.megaMenu.addEventListener('keydown', function(event) {
                   // forward and reverse travesty
                   if (window.innerWidth < 1024) {
                   let element = document.querySelector('.mega-menu');
                   let focusable = element.querySelectorAll('li.menu-item.main-menu-items:not(.hide) span a');
                   for (var i = 0; i < focusable.length; i++) {
                       if (focusable[i] == document.activeElement) {
                           if (!event.shiftKey && event.which == 9) {
                               var x = ++i;
                               if (x < focusable.length) {
                                   focusable[x].focus();
                                   event.preventDefault();
                               }
                           }
                           if (event.shiftKey && event.which == 9) {
                               console.log(focusable);
                               if (document.activeElement === focusable[0]) {
                                   var closeBtn = document.querySelector('#header-hamberger.clicked');
                                   closeBtn.focus();
                                   event.preventDefault();
                               }

                               else {
                                   focusable[i - 1].focus();
                                   event.preventDefault();
                               }
                           }
                       }
                   }
               }

                });
            }
			
			// moving focus from logo to search icon on tab press
             if (this.tcsHeaderLogo) {
                this.tcsHeaderLogo.addEventListener('keydown', function(event) {
                    if (window.utils.isMobile || window.utils.isTablet) {
						console.log(_this.multiBrandLogo);
                        if (event.which == 9) {

                                _this.tataHeaderLogo.focus();
                                event.preventDefault();

                        }
                        if (event.shiftKey && event.which == 9) {
                            _this.tcsHeaderLogo.focus();
                            event.preventDefault();
                        }
                    }
                });
            }
            if (this.tataHeaderLogo) {
                this.tataHeaderLogo.addEventListener('keydown', function(event) {
                    if (window.utils.isMobile || window.utils.isTablet) {
                        if (event.which == 9) {
                            document.querySelector('a.search-icon').focus();
                            event.preventDefault();
                        }
                        if (event.shiftKey && event.which == 9) {
                            _this.tcsHeaderLogo.focus();
                            event.preventDefault();
                        }
                    }
                });

            }
            if (this.searchIconNew) {
                this.searchIconNew.addEventListener('keydown', function(event) {
                if (window.utils.isMobile || window.utils.isTablet) {
                    if (event.which == 9) {
                        _this.hamIcon.focus();
                        event.preventDefault();
                    }
                    if (event.shiftKey && event.which == 9) {
                        _this.tataHeaderLogo.focus();
                        event.preventDefault();
                    }
                    }
                });
            }



            for (var h = 0; h < leftArrowsCount; h++) {
                var leftArrow = this.leftArrows[h];
                leftArrow.addEventListener('click', this.closeSubmenu, false);
				leftArrow.addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13) {
                        leftArrow.click();
                    }
                });
            }

            if (this.searchListItems) {
                for (var i = 0; i < this.searchListItems.length; i++) {
                    var eachSearchSuggestion = this.searchListItems[i];
                    eachSearchSuggestion.addEventListener('keydown', function(event) {
                        if (event.which == 32 || event.which == 13)
                            this.click()
                    }, false);
                }
            }

            for (var k = 0; k < mainMenuItemsCount; k++) {
                var mainMenuItem = this.mainMenuItems[k];
                if (this.mainMenuItems[k].classList.contains('no-submenu') === true) {
                   mainMenuItem.addEventListener('mouseover', function(event) {
                       if (window.innerWidth >= 1024) {
                            _this.hideMenu(event, this);
                        }
                        _this.closeOverlay(event, this);
                    }, false);
                } else {
                   if (window.utils.isMobile) {
                        if (mainMenuItem.querySelector('.menu-item-right-arrow')) {
                            mainMenuItem.addEventListener('click', function(event) {
                                _this.showSubmenu(event, this);
                                event.preventDefault();
                            }, false);
                        }
                   } else {
                       if (mainMenuItem) {
                           mainMenuItem.addEventListener('mouseover', function(event) {
                              var responsiveChangeDesktop = true;
                            console.log(window.innerWidth);
                            if (window.innerWidth < 1024) {
                                responsiveChangeDesktop = false;
                            }
                            else {
                                responsiveChangeDesktop = true;
                            }

                            if (responsiveChangeDesktop) {

                                    _this.showSubmenu(event, this);
                                }

                        }, false);
                        mainMenuItem.addEventListener('click', function(event) {
                            let responsiveChangeDesktopClick = true;
                            console.log(window.utils.isMobile);
                            if (window.innerWidth < 1024) {
                                responsiveChangeDesktopClick = false;
                            }
                            else {
                                responsiveChangeDesktopClick = true;
                            }

                            if (!responsiveChangeDesktopClick) {

                                    _this.showSubmenu(event, this);
                                }

                           }, false);
                       }
                       if (mainMenuItem) {
                           mainMenuItem.addEventListener('keyup', function(event) {
                                if (event.which === 13 || event.which === 32) {
                                if (window.innerWidth >= 1024) {
                                    _this.showSubmenu(event, this);
                                }

                               }
                           });
                       }
                        if (window.utils.isMobile) {
                            if (mainMenuItem.querySelector('.menu-item-right-arrow')) {
                                mainMenuItem.addEventListener('click', function(event) {
                                    _this.showSubmenu(event, this);
                                    event.preventDefault();
                                }, false);
                            }
                        }
                        else
                            mainMenuItem.addEventListener('click', setMainMenuNavigation, false);

                        }
                    }
                }

            if (this.pageOverlay) {
                this.pageOverlay.addEventListener('mouseover', function(event) {
                    _this.hideMenu(event, this);
                }, false);
                if (mainMenuItem) {
                    mainMenuItem.addEventListener('keydown', function(event) {
                        if (event.which == 32 || event.which == 13 || event.which == 9 )
                            _this.showSubmenu(event, this);
                    }, false);
                }
            }

            document.addEventListener('keydown', function(event) {
                if (event.which == 27) {
                    var evt = document.createEvent('MouseEvents');
                    evt.initEvent('click', true, false);
                    //  _this.toggleMegaMenu(evt, this);
                    _this.hideMenu(evt, this);
                }
            }, false);
            if(this.searchContainer){
                this.searchContainer.addEventListener('mouseover', function(event) {
                    _this.hideMenu(event, this);
                }, false);
            }
            if(this.searchIconContainer){
                this.searchIconContainer.addEventListener('mouseover', function(event) {
                    _this.hideMenu(event, this);
                    _this.closeOverlay(event, this);
                }, false);
            }
            if (this.subMenus) {
            if (window.innerWidth < 1024) {
                    this.subMenus.forEach(innerLi => {
                       var liFirstElm = innerLi.querySelector('.menu-sub-item .menu-item-contents:first-child');
                       var liLastElm = innerLi.querySelector('li.menu-item-column:last-child li.menu-item-contents:last-child');
                       var spanArrowLeft = innerLi.querySelector('span.menu-item-left-arrow')

                       liFirstElm.addEventListener('keydown', function(e) {
                           if (e.shiftKey && e.which == 9) {
                               spanArrowLeft.focus();
                               e.preventDefault();
                           }
                       });
                       liLastElm.addEventListener('keydown', function(e) {
                           if (!e.shiftKey && e.which == 9) {
                               spanArrowLeft.focus();
                               e.preventDefault();
                           }
                          // else
                            //  spanArrowLeft.style.outline = "none";
                       });
                       spanArrowLeft.addEventListener('keydown', function(e) {
                           if (e.shiftKey && e.which == 9) {
                               if (liLastElm.querySelector('a')) {
                                   liLastElm.querySelector('a').focus();
                                   e.preventDefault();
                               }
                               else {
                                   liLastElm.focus();
                               }
                           }
                           if (e.which == 32 || e.which == 13) {
                               //focusing back to hamburger menu item
                               var mainMenuLink = this.offsetParent.parentElement;
                               mainMenuLink.querySelector('span a').focus();
                           }
                       });
                   });
               }
           }

            if (this.pageOverlay) {
                this.pageOverlay.addEventListener('click', function(event) {
                    _this.hideMenu(event, this);
                }, false);
            }

            if(this.searchForm){
                this.searchForm.addEventListener('submit', function(event) {
                    _this.onSubmitSearchForm(event);
                }, false);
            }

            if( this.contactButton){
               this.contactButton.addEventListener('mouseover', function(event) {
                    _this.contactButton.classList.remove('shrink-mobile');
                }, false);
				this.contactButton.addEventListener('keydown', function(event) {
                    if(event.shiftKey && (event.which == 9 ) ){
						if(window.utils.mobile || window.utils.isTablet){
                            _this.hamIcon.focus();
                        event.preventDefault();
					   }
                    }
                });

            }

            if(this.searchLoadMoreButton){
                this.searchLoadMoreButton.addEventListener('click', function(event) {
                    _this.loadNextPageResults();
                }, false);
            }

            if(this.searchPaginationNextIcon){
                this.searchPaginationNextIcon.addEventListener('click', function(event) {
                    _this.loadNextPageResults();
                }, false);
            }

            if(this.searchPaginationPrevIcon){
                this.searchPaginationPrevIcon.addEventListener('click', function(event) {
                    _this.loadPrevPageResults();
                }, false);
            }


            /* for third part links */
            if (this.externalLinks) {
                var externalLinkCount = this.externalLinks.length;
                for (var l = 0; l < externalLinkCount; l++) {
                    var externalLink = this.externalLinks[l];
                    externalLink.addEventListener('click', function(event) {
                        _this.isThirdParty = 1;
                        event.preventDefault();
                        // var externalUrl = this.getElementsByTagName('a')[0].href;
                        var externalUrl = this.href;
                        var isHeaderMenuItem = false;
                        var parentElem = this.parentElement;
                        if (parentElem && parentElem.classList && parentElem.classList.contains('menu-item-link')) {
                            isHeaderMenuItem = true;
                        }
                        _this.showPromptSection(event,externalUrl, isHeaderMenuItem);
                    }, false);
                }
            }
            if(this.externalOkLink){
                this.externalOkLink.addEventListener('click', function(event) {
                    // event.preventDefault();
                    _this.hidePromptSection();
                }, false);
            }

            if(this.promptCancel){
                this.promptCancel.addEventListener('click', function(event) {
                    event.preventDefault();
                    _this.hidePromptSection();
                }, false);
            }

            if(this.paginationInput){
                this.paginationInput.addEventListener('keyup', function(event) {
                    var key = event.which || event.keyCode;
                    if (key === 13) {
                        _this.showSearchResultsByPageNum();
                    }
                }, false);
            }
        };
        
        function setMainMenuNavigation(event) {
            if (this.childNodes[1].href.indexOf("#") != -1) {
                event.preventDefault();
            }
        } 
        function getRequestParams() {
            var requestParams = {};
            var contentTypeText;
            var sortTypeText;
            var query = (this.searchInput.value && this.searchInput.value !== 'undefined') ? this.searchInput.value.trim() : '';

            var filter = '';
            var page = (this.paginationInput.value && !isNaN(this.paginationInput.value)
                && (this.paginationInput.value > 0)) ? this.paginationInput.value : 1;
            var contentTypeSelected = this.contentTypeWrapper.querySelectorAll('.content-type-select-item.selected');

            if (contentTypeSelected && contentTypeSelected.length > 0 && !this.filterTag) {
                var contentTypeSelectedCount = contentTypeSelected.length;
                var filterArray = [];
                for (var i = 0; i < contentTypeSelectedCount; ++i) {
                    contentTypeText = contentTypeSelected[i].querySelector('.content-type-text').textContent;
                    contentTypeText = contentTypeText.split('(')[0];
                    contentTypeText = encodeURIComponent(contentTypeText.slice(0, -1));
                    filterArray.push(contentTypeText.split('(')[0]);
                }
                if (filterArray.length > 0 && !this.isInArray('All', filterArray)) {
                    filter = filterArray.join(',');
                } else {
                    filter = 'All';
                }
            } else if (this.filterTag) {
                filter = 'All';
            }

            var requestParams = {
                query: query,
                filter: filter,
                page: page
            };

            if (this.newsEventsFilter) {
                var viewQuarter = this.newsEventsFilter.querySelector('.view-by-quarter .dropdown-selected');
                var viewYear = this.newsEventsFilter.querySelector('.view-by-year .dropdown-selected');
                requestParams.year = viewYear.innerHTML.trim();
                requestParams.quarter = viewQuarter.innerHTML.trim();
            }

            return requestParams;
        };

        function setUrlHash() {
            this.pageReload = false;
            var queryObj = this.getRequestParams();
            var additonalFilter = "";

            if (queryObj.year && queryObj.quarter) {
                additonalFilter = '&year=' + queryObj.year + '&quarter=' + queryObj.quarter;
            }

            location.hash = '#type=search' +
                '&start=' + queryObj.page +
                '&filter=' + queryObj.filter +
                '&q=' + encodeURIComponent(queryObj.query) + additonalFilter;
            this.searchSuggestions.classList.add('hide');
        };


        function showSearchResults(updateContentTypes, filter) {
            this.searchResultsContainer.classList.remove('hide');
            this.searchSuggestions.classList.remove('active');

            if (window.utils.isMobile) {
                //this.listsIcon.classList.add('hide');
                //this.tilesIcon.classList.remove('hide');
            }

            if (updateContentTypes) {
                //this.getContentTypes(filter);
            }
            this.getSearchResults(filter);
        };

        function getContentTypes(filter) {
            var _this = this;
            var loaderDiv = document.querySelector('.progress');
            if (loaderDiv && loaderDiv.classList.contains('hide')) {
                loaderDiv.classList.remove('hide');
            }

            fetch('./js/service/search-content-type.json', {
                    method: 'GET',
                    credentials: 'include'
                })
                .then(
                function(response) {
                        if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                            loaderDiv.classList.add('hide');
                        }
                        if (response.status !== 200) {

                            return;
                        }

                        response.json().then(function(data) {
                            //_this.setContentTypes(data, filter);
                        });
                    }
                )
                .catch(function(err) {

                });
        };

        function setContentTypes(contentTypeArray, filter) {
            var _this = this;
            //var contentTypes = data.response.contentTypes;
            var contentTypes = contentTypeArray;
            this.contentTypeWrapper.innerHTML = '';

            for (var key in contentTypes) {
                var html = '<div class="content-type-select-item">';
                var filterArray = filter.split(',');
                if (key === 'All') {
                    if (_this.isInArray(key, filterArray)) {
                        html = '<div class="content-type-select-item selected show-all-result"><div class="search-radio-icon"><span class="icon-check icon-check_blue_sml_selected"><span class="path1"></span><span class="path2"></span></span></div>';
                    } else {
                        html = '<div class="content-type-select-item show-all-result"><div class="search-radio-icon"><span class="icon-check icon-check_blue_sml_default"><span class="path1"></span><span class="path2"></span></span></div>';
                    }

                } else if (_this.isInArray('All', filterArray)) {
                    html = '<div class="content-type-select-item selected"><div class="search-radio-icon"><span class="icon-check icon-check_blue_sml_selected"><span class="path1"></span><span class="path2"></span></span></div>';
                } else if (_this.isInArray(key, filterArray)) {
                    html = '<div class="content-type-select-item selected"><div class="search-radio-icon"><span class="icon-check icon-check_blue_sml_selected"><span class="path1"></span><span class="path2"></span></span></div>';
                } else {
                    html = '<div class="content-type-select-item"><div class="search-radio-icon"><span class="icon-check icon-check_blue_sml_default"><span class="path1"></span><span class="path2"></span></span></div>';
                }
                html += '<div class="content-type-text outline-none" tabindex="0">' + key + ' (' + contentTypes[key] + ')</div></div>';

                this.contentTypeWrapper.insertAdjacentHTML('beforeend', html);
            }

            if (this.contentTagSelected) {
                this.contentTagSelected.innerHTML = decodeURIComponent(filter);
            }

            this.contentTypeItems = this.contentTypeWrapper.querySelectorAll('.content-type-select-item');
            var contentTypeItemCount = this.contentTypeItems.length;
            var contentType;

            for (var i = 0; i < contentTypeItemCount; ++i) {
                contentType = this.contentTypeItems[i];
                contentType.index = i;

                var eventTrgiggerFunction = function(event) {
                    var target = event.target.parentElement;
                    var index = target.index;
                    if (event.target.classList.contains('icon-check')) {
                        index = event.target.parentElement.parentElement.index;
                    } else if (event.target.parentElement.classList.contains('icon-check')) {
                        index = event.target.parentElement.parentElement.parentElement.index;
                    }
		    /*------------------ For Analytics ---------------------------*/
                    	var searchFilter=_this.contentTypeItems[index].textContent.split('(')[0];
                    	//console.log(searchFilter);
                        if (typeof(_satellite) != 'undefined') {
                            _satellite.setVar('searchFilter', searchFilter);
                            //console.log('searchFilterSelected');
                            _satellite.track('searchFilterSelected');
                        }
                    /*------------------ For Analytics ---------------------------*/

                    if (index >= 0) {
                        if (_this.contentTypeItems[index].classList.contains('selected')) {
                            _this.contentTypeItems[index].classList.remove('selected');
                            _this.contentTypeItems[index].querySelector('.icon-check').classList.remove('icon-check_blue_sml_selected');
                            _this.contentTypeItems[index].querySelector('.icon-check').classList.add('icon-check_blue_sml_default');
                        } else {
                            _this.contentTypeItems[index].classList.add('selected');
                            _this.contentTypeItems[index].querySelector('.icon-check').classList.add('icon-check_blue_sml_selected');
                            _this.contentTypeItems[index].querySelector('.icon-check').classList.remove('icon-check_blue_sml_default');
                        }

                        var contentTypeSelected = _this.contentTypeWrapper.querySelectorAll('.content-type-select-item.selected');
                        if (_this.contentTypeItems[index].classList.contains('selected') &&
                            _this.contentTypeItems[index].classList.contains('show-all-result')) {
                            for (var j = 0; j < contentTypeItemCount; ++j) {
                                _this.contentTypeItems[j].classList.add('selected');
                                _this.contentTypeItems[j].querySelector('.icon-check').classList.add('icon-check_blue_sml_selected');
                                _this.contentTypeItems[j].querySelector('.icon-check').classList.remove('icon-check_blue_sml_default');
                            }
                        } else if (_this.contentTypeItems[index].classList.contains('show-all-result')) {
                            for (var j = 0; j < contentTypeItemCount; ++j) {
                                _this.contentTypeItems[j].classList.remove('selected');
                                _this.contentTypeItems[j].querySelector('.icon-check').classList.add('icon-check_blue_sml_default');
                                _this.contentTypeItems[j].querySelector('.icon-check').classList.remove('icon-check_blue_sml_selected');
                            }

                        } else if (_this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result').classList.contains('selected') &&
                            contentTypeSelected.length > 0) {
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result').classList.remove('selected');
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result .icon-check_blue_sml_selected').classList.add('icon-check_blue_sml_default');
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result .icon-check_blue_sml_selected').classList.remove('icon-check_blue_sml_selected');
                        } else if (!_this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result').classList.contains('selected') &&
                            contentTypeItemCount === contentTypeSelected.length + 1) {
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result').classList.add('selected');
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result .icon-check_blue_sml_default').classList.add('icon-check_blue_sml_selected');
                            _this.contentTypeWrapper.querySelector('.content-type-select-item.show-all-result .icon-check_blue_sml_default').classList.remove('icon-check_blue_sml_default');
                        }
                        _this.updateContentTypes = false;

                        if (window.utils.isMobile) {
                            //_this.contentTypeWrapper.parentElement.classList.toggle('active');
                            //_this.contentTypeWrapper.classList.toggle('show');
                            //_this.contentTypeWrapper.parentElement.querySelector('.content-type-drop-down.up').classList.remove('up');
                        }
                        _this.paginationInput.value = 1;
                        _this.setUrlHash();
                    }
                };

                contentType.querySelector('.content-type-text').addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13) {
                        eventTrgiggerFunction(event);
                    }
                }, false);

                contentType.addEventListener('click', function(event) {
                    eventTrgiggerFunction(event);
                }, false);
            }

        };

        function getSearchResults(filter) {
            var _this = this;
            var q = this.getRequestParams();
            var rows = document.getElementById("pagination").value;
            var page = q.page;
            var start = (page - 1) * rows;
            var template = false;
            this.progressBar.classList.remove('hide');
            this.searchNoResults.classList.add('hide');
            this.searchResultsContainer.classList.add('hide');
            //var endpoint = "./js/service/search-results.json?";
            var endpoint = "/services/tcs/solrResultServlet?searchType=/select&searchTerm="
            endpoint += encodeURIComponent(q.query);
            endpoint += "&start=" + start + "&rows=" + rows + "&template=[" + filter + "]";

            if (q.quarter && q.year) {
                endpoint += "&year=" + q.year + "&quarter=" + q.quarter;
            }
            fetch(endpoint, {
                    method: 'GET',
                    credentials: 'include'
                })
                .then(function(response) {
                    _this.progressBar.classList.add('hide');
                    if (response.status !== 200) {
                    	_this.searchNoResults.classList.remove('hide');
                        _this.searchResultsContainer.classList.add('hide');
                        return;
                    }
                    response.json().then(function(data) {
                    /*------------------ For Analytics ---------------------------*/
                        if(search==false){
                         //console.log(q.query);
                            if (typeof(_satellite) != 'undefined') {
                                _satellite.setVar('searchTerm', q.query);
                                //console.log("Search Done");
                                _satellite.setVar('searchResultCount', data.response.numFound);
                                _satellite.track('searchDone');
                            }
						//console.log(data.response.numFound);

                         search=true;
                        }
                    /*----------------- For Analytics ---------------------------*/
                        if (data && data.response && data.response.numFound > 0) {
                            _this.searchNoResults.classList.add('hide');
                            _this.searchResultsContainer.classList.remove('hide');
                            _this.setSearchResults(data, filter, rows);
                        } else {
                            _this.searchNoResults.classList.remove('hide');
                            _this.searchResultsContainer.classList.add('hide');
                        }

                        searchResultDataClickEvent(document.getElementById("search-resultData"));	// For Analytics

                    });
                })
                .catch(function(error) {
                    _this.progressBar.classList.add('hide');
                });
        };

        function setSearchResults(data, filter, rows) {

            var facetTemplateArray = data.facet_counts.facet_fields.template;
            var searchResults = data.response.docs;
            var searchResultCount = data.response.numFound
            var q = this.getRequestParams();
            if (q.filter === 'All' || this.pageReload) {
            	var templateArray = this.getContentTypeArray(facetTemplateArray, searchResultCount);
                this.setContentTypes(templateArray, filter);
                this.filterTag = null;
            }
            //var tagArray = this.getContentTypeArray(facetTagArray, searchResultCount);
            //this.setContentTypes(tagArray, filter);
            this.tileWrapperRow.innerHTML = '';
            this.listWrapper.innerHTML = '';

            var totalPages = 1;
            if (searchResultCount > rows) {
                totalPages = Math.ceil(searchResultCount / rows);
            }
            if (q.page > totalPages) {
                this.paginationInput.value = 1;
            }
            this.totalSearchPages.innerHTML = totalPages;
            var mediaTypes = ["video", "pdf", "doc", "image", "other"];

            for (var i = 0; i < searchResults.length; ++i) {

                var locationElements = utils.getSanitizedText(window.location.pathname).split('/');
                var displayURL=utils.getSanitizedText(searchResults[i].url[0]);
               if(searchResults[i].contentType[0].toLowerCase() !='page')
                	displayURL=utils.getSanitizedURL(window.location.origin+searchResults[i].url[0]);

            /*  locationElements.splice(locationElements.length - 1, 1);
                if (locationElements.length > 0) {
                    displayURL = utils.getSanitizedWebURL(window.location.origin + locationElements.join('/') + '/' + searchResults[i].url[0]);
                } else {
                    displayURL = window.location.origin + '/' + searchResults[i].url[0];
                } */
                var type = searchResults[i].contentType[0].toLowerCase();
                if (!this.isInArray(type, mediaTypes)) {
                    type = "other";
                }

                var listHtml =
                    '<div class="list-container">' +
                    '<div class="media-type">' +
                    '<span class="' + utils.getSanitizedText(type) + '"></span>' +
                    '</div>' +
                    '<div class="content">';
                if (window.innerWidth <= 992) {
                    listHtml += '<h3 class="title"><span class="icon"></span>' +
                        '<a class="link"  target="_blank" rel="noopener noreferrer" href="' + utils.getSanitizedText(searchResults[i].url) + '">' + utils.getSanitizedText(searchResults[i].title) + '</a></h3>';
                } else {
                	listHtml += '<h3 class="title"><span class="icon"></span>' + utils.getSanitizedText(searchResults[i].title) + '</h3>';
                }
                if (searchResults[i].description)
                	listHtml += '<p class="description">' + utils.getSanitizedText(searchResults[i].description) + '</p>';

                listHtml += '<a class="link" target="_blank" rel="noopener noreferrer" href="' + utils.getSanitizedText(searchResults[i].url) + '">' + displayURL + '</a>' +
                    '</div>' +
                    '</div>';
                this.listWrapper.insertAdjacentHTML('beforeend', listHtml);
            }
        };

        function toggleContentTypeDropDown(element) {
        	 if (window.utils.isMobile || window.utils.isTablet) {
                this.contentTypeDropDown.classList.toggle('up');
                this.contentTypeSelect.classList.toggle('show');
                this.contentTypeContainer.classList.toggle('active');
            }
        };

        function toggleMegaMenu(event, element) {
            var hashObject = obj.router.getURLHash();
            if (hashObject.type !== 'search') {
                this.hideSearchForm();
            }
			var _this = this;
            this.megaMenu.classList.toggle('open');
			if (this.megaMenu.classList.contains('open')) {
                var timeout = setTimeout(function() {
                    element.classList.add('clicked');
					document.body.style.overflow = 'hidden';
                    _this.showOverlay();

                }, (50));
            } else {
                element.classList.remove('clicked');
                document.body.style.overflow = 'visible';
                this.closeOverlay();
                this.closeSubmenu();

            }
            this.hamIconContainer.classList.toggle('clicked');
            if (this.contactButton) {
                this.contactButton.classList.toggle('hide');
            }

            /*if (element.classList.contains('clicked')) {
                document.body.style.overflow = 'hidden';
                this.showOverlay();
            } else {
                document.body.style.overflow = 'visible';
                this.closeOverlay();
                this.closeSubmenu();

            }*/
        };

        function showOverlay() {
            this.scrollTop = window.utils.getScrollY();
            if (this.overlay) {
                this.overlay.classList.add('show');
            }
            window.addEventListener('scroll', this.onBodyScroll, false);
            if (this.pageOverlay) {
                this.pageOverlay.classList.add('header-overlay');
            }
            if (window.utils.isMobile || window.utils.isTablet) {
                if (this.brandOverlay && window.innerWidth < 1024) {
                    this.brandOverlay.classList.add('show');
                }
            };
        };

        function closeOverlay() {
            if (this.isThirdParty === 0) {
                if (this.overlay) {
                    this.overlay.classList.remove('show');
                }
                if (this.pageOverlay) {
                    this.pageOverlay.classList.remove('header-overlay');
                }
                var hashObject = obj.router.getURLHash();
                if (hashObject.type !== 'search') {
                    document.body.style.overflow = '';
                }
                window.removeEventListener('scroll', onBodyScroll, false);
                if (window.utils.isMobile || window.utils.isTablet) {
                    if (this.brandOverlay) {
                        this.brandOverlay.classList.remove('show');
                    }
                }
            }
        };

        function closeSubmenu(e) {
            if (document.querySelector('.menu-item.drilld-down')) {
                document.querySelector('.menu-item.drilld-down').classList.remove('drilld-down');
            }
        };

        function onBodyScroll(e) {
            // document.body.style.overflow = 'hidden';
            //window.scrollTo(0, this.scrollTop);
            e.preventDefault();
        };

        function showSubmenu(event, element) {
            //if (element.querySelector('a').innerHTML == 'Talent') {
            //    this.hideMenu(event, this);
            //    return;
            //}
            var parEl = element.parentElement;
            //  this.hideSearchForm();
            if (window.innerWidth >= 1024) {
                var selectedItems = document.querySelectorAll('.menu-item .selected-item');
                for (var i = 0; i < selectedItems.length; i++) {
					selectedItems[i].querySelector('a').setAttribute('aria-expanded', 'false');
                    selectedItems[i].classList.remove('selected-item');
                }
                var subMenus = document.querySelectorAll('.menu-item .menu-item-content.main-menu-items');
                if (subMenus) {
                    for (var j = 0; j < subMenus.length; j++) {
                        subMenus[j].classList.remove('dissolve-menu');
                    }
                }
            }
            /* if (parEl.classList.contains('drilld-down')) {
                 parEl.classList.remove('drilld-down');
                 if (!window.utils.isMobile && !window.utils.isTablet) {
                     element.classList.remove('selected-item');
                     this.closeOverlay();
                 }
             } else {*/
            if (document.querySelector('.menu-item.drilld-down')) {
                document.querySelector('.menu-item.drilld-down').classList.remove('drilld-down');
            }
            parEl.classList.add('drilld-down');

            document.documentElement.onmousewheel=function(e){e.preventDefault();}
            if (!window.utils.isMobile && !window.utils.isTablet) {
                element.classList.add('selected-item');
				element.querySelector('a').setAttribute('aria-expanded', 'true');
            }
            this.showOverlay();
            // }
            if (window.innerWidth >= 1024) {
                var curSubMenu = document.querySelector('.menu-item.drilld-down .menu-item-content.main-menu-items');
                if (curSubMenu) {
                    curSubMenu.classList.add('dissolve-menu');
                    if (utils.isIE == true)
                    {
                    document.querySelector('input').blur();
                    }

                }
            }
            if (parEl.classList.contains('drilld-down')) {
				//when zoomed to 150% or more
                 if (window.innerWidth < 1024) {
                    if (element.parentElement.querySelector('ul')) {
                      //  this.hamIconContainer.style.display = "none";
                    }
                    //var liFirstElm = parEl.querySelector('.menu-sub-item .menu-item-contents:first-child');
                    var leftArrow = parEl.querySelector('ul.menu-item-content li span.menu-item-left-arrow');

              setTimeout(() => {
                        if (leftArrow) {
                            // show outline on span if going through keyboard
                            if (event.which == 32 || event.which == 13) {
                                leftArrow.focus();
                                leftArrow.style.outline = "none";

                            }
                            else {
                                leftArrow.focus();
                               // leftArrow.blur();

                              }
                        }
                     }, 200);
                }

                if (this.contactButton) {
                    this.contactButton.classList.add('hide');
                }
            } else {
                if (this.contactButton) {
                    this.contactButton.classList.remove('hide');
                }
            }
        };

        function hideMenu(event, element) {
            // if (element.classList.contains('header-overlay')) {
            if (window.innerWidth >= 1024) {
                if (this.elm.querySelector('.menu-item .selected-item')) {
					this.elm.querySelector('.menu-item .selected-item').querySelector('a').setAttribute('aria-expanded', 'false');
                    this.elm.querySelector('.menu-item .selected-item').classList.remove('selected-item');
                }
                this.closeSubmenu();
                this.closeOverlay();
            } else {
                if (this.megaMenu.classList.contains('open')) {
                    this.toggleMegaMenu(event, this.hamIcon);
                }
            }
            document.documentElement.onmousewheel = function(e) { return true; }
            if (this.contactButton) {
                this.contactButton.classList.remove('hide');
            }
            // }
        };

        function showSearchForm() {
            if (this.searchIconContainer.classList.contains('opened')) {
                return;
            }

            this.closeSubmenu();
            this.closeOverlay();
            this.searchIconContainer.classList.add('opened');
			this.searchIconContainer.querySelector('a').setAttribute('aria-expanded', 'true');
            this.searchContainer.classList.add('show');
            this.searchIcon.classList.remove('icon-ic_search_wht_lg_default');
            this.searchIcon.classList.add('icon-ic_close_searchbar');
            this.searchNoResults.classList.add('hide');
            this.body.style.overflow = 'hidden';
            this.navLocal.style.opacity = 1.0;
            this.searchInput.focus();
        };

        function hideSearchForm() {
            if(this.searchIconContainer){
            	this.searchIconContainer.classList.remove('opened');
				this.searchIconContainer.querySelector('a').setAttribute('aria-expanded', 'false');
            }
            if(this.searchContainer){
            	this.searchContainer.classList.remove('show');
            }
            if(this.searchIcon){
                this.searchIcon.classList.remove('icon-ic_close_searchbar');
                this.searchIcon.classList.add('icon-ic_search_wht_lg_default');
            }
            this.body.style.overflow = '';
            this.navLocal.style.opacity = 0.98;
			if(this.searchIcon){
            	this.searchIcon.href = utils.getSanitizedText(this.searchIcon.dataset.href);
			}
        };

        //Service call for ato suggestion
        function onChangeSearchInput(event, element) {
            var _this = this;
            var inputValue = utils.getSanitizedText(element.value).trim();
            if (inputValue === undefined || inputValue === '') {
                this.searchSuggestions.classList.remove('active');
            } else {
                this.searchSuggestions.classList.add('active');
                this.progressBar.classList.remove('hide');

                var endpoint = '/services/tcs/solrResultServlet?searchType=/suggest&searchTerm=' + inputValue;
                //var endpoint = './js/service/search-suggestions.json?suggest=' + inputValue;
                fetch(endpoint, {
                        method: 'GET',
                        credentials: 'include'
                    })
                    .then(
                        function(response) {
                            if (response.status !== 200) {
                                _this.progressBar.classList.add('hide');
                                this.searchSuggestions.classList.remove('active');
                                return;
                            }
                            response.json().then(function(data) {
                                _this.setSuggestions(data, inputValue);
                                _this.progressBar.classList.add('hide');
                            });
                        }
                    )
                    .catch(function(err) {
                        //_this.progressBar.classList.add('hide');
                    });

            }
            this.searchResultsContainer.classList.add('hide');
            this.searchNoResults.classList.add('hide');
        };

        //set auto suggestions
        function setSuggestions(data, inputValue) {

            var suggestedText = [];
            var jsonResult = data.suggest.mySuggester;
            var input = inputValue.toLowerCase();
            if(jsonResult.hasOwnProperty(input)){
                if(jsonResult[input].numFound > 0) {
                    this.searchSuggestions.classList.remove('hide');
                    this.searchNoResults.classList.add('hide');
                }
                else
                    return;
            }

            this.searchSuggestions.innerHTML = '';
            for (var key in jsonResult) {
                suggestedText = jsonResult[key].suggestions;
                for (var i = 0; i < suggestedText.length; i++) {
                    var suggestedItems = '<div class="search-suggest-item">' + suggestedText[i].term + '</div>';
                    this.searchSuggestions.insertAdjacentHTML('beforeend', suggestedItems);
                }
            }
        };

        function onHashChange() {
            var hashObject = obj.router.getURLHash();
            if (hashObject.type === 'search') {
                this.searchInput.value = (hashObject.q && hashObject.q !== 'undefined') ? decodeURIComponent(hashObject.q) : '';
                this.paginationInput.value = (hashObject.start && !isNaN(hashObject.start)
                    && (hashObject.start > 0)) ? hashObject.start : 1;
                var filter = (hashObject.filter && hashObject.filter !== 'undefined') ? hashObject.filter : '';
                if (this.filterTag) {
                    filter = 'All';
                }
                this.showSearchForm();
                if (this.searchInput.value) {
                    this.progressBar.classList.remove('hide');
                    this.showSearchResults(this.updateContentTypes, filter);
                }else {
                    if (hashObject.q !== undefined && hashObject.q.length == 0) {
                        this.searchNoResults.classList.remove('hide');
                        this.searchResultsContainer.classList.add('hide');
                    }
                }
                if (this.contentTagSelected) {
                    this.contentTagSelected.innerHTML = decodeURIComponent(filter);
                }
                this.updateContentTypes = true;
                document.body.style.overflow = 'hidden';
            } else {
                this.hideSearchForm();
                if(this.searchResultsContainer){
                	this.searchResultsContainer.classList.add('hide');
                }
                document.body.style.overflow = '';
            }
        };

        function onSubmitSearchForm(event) {
            event.preventDefault();
            this.setUrlHash();
        };

        function loadNextPageResults() {
            var pageNum = parseInt(this.paginationInput.value);
            var totalPages = parseInt(this.totalSearchPages.innerHTML);
            pageNum = (isNaN(pageNum) || pageNum < 0) ? 0 : pageNum;
            if (pageNum >= totalPages) {
                pageNum = totalPages - 1;
            }
            this.paginationInput.value = ++pageNum;
            this.setUrlHash();
        };

        function loadPrevPageResults() {
            var pageNum = parseInt(this.paginationInput.value);
            var totalPages = parseInt(this.totalSearchPages.innerHTML);
            pageNum = (isNaN(pageNum) || pageNum < 2) ? 2 : pageNum;
            if (pageNum > totalPages) {
                pageNum = totalPages + 1;
            }
            this.paginationInput.value = --pageNum;
            this.setUrlHash();
        };

        function isInArray(value, array) {
            return array.indexOf(encodeURIComponent(value)) > -1;
        };

        function setSearchHref() {
            var hashObject = obj.router.getURLHash();
            if(this.searchIcon){
                if (hashObject.type === 'search') {
                    this.searchIcon.href = '#0';
                } else {
                    this.searchIcon.href = utils.getSanitizedText(this.searchIcon.dataset.href);
                }
            }
        };

        function getContentTypeArray(facetTemplateArray, searchResultCount) {
            var templateArray = {};
            templateArray['All'] = searchResultCount;
            if (facetTemplateArray.length >= 2) {
                for (var i = 0; i < facetTemplateArray.length; i = i + 2) {
                    if (facetTemplateArray[i + 1] > 0) {
                        templateArray[facetTemplateArray[i]] = facetTemplateArray[i + 1];
                    }
                }
            }
            return templateArray;

        }

        /* for third part links */
        function showPromptSection(event,externalUrl, isHeaderMenuItem) {
            this.externalOkLink.href = externalUrl;
            // this.overlayWrapper.innerHTML = this.promptSection.innerHTML;
            if (window.utils.isMobile && isHeaderMenuItem) {
                this.toggleMegaMenu(event, this.hamIcon);
            } else {
                this.hideMenu(event, this);
            }
            this.promptSection.style.display = 'block';
            this.showOverlay();
        };

        /* for third part links */
        function hidePromptSection() {
            //this.overlayWrapper.innerHTML = "";
            this.isThirdParty = 0;
            this.promptSection.style.display = 'none';
            document.body.style.overflow = '';
            this.closeOverlay();
        };

        function navigateSearchPredictions(keyCode, element) {
            var currentItem;
            if (this.searchSuggestions) {
                currentItem = this.searchSuggestions.querySelector('.selected');
                if (currentItem && keyCode === 38) {
                    if (currentItem.previousSibling) {
                        currentItem.previousSibling.classList.add('selected');
                        currentItem.classList.remove('selected');
                    }
                } else if (currentItem && keyCode === 40) {
                    if (currentItem.nextSibling) {
                        currentItem.nextSibling.classList.add('selected');
                        currentItem.classList.remove('selected');
                    }
                } else {
                    if (this.searchSuggestions.querySelectorAll('.search-suggest-item') &&
                        this.searchSuggestions.querySelectorAll('.search-suggest-item').length > 0) {
                        this.searchSuggestions.querySelectorAll('.search-suggest-item')[0].classList.add('selected');
                    }
                }
            }
            currentItem = this.searchSuggestions.querySelector('.selected');
            if (currentItem) {
                this.searchInput.value = decodeURIComponent(currentItem.innerText);
            }
        };

        function showSearchResultsByPageNum() {
            var totalPages = parseInt(this.totalSearchPages.innerText);
            var pageRequested = this.paginationInput.value;
            if (isNaN(pageRequested) || pageRequested > totalPages || pageRequested <= 0) {
                var queryObj = obj.router.getURLHash();
                this.paginationInput.value = queryObj.start;
            } else {
                this.setUrlHash();
            }
        };

	/*-------------------For Analytics--------------------*/
          function searchResultDataClickEvent(resultSection){
			var results= resultSection.getElementsByTagName("a");
	    		for(var i=0; i<results.length;i++){
					results[i].addEventListener("click", function(){
					var text=this.parentElement.getElementsByClassName("title")[0].innerHTML;
                    var title = text.split("</span>").pop();
                    if (typeof(_satellite) != 'undefined') {
                        _satellite.setVar('searchResultTitle', title);
                        _satellite.track('searchResultClick');
                    }
				});
    		}
    	};
        /*-------------------For Analytics--------------------*/
    };
    function debounce(func, wait, immediate) {
    	  var timeout;
    	  return function() {
    	    var context = this,
    	      args = arguments;
    	    var callNow = immediate && !timeout;
    	    clearTimeout(timeout);
    	    timeout = setTimeout(function() {
    	      timeout = null;
    	      if (!immediate) {
    	        func.apply(context, args);
    	      }
    	    }, wait);
    	    if (callNow) func.apply(context, args);
    	  }
    	}

    var isMegaMenu = document.querySelector('header .mega-menu');
    if (isMegaMenu) {

    window.def.Header = Header;
    obj.header = new def.Header();
    }
})();

(function () {
    def.IRSearchResults = function () {
        this.name = 'IRSearchResults';
        this.searchIcon = document.getElementById('search-icon-container');
        this.newsEventsFilter = document.querySelector('.news-events-filter');
        this.searchFilter = document.querySelector('.search-filter-wrapper');
        this.filterTrigger = document.querySelector('.filter-trigger');
        this.init();
    };
    var p = def.IRSearchResults.prototype;
    def.IRSearchResults.prototype.constructor = def.IRSearchResults;

    p.init = function () {
        if (this.searchIcon) {
            this.searchIcon.classList.add('dropdown-filters');
        }

        this.addEvents();
    };

    p.addEvents = function (event) {
        var _this = this;
        //Search results filter trigger for mobile view
        if (window.innerWidth <= 992) {

            this.filterTrigger && this.filterTrigger.addEventListener('click', this.searchFilterOpen.bind(_this), false);

            if (this.searchFilter && this.newsEventsFilter) {
                this.searchFilter.classList.add('hide');
            }
        }
    };

    p.searchFilterOpen = function () {

        if (this.searchFilter && this.searchFilter.classList.contains('show')) {
            this.searchFilter.classList.remove('show');
            this.searchFilter.classList.add('hide');
            if (this.filterTrigger) {
                this.filterTrigger.querySelector('span').classList.add('icon-ic_expand');
                this.filterTrigger.querySelector('span').classList.remove('icon-ic_collapse');
            }

        } else {
            if (this.searchFilter) {
                this.searchFilter.classList.remove('hide');
                this.searchFilter.classList.add('show');
            }

            if (this.filterTrigger) {
                this.filterTrigger.querySelector('span').classList.remove('icon-ic_expand');
                this.filterTrigger.querySelector('span').classList.add('icon-ic_collapse');
            }

        }
    };

    obj.IRSearchResults = new def.IRSearchResults();

})();
(function() {
    'use strict';
    var MultiSelectDropDown = function(element) {
        if (!element) return;

        var _this = this;
        this.init = init;
        this.addEvents = addEvents;
        this.openDD = openDD;
        this.closeDD = closeDD;
        this.onClickBody = onClickBody;
        this.onClickItem = onClickItem;
        this.getSelectedItems = getSelectedItems;
        this.getSelectedItemsAttr = getSelectedItemsAttr;
        this.addEventsToDDItems = addEventsToDDItems;
        this.createListItems = createListItems;
        this.setSelectedItems = setSelectedItems;
        this.subscribe = subscribe;
        this.dispatch = dispatch;

        this.init(element);

        function init(element) {
            this.name = 'MultiSelectDropDown';
            this.elm = element;
            this.listeners = [];
            this.initialSelctedItem = '';
            this.pageBody = document.querySelector('body');
            this.pageOverlay = document.querySelector('.page-overlay');
            this.header = this.elm.querySelector('.multiselect-dropdown-header');
            this.goButton =  this.elm.querySelector('.go-arrow');
            if (this.header) {
                this.headerLabelSelected = this.header.querySelector('.multiselect-dropdown-selected');
            }
            this.contents = this.elm.querySelector('.multiselect-dropdown-content');
            this.items = this.contents.querySelectorAll('.multiselect-dropdown-item');
            this.itemAll;
            this.addEvents();
            this.addEventsToDDItems();
        };

        function createListItems(items) {
            var itemsCount = items.length;
            if (itemsCount == 0) {
                this.headerLabelSelected.textContent = 'No Content';
                return;
            }
            var headerText = '';
            this.headerLabelSelected.textContent = '';
            this.contents.innerHTML = '';
            this.items = [];

            var newItem = '<li class="multiselect-dropdown-item  outline-none" data-item="All" tabindex="0">' +
                '<label class="select-indicator fl"></label>' +
                '<span class="item-text fl outline-none" tabindex="0">All</span>' +
                '</li> ';
            for (var i = 0; i < itemsCount; ++i) {
            	newItem += '<li class="multiselect-dropdown-item  outline-none" data-item="' + items[i].tagId + '" tabindex="0">' +
                    '<label class="select-indicator fl"></label>' +
                    '<span class="item-text fl outline-none" tabindex="0">' + items[i].title + '</span>' +
                    '</li> ';
                if (i !== (items.length - 1)) {
                    headerText += items[i].title + ', ';
                } else {
                    headerText += items[i].title;
                }
            }

            this.contents.innerHTML = newItem;
            this.items = this.contents.querySelectorAll('.multiselect-dropdown-item');
            this.headerLabelSelected.textContent = headerText;
            this.initialSelctedItem = headerText;

            this.addEventsToDDItems();
        }

        function addEvents() {
            if (this.header) {
                this.header.addEventListener('click', function(event) {
                    if (_this.elm.classList.contains('open')) {} else {
                        _this.openDD(event);
                    }
                }, false);

                this.header.addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13)
                        if (_this.elm.classList.contains('open')) {} else {
                            this.click();
                        }
                }, false);
            }
            if(this.goButton){
            this.goButton.addEventListener('click', function(event) {
                _this.closeDD();
            }, false);
            if (this.pageBody) {
                this.pageBody.addEventListener('keyup', function(event) {
                    var code = event.keyCode ? event.keyCode : event.which;
                    if (code === 27) {
                        _this.closeDD(event);
                    }
                }, false);
            }

            }

        };

        function addEventsToDDItems() {
            // For DD Items
            var itemCount = this.items.length;
            var item;
            for (var i = 0; i < itemCount; ++i) {
                item = this.items[i];
                item.index = i;
                if (item.getAttribute('data-item') === 'All') {
                    this.itemAll = item;
                }
                item.addEventListener('click', function(event) {
                    _this.onClickItem(event, this);
                }, false);
            }            
        }

        function openDD(event) {
            this.elm.classList.add('open');
            this.elm.classList.add('bs-depth-3');
            if (this.pageOverlay) {
                this.pageOverlay.classList.add('dropdown-overlay');
                this.pageOverlay.classList.add('dd-open');
                this.pageOverlay.style.visibility = 'visible';
                this.elm.parentNode.style.zIndex = 101;
            }
            if (this.pageBody) {
                this.pageBody.addEventListener('click', _this.onClickBody, false);
                obj.closeDDHandler = _this.onClickBody;
            }

            event.stopPropagation();
        };

        function closeDD(event) {
            var itemCount = this.items.length;
            var item;
            var selectedItemCount = 0;
            for (var i = 0; i < itemCount; ++i) {
                item = this.items[i];
                if (item.getAttribute('data-item') === 'All') {
                    continue;
                }
                if (item.classList.contains('selected')) {
                    selectedItemCount++;
                }
            }
            

            this.elm.classList.remove('open');
            this.elm.classList.remove('bs-depth-3');
            if (this.pageOverlay) {
                this.pageOverlay.classList.remove('dropdown-overlay');
                this.pageOverlay.classList.remove('dd-open');
                this.pageOverlay.style.visibility = 'hidden';
                this.elm.parentNode.style.zIndex = 0;
            }

            if (this.pageBody) {
                this.pageBody.removeEventListener('click', _this.onClickBody, false);
            }

            this.getSelectedItems();
            this.dispatch('onDDClose');
        };

        function onClickBody(event) {
        	if (!event) {
                _this.closeDD();
                return;
            }
            var targetClassList = event.target.parentNode.classList;
            var isDDItem = targetClassList.contains('multiselect-dropdown-content') ||
                targetClassList.contains('multiselect-dropdown-item');
            if (isDDItem) {
                return;
            } else {
                _this.closeDD();
            }
        };

        function onClickItem(event, element) {
            var itemText = element.getAttribute('data-item');
            var itemCount = this.items.length;
            var item;
            var selectedItemCount = 0;

            if (itemText === 'All') {
                var allSelected = element.classList.contains('selected');
                for (var i = 0; i < itemCount; ++i) {
                    item = this.items[i];
                    if (allSelected) {
                        item.classList.remove('selected');
                    } else {
                        item.classList.add('selected');
                    }
                }
            } else {
                element.classList.toggle('selected');
                for (var i = 0; i < itemCount; ++i) {
                    item = this.items[i];
                    if (item.getAttribute('data-item') === 'All') {
                        continue;
                    }
                    if (item.classList.contains('selected')) {
                        selectedItemCount++;
                    }
                }

                if (selectedItemCount < (itemCount - 1)) {
                    this.itemAll.classList.remove('selected');
                } else {
                    this.itemAll.classList.add('selected');
                }
            }
        };

        function getSelectedItems() {
            var itemCount = this.items.length;
            var item;
            var itemText;
            var selectedItems = [];
            var unSelectedItems = [];
            var itemNames = [];
            var headerLabel="";
            for (var i = 0; i < itemCount; ++i) {
                item = this.items[i];
                itemText = item.getAttribute('data-item');
                if (item.classList.contains('selected')) {
                    
                    if (itemText === 'All' || itemText === 'all') continue;
                    itemNames.push(item.querySelector('.item-text').textContent);
                    selectedItems.push(item.getAttribute('data-item'));
                }
                else {
                    if (itemText === 'All' || itemText === 'all') continue;
                    unSelectedItems.push(item.getAttribute('data-item'));
                 }
                 if (itemText.toLowerCase() !== 'all')
                 {
                        if (i !== (itemCount - 1)) {
                             headerLabel += item.textContent + ', ';
                         } else {
                             headerLabel += item.textContent;
                         }
                 }

            }
            _this.setSelectedItems(itemNames);
            if (this.initialSelctedItem === '') this.initialSelctedItem = headerLabel;
            if (selectedItems.length === 0 && itemCount > 1 ) {
                this.headerLabelSelected.textContent = this.initialSelctedItem;

             }


             return selectedItems.length ? selectedItems : unSelectedItems;

        }

        function getSelectedItemsAttr() {
            var itemCount = this.items.length;
            var item;
            var itemText;
            var selectedItems = [];
            var unSelectedItems = [];
            for (var i = 0; i < itemCount; ++i) {
                item = this.items[i];
                itemText = item.getAttribute('data-item');
                if (itemText === 'All') continue;
                if (item.classList.contains('selected')) {
                    selectedItems.push(itemText);
                } else {
                    unSelectedItems.push(itemText);
                }
            }

            return selectedItems.length ? selectedItems : unSelectedItems;
        };


        function setSelectedItems(itemLabel) {
            var selectedItemsString = itemLabel.join(', ');
            if (this.headerLabelSelected) {
                this.headerLabelSelected.innerHTML = utils.getSanitizedText(selectedItemsString);
            }
        }

        function subscribe(event, callback) {
            this.listeners[event] = this.listeners[event] || [];
            this.listeners[event].push(callback);
        };

        function dispatch(event, index) {
            if (this.listeners && this.listeners[event]) {
                window.Array.prototype.forEach.call(this.listeners[event], function(callback) {
                    callback && callback.call(_this, index);
                });
            }
        };
    };
    def.multiSelectDropDown = MultiSelectDropDown;
})();

(function() {
    'use strict';

    var Overlay = function() {
        this.init = init;
        this.addEvents = addEvents;
        this.onHashChange = onHashChange;
        this.getOverlayPage = getOverlayPage;
        this.setOverlayPage = setOverlayPage;
        this.showOverlay = showOverlay;
		this.closeOverlay = closeOverlay;
        this.changeHref = changeHref;
        this.freezeMainContent = freezeMainContent;
        this.defreezeMainContent = defreezeMainContent;
        this.init();
	    this.timer = false;
		var mediaUrl="default";
        var mediaType = "";
        

        function init() {
            this.name = 'Overlay';
            this.body = document.querySelector('body');
            this.main = document.querySelector('main');
            this.loaderDiv = document.querySelector('.progress');
            this.url = window.location.href;

            this.pageOverlay = document.querySelector('.page-overlay');
            if (this.pageOverlay) {
                this.contentWrapper = this.pageOverlay.querySelector('.overlay-content-wrapper');
                this.close = this.pageOverlay.querySelector('.overlay-close');
            }
            this.year="";
            this.addEvents();
            this.onHashChange();
        };
        function changeHref() {
            try {
                if (document.querySelector('#contactus-banner')) {
                    document.querySelector('#contactus-banner').href = document.querySelector('#contactus-banner').getAttribute('data-href');
                }
                var overlayLabel = '', hashLabel;
                document.querySelectorAll('.require-overlay').forEach(function(item) {
                    overlayLabel = item.href.split('/')[item.href.split('/').length - 1].split('.')[0];
                    hashLabel = item.href.split('/')[item.href.split('/').length - 1].split('.')[1].split('#');
                    if (hashLabel.length > 1) {
                        item.href = "#type=overlay&page=" + utils.getSanitizedText(overlayLabel) + "-overlay&" + utils.getSanitizedText(hashLabel[1]);
                    } else {
                        item.href = "#type=overlay&page=" + utils.getSanitizedText(overlayLabel) + "-overlay";

                    }
                })
            } catch (e) {
              
            };


        }

          function addEvents() {
            var _this = this;
            if(this.close) {
                this.close.addEventListener('click', function() {
                    if (_this.loaderDiv) {
                        _this.loaderDiv.classList.add("hide");
                    }
                    _this.closeOverlay();
                    //  this.body.removeEventListener('keyup');
                }, false);
            }
            if (this.body) {
                this.body.addEventListener('keyup', function(event) {
                    var code = event.keyCode ? event.keyCode : event.which;
                    if (code === 27) {
                        _this.closeOverlay();
                    }
                }, false);
            }

        };

        function onHashChange() {
            var _this = this;
            var hashObject = obj.router.getURLHash();
            if (this.pageOverlay && this.pageOverlay.classList.contains('dropdown-overlay')) {
            	
                if (obj.closeDDHandler) {
                    obj.closeDDHandler();
                    obj.closeDDHandler = null;
                }
                else {
                    this.pageOverlay.classList.remove('dropdown-overlay');
                }

            }

            if (hashObject.type === 'overlay' || hashObject.type === 'subsidiary-overlay') {
                if(hashObject.mediaPath != undefined)
                    mediaUrl = hashObject.mediaPath;
                 if(hashObject.mediaType != undefined)
					mediaType = hashObject.mediaType;
				  if(hashObject.year != undefined)
					  this.year = hashObject.year;
                  if (_this.loaderDiv) {
                      this.loaderDiv.classList.remove("hide");
                  }
                  if (hashObject.theme === 'dark') {
                      this.pageOverlay.classList.add('dark-theme');
                  } else {
                      if (this.pageOverlay.classList.contains('dark-theme')) {
                          this.pageOverlay.classList.remove('dark-theme');
                      }
                  }
                this.getOverlayPage(hashObject.page, _this.setOverlayPage);
            }
		   
			else if (hashObject.type === undefined && hashObject.year === undefined) {
                this.closeOverlay();
            } else
                this.closeOverlay();

        };
        function getOverlayPage(pageName, successCallback) {
            var _this = this;
            var url =  "";
             var searchString = '.html';
             var position = pageName.length;
             position -= searchString.length;
             var lastIndex = pageName.lastIndexOf(searchString, position);

            var country = utils.getQueryStringFromUrl('country', this.url);
            var language = utils.getQueryStringFromUrl('lang', this.url);

             if (lastIndex >= 0 && lastIndex === position) {
            	 if (pageName.indexOf("/en/")==-1 && pageName.indexOf("/es-es/")==-1 && pageName.indexOf("/jp-ja/")==-1 && pageName.indexOf("/chinese/")==-1
                  		&& pageName.indexOf("/fr-fr/")==-1  && pageName.indexOf("/de-de/")==-1 && pageName.indexOf("/he/")==-1 && pageName.indexOf("/tcs-bancs/")==-1 && pageName.indexOf("/hobs/")==-1 ) {
                 	 url = "/content/tcs/en" + utils.getSanitizedText(pageName);
                  }else {
 					url = "/content/tcs" + utils.getSanitizedText(pageName);
                  }
            	  if (pageName.indexOf("/tcs-bancs/") !=-1){
                		url = "/content" +  utils.getSanitizedText(pageName) ;
              	 }
                } else {
                	if (pageName.indexOf("/en/")==-1 && pageName.indexOf("/es-es/")==-1 && pageName.indexOf("/jp-ja/")==-1 && pageName.indexOf("/chinese/")==-1
                     		&& pageName.indexOf("/fr-fr/")==-1  && pageName.indexOf("/de-de/")==-1 && pageName.indexOf("/he/")==-1 && pageName.indexOf("/tcs-bancs/")==-1 && pageName.indexOf("/hobs/")==-1  ) {
                    	 url = "/content/tcs/en" + utils.getSanitizedText(pageName) + '.html';
                     }else {
    					url = "/content/tcs" + utils.getSanitizedText(pageName) + '.html';
                     }
                	if (pageName.indexOf("/tcs-bancs/") !=-1){
                   		url = "/content" +  utils.getSanitizedText(pageName) + '.html';
                 	 }
             }

             if (country && language) {
                url = url + '?country=' + utils.getSanitizedText(country) + '&lang=' + utils.getSanitizedText(language);
              }


			sessionStorage.removeItem("isButtonEnabled");
            fetch(url, {
                    method: 'GET',
                    credentials: 'include'
                })
                .then(
                    function(response) {
                        _this.loaderDiv.classList.add("hide");
                        if (response.status !== 200 ||
                            response.headers.get('Content-Type').match('text/html') == null) {
                            return;
                        }

                        response.text().then(function(data) {

                            successCallback.call(_this, data);
                        });
                    }
                )
                .catch(function(err) {

                });
        };

        function setOverlayPage(data) {
            this.contentWrapper.innerHTML = data;

            
            var accordions = this.contentWrapper.querySelectorAll('.accordion');
            var accordionCount = accordions.length;
            var accordion;
			if (accordionCount) {
            for (var i = 0; i < accordionCount; ++i) {
                accordion = accordions[i];
                new def.Accordion(accordion, true);
            }}

             var pastEventList = this.contentWrapper.querySelector('.past-event-list');
             if (pastEventList && obj.eventList) {
                 obj.eventList.showPastEvents(pastEventList);

             }

            if(mediaType == 'audio') {
            	if(mediaUrl.startsWith("/content/dam/tcs")){
            		var audioElement = document.getElementsByClassName('audio-container')[0];
            		var audioTag = audioElement.querySelector(".audio-play");
            		audioTag.src = mediaUrl;
            	}
            }

            if(mediaType == 'video') {
            	if(mediaUrl.startsWith("/content/dam/tcs")){
            		var videoElement = this.contentWrapper.querySelector('.video-container');
              		var videoTag = videoElement.querySelector(".video-view");
              		videoTag.src = mediaUrl;
              		eventFunction(videoTag);    
            	}
            }

            
            var videoElement = this.contentWrapper.querySelector('.video-container');
            if (videoElement) {
                new def.Video(videoElement);
            }

           
            var audioElement = this.contentWrapper.querySelector('.audio-container');
            if (audioElement) {
                new def.Audio(audioElement);
            }

           
            var socialSignIn = this.contentWrapper.querySelector('.social-sign-in');
            if (socialSignIn) {
                new def.SocialSignInSection(socialSignIn);

            }

            var researchCareerOverlay = this.contentWrapper.querySelector('.careers-dev-overlay');
            if (researchCareerOverlay) {
            	new def.ResearchersSection(this.contentWrapper);
            }


            var contactUs = this.contentWrapper.querySelector(".contactus-content-wrapper");
            if (contactUs) {
                var hashObject = obj.router.getURLHash();
                if (hashObject.open) {
                    new def.ContactUsSection(contactUs, hashObject.open);
                } else {
                    new def.ContactUsSection(contactUs);
                }
            }

           var demoBooking = this.contentWrapper.querySelector(".book-a-demo-wrapper");
            if (demoBooking) {
                    new def.DemoBookingSection(demoBooking);
            }



            var irRequestKit = this.contentWrapper.querySelector(".ir-toolkitform-wrapper");
            if (irRequestKit) {
                var InvestorRelationsSection = new def.InvestorRelationsSection(false);
                InvestorRelationsSection.showIRToolKitFormOverlay();
            }

            var viewAllWrapper = this.contentWrapper.querySelector('.view-all-wrapper');
            if (viewAllWrapper) {
               window.obj.viewAll = new def.ViewAll();
            }

            var dropDownContainer = this.contentWrapper.querySelector('.financial-dropdown-container .dropdown');
            if(dropDownContainer) {
               new def.DropDown(dropDownContainer);
            }

            var pressReleasesViewByYearDDContainer = this.contentWrapper.querySelector('.press-releases-dropdown-container>.press-release-by-year .dropdown');;
            if(pressReleasesViewByYearDDContainer) {
            	 var PressReleasesYearObj = new def.DropDown(pressReleasesViewByYearDDContainer);
            	 PressReleasesYearObj.subscribe('onItemChange', function() {
                    obj.viewAll.getOverlayData(false, true);
                 });
            }
            var analystReportViewByYearDDContainer = this.contentWrapper.querySelector('.press-releases-dropdown-container>.dropdown');
			if(analystReportViewByYearDDContainer) {
            	 var AnalystYearObj = new def.DropDown(analystReportViewByYearDDContainer);
            	 AnalystYearObj.subscribe('onItemChange', function() {
                    obj.viewAll.getOverlayData(false, true);
                 });
            }
            var pressReleasesViewByMonthDDContainer = this.contentWrapper.querySelector('.press-releases-dropdown-container .press-release-by-month .dropdown');
            if(pressReleasesViewByMonthDDContainer) {
                var PressReleasesMonthObj = new def.DropDown(pressReleasesViewByMonthDDContainer);
                PressReleasesMonthObj.subscribe('onItemChange', function() {
                    obj.viewAll.getOverlayData(false, true);
                 });
            }

           
            var tcsWorldWide = this.contentWrapper.querySelector('.worldwide');
            if (tcsWorldWide) {
                new def.TCSWorldWide(tcsWorldWide);
            }

           
            var campusRequirementForm = this.contentWrapper.querySelector('.niche-form');
            if (campusRequirementForm) {
                new def.formClear(campusRequirementForm);
            }

            
            var ResearchersForm = this.contentWrapper.querySelector('.research-form');
            if (ResearchersForm) {
                new def.formClear(ResearchersForm);
            }

           
            var InternshipForm = this.contentWrapper.querySelector('.internship-form');
            if (InternshipForm) {
                new def.formClear(InternshipForm);
            }

            
            var cardWrapSideMenus = this.contentWrapper.querySelectorAll('.card-wrap-menu');
            if (cardWrapSideMenus.length > 0) {
                new def.OverlayCardWrapSideMenu(cardWrapSideMenus);
            }

			this.showOverlay();
        };

        function showOverlay() {
            if (this.pageOverlay) {
                this.sections = this.pageOverlay.querySelectorAll('.section');
                if (this.sections && this.sections.length > 0) {
                    var sectionsLength = this.sections.length;
                    for (var i = 0; i < sectionsLength; i++) {
                        this.sections[i].style.visibility = 'visible';
                    }
                }
                clearTimeout(this.timer);
                this.pageOverlay.style.visibility = 'visible';
                this.pageOverlay.classList.add('show');
                if (this.pageOverlay.classList.contains('hide') === true) {
                    this.pageOverlay.classList.remove('hide');
                }
            var contactUsForm = document.getElementById("contactusform");
            var start=false;
            if(contactUsForm != null){
            	var elements=contactUsForm.getElementsByClassName("contactus-textformfield");
                for(var i=0; i<elements.length; i++){
                    elements[i].addEventListener("focusout", function() {
                    if (start == false && this.value.trim() !== '') {
                        start=true;
                        
                        if (typeof(_satellite) != 'undefined') {
                        	_satellite.track('contactUsStart');
                        }
                        
                    }
                    }.bind(elements[i]), false);
                }
            	var radioelements=contactUsForm.getElementsByClassName("contactus-radiobtnformfield");
                for(var i=0; i<radioelements.length; i++){
                    radioelements[i].addEventListener("click", function() {
                        if(start == false){
            				start=true;
                            
            				if (typeof(_satellite) != 'undefined') {
                            	_satellite.track('contactUsStart');
                            }
                        }
                    }.bind(elements[i]), false);
                }
            }
            if(this.year!=""){
				populateSubsidiaryDataInOverlay(this.year);
            }}
			
			this.freezeMainContent();
        };
	
		function closeOverlay() {
            var _this = this;
            if (this.pageOverlay && !this.pageOverlay.classList.contains('show')) return;
            if(this.contentWrapper) {
            	this.contentWrapper.innerHTML = '';
            }
            if (this.pageOverlay) {
                this.pageOverlay.classList.remove('show');
                this.timer = setTimeout(function() {
                     _this.pageOverlay.style.visibility = 'hidden';
                }, 1001);

                if (this.pageOverlay.classList.contains('talent-tcs-worldwide') === true) {
                    this.pageOverlay.classList.add('hide');
                    if (this.pageOverlay.classList.contains('hide') === true) {
                        this.pageOverlay.classList.remove('talent-tcs-worldwide');
                    }
                }
            }

            var hashObject = obj.router.getURLHash();
            if (hashObject.type !== 'thankyou-contact-us-overlay')
                obj.router.clearURLHash();

            this.defreezeMainContent();
        };

			function freezeMainContent() {
             this.main.style.top = -(window.pageYOffset) + 'px';
            this.body.style.position = "fixed";
            this.body.style.width = '100%';
        };
        function defreezeMainContent() {
             this.body.style.position = '';
            this.body.style.top = '';
            var offset = -(parseFloat(this.main.style.top));
            if (!isNaN(offset)) {
                window.scrollTo(0, offset);
            }
            this.main.style.top = '';
        };

    };
    def.Overlay = Overlay;
    obj.overlay = new def.Overlay();
})();

(function () {
    "use strict";
    def.Survey = function() {
        this.name = 'Survey';
        this.init();
    }

    var p = def.Survey.prototype;
    def.Survey.prototype.constructor = def.Survey;

    p.init = function() {
        var _this = this;
        var surveySections = document.querySelectorAll('.survey');
        if (surveySections && surveySections.length > 0) {
            for (var i = 0; i < surveySections.length; i++) {
                _this.enableSurvey(surveySections[i]);
            }
        }
    };

    p.enableSurvey = function(surveySection) {
        var _this = this;

        if (surveySection) {
            var surveyStorageKey = this.getSurveyStorageKey(surveySection.getAttribute('data-survey'));
            if (this.isSurveyCompleted(surveyStorageKey)) {
                surveySection.classList.add('hide');
                var componentType = surveySection.getAttribute('data-component');
                if (componentType === "card-survey" && surveySection.nextElementSibling.classList.contains('hide')) {
                    surveySection.nextElementSibling.classList.remove('hide');
                }
            } else {
                surveySection.classList.remove('hide');
                this.setSurveyResponseLayoutHeight(surveySection);
                var choices = surveySection.querySelectorAll(".choices .choice");
                for (var i = 0; i < choices.length; i++) {
                	choices[i].addEventListener('click', function(event) {
                        _this.submitSurvey(surveySection, event);
                    });
                    choices[i].addEventListener('keydown', function(event) {
                        if (event.which == 13) {
                            _this.submitSurvey(surveySection, event);

                        }
                    });
                }
            }
        }
    };
    p.submitSurvey = function(surveySection, event) {
        var _this = this;
        surveySection.querySelector('.progress-wrapper').classList.remove('hide');
        var surveyName = event.target.getAttribute('data-survey');
        var selectedChoice = event.target.innerText;
        var isShowResults = surveySection.querySelector('.survey-content').getAttribute('data-survey-results');
        if (isShowResults === 'true') {
            _this.fetchSurveyResultsApi(surveyName, selectedChoice);
        } else {
            _this.showSurveyResponseMessage(surveyName);
        }
    };

    p.setSurveyResponseLayoutHeight = function(surveySection) {
        var responseLayout = surveySection.querySelector('.survey-response');
        if (responseLayout && surveySection.clientHeight) {
            responseLayout.style.height = surveySection.clientHeight + 'px';
        }
    };

    p.fetchSurveyResultsApi = function(surveyName, selectedChoice) {
        var _this = this;

        var surveySection = document.querySelector('.survey[data-survey="' + surveyName + '"]');
        var dateRange = "";
        if (surveySection.querySelector('input[name="dateRange"]') &&
            surveySection.querySelector('input[name="dateRange"]').value) {
            dateRange = surveySection.querySelector('input[name="dateRange"]').value;
        }

        var endpoint = "/services/tcs/fetchSurveyResponse?";
        endpoint += "dateRange=" + dateRange + "&surveyName=" + surveyName;

        if (surveySection.getAttribute('data-refetch') !== "false") {
            fetch(endpoint, {
                method: 'GET',
                credentials: 'include'
            }).then(function(response) {
                if (response.status !== 200) {
                    return;
                }
                response.json().then(function(data) {
                    if (data && data.response && data.statusCode === '401') {
                        _this.fetchSurveyResultsApi(surveyName, selectedChoice);
                        surveySection.setAttribute("data-refetch", "false");
                    } else if (data && data.statusCode === '402') {
                        _this.showSurveyResponseMessage(surveyName);
                    } else {
                        _this.surveyresponseHandler(surveyName, data.response, selectedChoice)
                    }
                });
            }).catch(function(error) {
                console.log(error);
                _this.showSurveyResponseMessage(surveyName);
            });
        } else {
            _this.showSurveyResponseMessage(surveyName);
        }
    };

    p.surveyresponseHandler = function(surveyName, response, selectedChoice) {
        var storageKey = this.getSurveyStorageKey(surveyName);
        this.setSurveyAsCompleted(storageKey);
        var surveySection = document.querySelector('.survey[data-survey="' + surveyName + '"]');
        if (surveySection.querySelector('.choices')) {
            surveySection.querySelector('.choices').classList.add('hide');
        }
        this.showSurveyResponseGraph(surveyName, response, selectedChoice);
    };

    p.showSurveyResponseMessage = function(surveyName) {
        var storageKey = this.getSurveyStorageKey(surveyName);
        this.setSurveyAsCompleted(storageKey);
        var surveySection = document.querySelector('.survey[data-survey="' + surveyName + '"]');
        if (surveySection.querySelector('.progress-wrapper')) {
            surveySection.querySelector('.progress-wrapper').classList.add('hide');
        }
        if (surveySection.querySelector('.survey-content').classList) {
            surveySection.querySelector('.survey-content').classList.add('hide');
        }
        if (surveySection.querySelector('.survey-response').classList.contains('hide')) {
            surveySection.querySelector('.survey-response').classList.remove('hide');
            if (document.querySelector('.survey-thankyou-popup')) {
                if (document.querySelector('.survey-thankyou-popup').classList.contains('model-open')) {
                    document.querySelector('.survey-thankyou-popup').querySelector('.survey-thankyou-msg').classList.add('hide');
                    document.querySelector('.survey-thankyou-popup').querySelector('.survey-thankyou-title').classList.add('hide');
                }
            }
        }
    };

    p.showSurveyResponseGraph = function(surveyName, response, selectedChoice) {
        var _this = this;

        var surveySection = document.querySelector('.survey[data-survey="' + surveyName + '"]');
        if (surveySection.querySelector('.survey-results')) {
            if (surveySection.querySelector('.survey-results').classList.contains('hide')) {
                surveySection.querySelector('.survey-results').classList.remove('hide');
            }
            if (surveySection.querySelector('.progress-wrapper')) {
                surveySection.querySelector('.progress-wrapper').classList.add('hide');
            }
            var choices = document.querySelectorAll('.choice-section[data-survey="' + surveyName + '"]');
            for (var i = 0; i < choices.length; i++) {
                var choice = choices[i].querySelector('.choice-value').innerText;
                _this.showSurveyResult(choices[i], response[choice], selectedChoice);
            }
        } else {
            _this.showSurveyResponseMessage(surveyName);
        }
    };

    p.showSurveyResult = function(element, choiceResponse, selectedChoice) {
        var percentageVal = this.getChoicePercentage(choiceResponse);
        var width = 0;
        if (element.querySelector('.choice-value').innerText === selectedChoice) {
            element.classList.add('selected');
        }
        var id = setInterval(setPercentageProgress, 10);
        function setPercentageProgress() {
            if (width >= percentageVal) {
                element.querySelector('.choice-percentage').innerHTML = percentageVal + '%';
                element.querySelector('.choice-bg').style.width = percentageVal + '%';
                clearInterval(id);
            } else {
                width++;
                element.querySelector('.choice-bg').style.width = width + '%';
                element.querySelector('.choice-percentage').setAttribute("data-percentage", percentageVal);
                element.querySelector('.choice-percentage').innerHTML = width * 1 + '%';
            }
        }
    };

    p.getChoicePercentage = function(choiceResponse) {
        var choiceResponseArray = choiceResponse && choiceResponse.split("%");
        var percentageValue = 0;
        if (choiceResponseArray && choiceResponseArray.length > 0) {
            percentageValue = choiceResponseArray[0];
        }
        return parseFloat(percentageValue).toFixed(1);
    };

    p.getSurveyStorageKey = function(surveyName) {
        var surveyStorageKey = 'survey.default';
        if (surveyName) {
            surveyStorageKey = 'survey.' + surveyName;
        }
        return surveyStorageKey;
    };

    p.setSurveyAsCompleted = function(surveyStorageKey) {
        var surveyPopupSection = document.querySelector('.survey-thankyou-popup');
        if (typeof window.localStorage != 'undefined') {
            try {
                window.localStorage.setItem(surveyStorageKey, true);
                if (localStorage && localStorage.getItem('survey.Data') && surveyPopupSection.classList.contains('model-open')) {
                    var data = JSON.parse(localStorage.getItem('survey.Data'));
                    data.surveyStorageWhitepaper = 'true';
                    localStorage.setItem('survey.Data', JSON.stringify(data));
                }
            } catch (error) {
                return false;
            }
        }
    };

    p.isSurveyCompleted = function(surveyStorageKey) {
        if (typeof window.localStorage != 'undefined') {
            return window.localStorage.getItem(surveyStorageKey);
        } else {
            return false;
        }
    };
    obj.survey = new def.Survey();
})();
(function() {
    function attatchEvenents() {
        document.addEventListener('DOMContentLoaded', initDropDown);
        /*document.querySelector(".quarter-slider-container .previous").addEventListener("click", handleSliderNavigation, false);
        document.querySelector(".quarter-slider-container .next").addEventListener("click", handleSliderNavigation, false);*/
        /*window.addEventListener('resize', function() {
            updateSliderWidth();
            updateNavigationControls();
        });*/
        // document.querySelector(".investor-quarter-results").addEventListener("click", investorQuarterResultsOverlay, false);


    }


    var financialStatement = document.querySelector('.financial-dropdown-container .dropdown');
    new def.DropDown(financialStatement);

    function initDropDown() {
        var ddHeader = document.querySelector('.financial-dropdown-container .dropdown-header');
        var ddItems = document.querySelectorAll('.financial-dropdown-container .dropdown-item');
        var dropDown = document.querySelector('.financial-dropdown-container .dropdown');
        var isInitialized = dropDown && dropDown.classList.contains('initialized');
        var toggleDropDown = function(e) {
            var targetClass = e.target.className;
            var parentNode = e.target.parentNode.parentNode;
            var parentElClasses = parentNode.classList;
            if (targetClass == "dropdown-selected" || e.target.parentNode.className == "dropdown-selected") {
                if (isDropDownNavigationVisible()) {
                    handleDropDownNavigation(targetClass);
                    return;
                }
            }

            if (e.currentTarget.classList.contains('dropdown-item')) {
                for (var i = 0; i < ddItems.length; i++) {
                    ddItems[i].classList.remove('selected');
                }
                e.currentTarget.classList.add('selected');
                parentNode = e.target.parentNode.parentNode.parentNode;
                parentElClasses = parentNode.classList;
                updateSlider("position", getChildIndex(ddItems, e.currentTarget));
                parentNode.querySelector('.dropdown-selected').innerHTML = e.currentTarget.innerHTML;
            }
            if (window.location.pathname.indexOf('investor-relations')>-1) {
                if (parentElClasses.contains('open') && parentElClasses.contains('dropdown')) {
                    parentElClasses.remove('open');
                    parentElClasses.remove('bs-depth-3');
                } else if (parentElClasses.contains('dropdown')) {
                    parentElClasses.add('open');
                    parentElClasses.add('bs-depth-3');
                }
            }

        };




        if (ddHeader && ddItems && !isInitialized) {

            ddHeader.addEventListener('click', toggleDropDown, false);
            for (var i = 0; i < ddItems.length; i++) {
                ddItems[i].addEventListener('click', toggleDropDown, false);
            }
        }

    }
    var count = 0;

    function initQuarterlider() {
        updateSliderWidth();
        populateSliderContent();


    }

    function populateSliderContent() {
        var sliderConentContainerSelector = ".quarter-slider-content",
            sliderContainerSelector = ".quarter-slider-selected",
            sliderContent = "";
        sliderContent = document.querySelector(sliderConentContainerSelector);
        document.querySelector(sliderContainerSelector).innerHTML = sliderContent.innerHTML;

    }


    function updateSliderWidth() {
        var sliderConent = document.querySelector(".quarter-slider-content");
        var slider = document.querySelector(".quarter-slider-selected");
        var childrenCount = sliderConent.children.length;
        var slideContainerWidth = 0;

        if (isDropDownNavigationVisible()) {
            slideContainerWidth = 265 * childrenCount;
        } else {
            slideContainerWidth = 760 * childrenCount;
        }
        slider.style.width = slideContainerWidth + "px";
    }

    function isDropDownNavigationVisible() {
        var isVisible = false,
            iconDim = 0,
            arrow_icon = document.querySelector(".financial-dropdown-container .icon-ic_arrow_wht_left");
        iconDim = arrow_icon.getBoundingClientRect();
        isVisible = (iconDim.width != 0) ? true : false;
        return isVisible;
    }

    // Drop down navigation is from the left and right arrow icons in them mobile
    // resolution
    function handleDropDownNavigation(targetClass) {
        if (targetClass == "icon-ic_arrow_wht_left") {
            updatedDropDown("previous");
            updateSlider("previous");
            updateNavigationControls();
        } else if (targetClass == "icon-ic_arrow_wht_right") {
            updatedDropDown("next");
            updateSlider("next");
            updateNavigationControls();
        }
    }

    function navigateDropDownPrevious() {
        var currentSelectedNode,
            nextNode,
            selectedContainerNode;
        currentSelectedNode = document.querySelector(".financial-dropdown-container .dropdown-content-wrapper .selected");
        nextNode = currentSelectedNode.nextElementSibling;
        selectedContainerNode = document.querySelector(".financial-dropdown-container .dropdown-selected");
        if (nextNode != null) {
            currentSelectedNode.classList.remove('selected');
            nextNode.classList.add('selected');
            selectedContainerNode.innerHTML = nextNode.innerHTML;

        }
    }

    function navigateDropDownNext() {
        var currentSelectedNode,
            nextNode,
            selectedContainerNode;
        currentSelectedNode = document.querySelector(".financial-dropdown-container .dropdown-content-wrapper .selected");
        previousNode = currentSelectedNode.previousElementSibling;
        selectedContainerNode = document.querySelector(".financial-dropdown-container .dropdown-selected");
        if (previousNode != null) {
            currentSelectedNode.classList.remove('selected');
            previousNode.classList.add('selected');
            selectedContainerNode.innerHTML = previousNode.innerHTML;
        }
    }

    //   Slider navigation is done using button on the side of the quarter slider
    function handleQuarterSliderNext() {
        var currentSelectedNode,
            nextNode,
            selectedContainerNode, offsetLeft;
        currentSelectedNode = document.querySelector(".quarter-slider-container .quarter-slider-selected .selected");
        nextNode = currentSelectedNode.previousElementSibling;
        selectedContainerNode = document.querySelector(".quarter-slider-container .quarter-slider-selected");
        if (nextNode != null) {
            currentSelectedNode.classList.remove('selected');
            nextNode.classList.add('selected');
            offsetLeft = nextNode.offsetLeft;
            selectedContainerNode.style.left = -offsetLeft + "px";
        }

    }

    function handleQuarterSliderPrev() {
        var currentSelectedNode,
            nextNode,
            selectedContainerNode, offsetLeft;
        currentSelectedNode = document.querySelector(".quarter-slider-container .quarter-slider-selected .selected");
        previousNode = currentSelectedNode.nextElementSibling;
        selectedContainerNode = document.querySelector(".quarter-slider-container .quarter-slider-selected");
        if (previousNode != null) {

            currentSelectedNode.classList.remove('selected');
            previousNode.classList.add('selected');
            offsetLeft = previousNode.offsetLeft;
            selectedContainerNode.style.left = -offsetLeft + "px";
        }

    }


    function handleSliderNavigationByPos(pos) {
        var currentSelectedNode,
            newNode,
            selectedContainerNode, offsetLeft;
        currentSelectedNode = document.querySelector(".quarter-slider-container .quarter-slider-selected .selected");
        newNode = currentSelectedNode.parentNode.children[pos];
        selectedContainerNode = document.querySelector(".quarter-slider-container .quarter-slider-selected");
        if (newNode != null) {
            currentSelectedNode.classList.remove('selected');
            newNode.classList.add('selected');
            offsetLeft = newNode.offsetLeft;
            selectedContainerNode.style.left = -offsetLeft + "px";
            updateNavigationControls();
        }
    }

    function handleSliderNavigation(e) {

        if (e.target.className == "icon icon-ic_arrow_wht_left") {
            if (document.querySelector(".quarter-slider-container .previous").classList.contains("nav-disabled")) {
                return;
            }
            updatedDropDown("previous");
            updateSlider("previous");
            updateNavigationControls();
            animateSlider();

        } else if (e.target.className == "icon icon-ic_arrow_wht_right") {
            if (document.querySelector(".quarter-slider-container .next").classList.contains("nav-disabled")) {
                return;
            }
            updatedDropDown("next");
            updateSlider("next");
            updateNavigationControls();
            animateSlider();
            //updateNavigationControls(".quarter-slider-container .quarter-slider-content .selected");
        }
    }




    function animateSlider() {
        /*document.querySelector(".quarter-slider-selected").classList.add("slide-right");
        setTimeout(function() {
       document.querySelector(".quarter-slider-selected").classList.add("slide-right");
        }, 1000);*/

    }

    // Updated the Drop down and the slider
    function updatedDropDown(navigationType) {
        if (navigationType == "next") {
            navigateDropDownNext();
        } else {
            navigateDropDownPrevious();
        }
    }

    function updateSlider(navigationType, pos) {
        if (navigationType == "next") {
            handleQuarterSliderNext();
        } else if (navigationType == "previous") {
            handleQuarterSliderPrev();
        } else if (navigationType == "position") {
            handleSliderNavigationByPos(pos);
        }
    }



    // Disable and enable the navigation controls based on the selected controls
    function updateNavigationControls() {
        // If previous sibling  of selected element is not there then disable the next navigation
        //if next sibling of the selected element is not there then disable the previous  navigation

        var currentSelectedNode,
            nextNode,
            previousNode,
            selectedContainerNode,
            leftNavigationControl,
            prevElementSelector,
            nextElementSelector,
            selectedElem,
            navControls;
        navControls = getNavigationControls();
        selectedElem = getSelectedElement();
        prevElementSelector = navControls.prevElementSelector;
        nextElementSelector = navControls.nextElementSelector;
        currentSelectedNode = document.querySelector(selectedElem);
        previousNode = currentSelectedNode.previousElementSibling;
        nextNode = currentSelectedNode.nextElementSibling;

        if (nextNode == null || nextNode == undefined) {
            //Means reached end of the list .
            // disable the left navigation
            disableNavigationControl(prevElementSelector, 'nav-disabled');
        } else {
            enableNavigationControl(prevElementSelector, 'nav-disabled');
        }
        if (previousNode == null || previousNode == undefined) {
            //Means reached start  of the list .
            // disable the right  navigation
            disableNavigationControl(nextElementSelector, 'nav-disabled');
        } else {
            enableNavigationControl(nextElementSelector, 'nav-disabled');
        }
        if (nextNode != null && previousNode != null) {
            //Remove the disable
            enableNavigationControl(prevElementSelector, 'nav-disabled');
            enableNavigationControl(nextElementSelector, 'nav-disabled');

        }
    }

    function getNavigationControls() {
        var navControls = {};
        if (isDropDownNavigationVisible()) {
            navControls.prevElementSelector = ".financial-dropdown-container .dropdown-selected   .icon-ic_arrow_wht_left";
            navControls.nextElementSelector = ".financial-dropdown-container .dropdown-selected   .icon-ic_arrow_wht_right";
        } else {
            navControls.prevElementSelector = ".previous";
            navControls.nextElementSelector = ".next"
        }
        return navControls;
    }


    function getSelectedElement() {
        return ".quarter-slider-container .quarter-slider-selected .selected";
    }

    // Disable the navigation control on reaching the end of the list
    function disableNavigationControl(navElement, cssClass) {
        document.querySelector(navElement).classList.add(cssClass);

    }

    function enableNavigationControl(navElement, cssClass) {
        document.querySelector(navElement).classList.remove(cssClass);
    }

    function getChildIndex(children, child) {
        var i = 0;
        while (children[i] != child) i++;
        return i;
    }

    function init() {
        /*  attatchEvenents();*/
        /*  initQuarterlider();
          updateNavigationControls();*/
        callQuarter();
        highlightQuarter();
    }

    function highlightQuarter() {
    	
        if (window.location.pathname.indexOf('ir-financial-statements')>-1){
            var quarterList = document.getElementsByClassName('quarter');
            quarterList.forEach(function(item) {
                if ("#" + item.getAttribute("data-item") === window.location.hash) {
                    item.classList.add("active");
                }
            })
        }
    }

    function callQuarter() {
        var quarterList = document.getElementsByClassName('quarter');
        for (var i = 0; i < quarterList.length; i++) {
            quarterList[i].addEventListener('click', handleActiveTile, false);
            if (window.location.pathname.indexOf('investor-relations')>-1 &&
                !quarterList[i].classList.contains('annualreport') && !quarterList[i].classList.contains('finance-overlay')) {
                quarterList[i].href = "ir-financial-statements.html#" + (quarterList[i].getAttribute("data-item") !== null ? quarterList[i].getAttribute("data-item") : '');
            }
        }

    }

    function handleActiveTile(event) {
        var quarterList = document.getElementsByClassName('quarter');
        for (var i = 0; i < quarterList.length; i++) {
            /*if (quarterList[i].parentNode.classList.contains("selected")) {*/
            quarterList[i].classList.remove('active');
            /* }*/
        }
        this.classList.add('active');

    }
    init();

})();
var RippleEffect = {
    start: function(event) {
        var rippleElement = document.createElement('div');
        var maxDimension = Math.max(event.currentTarget.clientHeight, event.currentTarget.clientWidth);
        var position = {
            x: event.offsetX,
            y: event.offsetY
        };
        // For event bubbling
        if (!event.target.classList.contains('ripple-effect')) {
            position.x = event.target.offsetLeft + event.offsetX;
            position.y = event.target.offsetTop + event.offsetY;
        }
        var style = {
            'left': (position.x) + 'px',
            'top': (position.y) + 'px',
            'width': maxDimension + 'px',
            'height': maxDimension + 'px',
            'margin-left': (maxDimension / -2) + 'px',
            'margin-top': (maxDimension / -2) + 'px'
        };
        var convertedStyle = JSON.stringify(style).replace(/["{}]/g, '').replace(/,/g, ';');
        event.currentTarget.appendChild(rippleElement);
        rippleElement.classList.add('ripple');
        rippleElement.setAttribute('style', convertedStyle);
        rippleElement.classList.add('animate');
    },
    stop: function(event) {
        var targetElement = event.currentTarget;
        if (targetElement.classList.contains('ripple')) {
            targetElement = event.currentTarget.parentElement;
        }
        setTimeout(function() {
            var rippleElements = targetElement.querySelectorAll('.ripple');
            if (rippleElements && rippleElements.length > 0) {
                rippleElements.forEach(function(rippleElement) {
                    targetElement.removeChild(rippleElement);
                }, this);
            }
        }, 1000);
    },
    showEffect: function(event) {
        if (event.currentTarget.classList.contains('ripple-effect')) {
            var targetElement = event.currentTarget;

            RippleEffect.start(event);

            if ('ontouchstart' in window) {
                targetElement.addEventListener('touchend', RippleEffect.stop, false);
                targetElement.addEventListener('touchcancel', RippleEffect.stop, false);
            }

            targetElement.addEventListener('mouseup', RippleEffect.stop, true);
        }
    },
    init: function() {
        document.querySelectorAll('.ripple-effect').forEach(function(element) {
            element.addEventListener('mousedown', RippleEffect.showEffect);
        });
        if ('ontouchstart' in window) {
            document.body.addEventListener('touchstart', this.showEffect, utils.supportsPassive() ? {
                passive: true
            } : false);
        }
    }
};
(function() {
    'use strict';
    def.sectionSlider = function(element) {
        this.name = 'sectionSlider';
        if (!element)
            return false;
        this.elm = element;
        this.sliderOuter = element.querySelector('.slider-outer');
        this.sliderInner = element.querySelector('.slider-inner');
        this.sliderItem = element.querySelectorAll('.slider-item');
        this.sliderNav = element.querySelectorAll('.slider-nav');
        this.navArrows = element.querySelectorAll('.cws-arrows');
        this.navContainer = element.querySelector('.nav-carousel');
        this.contentOverlayCards = element.querySelectorAll('.content-overlay-wrapper');
        this.cardViewCount = 1;
        this.startPageX = 0;
        this.endPageX = 0;
        this.activeIndex = 1;
        this.sectionListContainerWidth = 0;
        this.init();
    };
    var p = def.sectionSlider.prototype;
    def.sectionSlider.prototype.constructor = def.sectionSlider;

    p.init = function() {
        var _this = this;
        if (this.contentOverlayCards && this.contentOverlayCards.length > 0) {
            for (var i = 0; i < this.contentOverlayCards.length; i++) {
                this.contentOverlayCards[i].style.width = this.contentOverlayCards[i].parentNode.parentNode.parentNode.clientWidth + 'px';
            }
        }
        _this.addEvents();
    };

    // Setlayout for slider implementation
    p.setLayout = function(width) {
        this.sliderInner.style.width = width + 'px';
    };

    // Attach touch events to section carousel and nav buttons
    p.addEvents = function() {
        try {
            var _this = this;
            var sectionListContainerWidth = 0;
            var minCarouselWidth = 0;

            if (this.navArrows.length > 0) {
                this.sliderOuter.querySelector(".cws-arrows.right").classList.remove('hide');		
                this.sliderOuter.querySelector(".cws-arrows.left").classList.remove('hide');		
            }
            // Add touch events to section carousel
            for (var iterator = 0; iterator < this.sliderItem.length; iterator++) {
                // Add "active" class to first section carousel
                if (iterator === 0) {
                    this.sliderItem[iterator].classList.add('active');
                    if (this.sliderNav.length > 1) {
                        if (this.sliderNav[0].parentElement.classList.contains('hide')) {
                            this.sliderNav[0].parentElement.classList.remove('hide')
                        }
                        this.sliderNav[iterator].classList.add('active');
                    } else {
                        if (this.sliderNav && this.sliderNav.length != 0) {
                            this.sliderNav[0].parentElement.classList.add('hide');
                        }
                    }
                    if (this.navArrows.length > 0) {
                        this.navArrows[iterator].classList.add('hide');
                    }
                }
                sectionListContainerWidth += this.sliderItem[iterator].getBoundingClientRect().width;
                if ((iterator === (this.sliderItem.length - 1)) && (this.sliderItem.length > 3)) {
                    sectionListContainerWidth += 30;
                }
                minCarouselWidth = this.sliderItem[0].getBoundingClientRect().width * 3;
                if (utils.isTouchDevice() && (this.contentOverlayCards.length == 0) ) {
                this.sliderItem[iterator].addEventListener('touchstart', _this.touchStartHandler.bind(_this), utils.supportsPassive() ? { passive: true } : false);
                this.sliderItem[iterator].addEventListener('touchend', _this.touchEndHandler.bind(_this));
                }
                if (this.sliderNav.length != 0) {		                
                	this.sliderNav[iterator].addEventListener('click', function(event) { _this.navSlideHandler(event); }, false);		
                	this.sliderNav[iterator].setAttribute('data-slider-index', iterator + 1);		
                }
	            if (iterator < this.navArrows.length) {		
	                this.navArrows[iterator].setAttribute('data-direction', 'dir-' + (iterator + 1));		
	                this.navArrows[iterator].addEventListener('click', function(event) {
	                    _this.decideSlideForContentOverlaycards(event);		
	                }, false);
	            }
	            this.sliderItem[iterator].setAttribute('data-slider-index', iterator + 1);
            }
            this.setLayout(sectionListContainerWidth > minCarouselWidth ? sectionListContainerWidth : minCarouselWidth);
        } catch (e) {
            //console.log(e);
        }
    };

    // Event handler for "touchstart"
    p.touchStartHandler = function(e) {
        this.startPageX = e.changedTouches[0].pageX;
        this.startPageY = e.changedTouches[0].pageY;
    };

    // Event handler for "touchend"
    p.touchEndHandler = function(e) {
        this.endPageX = e.changedTouches[0].pageX;
        this.endPageY = e.changedTouches[0].pageY;
        this.decideSlideForMobile();
    };

    // Handle nav button events
    p.navSlideHandler = function(e) {
        this.slide(this.activeIndex, e.target.getAttribute('data-slider-index'));
        this.changeActiveSelection(this.activeIndex, parseInt(e.target.getAttribute('data-slider-index')));
    };
    // Decision making on slider for content overlay cards
    p.decideSlideForContentOverlaycards = function(e) {
        if ((event.target.getAttribute('data-direction') === 'dir-1') && (this.activeIndex > 1)) {
            this.slide(this.activeIndex, (this.activeIndex - 1));
            this.changeActiveSelection(this.activeIndex, (this.activeIndex - 1));
        } else if ((event.target.getAttribute('data-direction') === 'dir-2') && (this.activeIndex < (this.contentOverlayCards.length + 1 - this.cardViewCount))) {
            this.slide(this.activeIndex, (this.activeIndex + 1));
            this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
        } else {
            return false;
        }
        //Hide or show the left arrow button according to the selected index
        if (this.activeIndex === 1) {
            this.sliderOuter.querySelector('[data-direction="dir-1"]').classList.add('hide');
            this.sliderOuter.querySelector('[data-direction="dir-2"]').classList.remove('hide');	
        }
        // Hide or show the right arrow button according to the selected index
        else if (this.activeIndex === (this.contentOverlayCards.length + 1 - this.cardViewCount)) {
            this.sliderOuter.querySelector('[data-direction="dir-1"]').classList.remove('hide');
            this.sliderOuter.querySelector('[data-direction="dir-2"]').classList.add('hide');
        } else {
            this.sliderOuter.querySelector('[data-direction="dir-1"]').classList.remove('hide');
            this.sliderOuter.querySelector('[data-direction="dir-2"]').classList.remove('hide');
        }		
    }

    // Decision making on slider on mobile devices
    p.decideSlideForMobile = function() {
        if (Math.abs(this.startPageY - this.endPageY) <= 100) {
            if (Math.abs(this.startPageX - this.endPageX) < 10) {
                return false;
            }
            if (this.startPageX < this.endPageX && this.activeIndex > 1) {
                this.slide(this.activeIndex, (this.activeIndex - 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex - 1));
            } else if (this.startPageX > this.endPageX && this.sliderItem.length > this.activeIndex) {
                this.slide(this.activeIndex, (this.activeIndex + 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
            } else {
                return false;
            }
        }
    };

    // Change active Selection
    p.changeActiveSelection = function(currentIndex, swipedIndex) {
        this.activeIndex = swipedIndex;
        // Change active Nav button
        if (this.sliderNav.length != 0) {
	        this.sliderOuter.querySelector('span[data-slider-index="' + currentIndex + '"]').classList.remove('active');
	        this.sliderOuter.querySelector('span[data-slider-index="' + swipedIndex + '"]').classList.add('active');
    	}
        // Change active section
        this.sliderOuter.querySelector('div[data-slider-index="' + currentIndex + '"]').classList.remove('active');
        this.sliderOuter.querySelector('div[data-slider-index="' + swipedIndex + '"]').classList.add('active');
    };

    // slide container for slide effect
    p.slide = function(currentIndex, swipedIndex) {
        var translateValue = 0;
        var widthtouch = this.sliderItem[0].getBoundingClientRect().width.toFixed(2);
        translateValue = ((swipedIndex - 1) * (widthtouch));
        this.sliderInner.style.transform = "translateX(-" + translateValue + "px)";
        this.sliderInner.style.webkitTransform = "translateX(-" + translateValue + "px)";
    };
})();
(function() {
    'use strict';

    var SectionBase = function(elm) {
        // Initialize Object
        this.init(elm);

    };

    SectionBase.prototype.init = function(elm) {
        this.name = 'SectionBase';
        this.elm = elm;
        this.listeners = [];
    };

    SectionBase.prototype.onRequestAnimationFrame = function() {};

    SectionBase.prototype.onscroll = function(callback) {
        this.subscribe('onscroll', callback);
    };

    SectionBase.prototype.onenter = function(callback) {
        this.subscribe('onenter', callback);
    };

    SectionBase.prototype.onexit = function(callback) {
        this.subscribe('onexit', callback);
    };

    SectionBase.prototype.subscribe = function(event, callback) {
        this.listeners[event] = this.listeners[event] || [];
        this.listeners[event].push(callback);
    };

    SectionBase.prototype.dispatch = function(event) {
        var _this = this;
        if (this.listeners && this.listeners[event]) {
            window.Array.prototype.forEach.call(this.listeners[event], function(callback) {
                callback && callback.call(_this);
            });
        }
    };

    window.def.SectionBase = SectionBase;
})();
(function() {
    "use strict";

    var base = new def.SectionBase();
    var SectionBanner = function(element, index) {

        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.init();

        function init() {
            base.init.call(this);
            this.name = "SectionBanner";
            this.elm = element;
            this.index = index;
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

    };

    SectionBanner.prototype = base;
    SectionBanner.prototype.constructor = SectionBanner;
    window.def.SectionBanner = SectionBanner;
})();
(function () {
    'use strict';

    var base = new def.SectionBase();
    var SectionCardArrow = function (element, index) {
        if (!element) {
            return;
        }
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.addEvents = addEvents;
        this.onClickNavLeft = onClickNavLeft;
        this.onClickNavRight = onClickNavRight;
        this.onClickNavDot = onClickNavDot;
        this.setupNavs = setupNavs;
        this.init();

        function init() {
            base.init.call(this);
            this.name = 'SectionCardArrow';

            this.elm = element;
            this.index = index;
            this.translateAmount = 0;
            this.cardSlider = this.elm.querySelector('.card-slider-arrow-card-container');
            this.cardWidth = this.cardSlider.querySelector('.slider-card-section').clientWidth;
            var cardCount = this.elm.querySelectorAll('.slider-card-section').length;
            this.totalWidth = -(cardCount - 3) * this.cardWidth;
            this.navLeft = this.elm.querySelector('.card-slider-arrow-nav.left');
            this.navRight = this.elm.querySelector('.card-slider-arrow-nav.right');

            this.navDots = this.elm.querySelectorAll(".nav-carousel-small li");
            this.cards = this.elm.querySelectorAll(".slider-card-section");

            this.addEvents();
            this.setupNavs();
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

        function addEvents() {

            var _this = this;
            var navDot;
            var navDotCount = this.navDots.length;

            /* Remove arrows, if only three cards in the section */
            if (this.cards.length > 3) {
                this.navLeft.classList.add('show');
                this.navRight.classList.add('show');
                this.navLeft.classList.remove('hide');
                this.navRight.classList.remove('hide');
            } else {
                this.navLeft.classList.add('hide');
                this.navRight.classList.add('hide');
                this.navLeft.classList.remove('show');
                this.navRight.classList.remove('show');
            }

            this.navLeft.addEventListener('click', this.onClickNavLeft.bind(_this), false);
            this.navRight.addEventListener('click', this.onClickNavRight.bind(_this), false);

            //Nav Dots
            for (var i = 0; i < navDotCount && navDotCount > 1; ++i) {
                navDot = this.navDots[i];
                navDot.dotIndex = i;
                navDot.addEventListener('click', this.onClickNavDot.bind(_this), false);
            }
        };

        function onClickNavLeft(event) {
            if (this.translateAmount != 0) {

                this.translateAmount += this.cardWidth;

                this.cardSlider.setAttribute('style', 'transform:translateX(' + this.translateAmount + 'px)');
                this.setupNavs();
            }
        };

        function onClickNavRight(event) {
            if (this.translateAmount != this.totalWidth) {
                this.translateAmount -= this.cardWidth;
                var transWidth = this.translateAmount - 30;
                this.cardSlider.setAttribute('style', 'transform:translateX(' + transWidth + 'px)');
                this.setupNavs();
            }

        };

        function onClickNavDot(event) {
            var target = event.target;
            var dotIndex = target.dotIndex;

            this.elm.querySelector(".nav-carousel-small li.active").classList.remove('active');
            this.navDots[dotIndex].classList.add('active');

            this.elm.querySelector('.slider-card-section.active').classList.remove('active');
            this.cards[dotIndex].classList.add('active');
        };

        function setupNavs() {
            // if (this.translateAmount == 0) {
            //     this.navLeft.classList.remove('visible');
            //     this.navRight.classList.add('visible');
            // } else if (this.translateAmount == this.totalWidth) {
            //     this.navLeft.classList.add('visible');
            //     this.navRight.classList.remove('visible');
            // } else {
            //     this.navLeft.classList.add('visible');
            //     this.navRight.classList.add('visible');
            // }
        };

    };

    SectionCardArrow.prototype = base;
    SectionCardArrow.prototype.constructor = SectionCardArrow;
    window.def.SectionCardArrow = SectionCardArrow;
})();
(function () {
    'use strict';
    var base = new window.def.SectionBase();
    var SectionFeature = function (element, index) {
        if (!element) {
            return;
        }
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.playVideo = playVideo;
        this.loadVideo = loadVideo;
        this.videoPlayed = false;

        this.init();

        function init() {
            var _this = this;
            base.init.call(this);
            this.name = 'SectionFeature';

            this.elm = element;
            this.index = index;
            this.videoEl = this.elm.querySelector('.section-feature .section-background video');
            this.loadVideo();
            this.onenter(function () {
                _this.inViewPort = true;
            });
            this.onexit(function () {
                _this.inViewPort = false;
            });
        };

        function onRequestAnimationFrame() {
            base.onRequestAnimationFrame.call(this);
            this.playVideo();
        };

        function loadVideo() {
            var _this = this;
            if (this.videoEl) {
                window.Modernizr.on('videoautoplay', function () {
                    if (window.Modernizr.videoautoplay) {
                        _this.videoEl.querySelectorAll('source').forEach(function (source) {
                            var newSource = document.createElement('source');
                            newSource.setAttribute('type', source.getAttribute('type'));
                            // Removing video source on IE mobile.
                            if (!utils.isMobile) {
                                newSource.setAttribute('src', source.dataset.src);
                            }
                            _this.videoEl.appendChild(newSource);
                        });

                    }
                });

                if (this.videoEl.readyState === 4) {
                    _this.playVideo();
                } else {
                    this.videoEl.addEventListener('canplay', function () {
                        _this.videoEl.classList.add('loaded');
                        _this.hasVideo = true;
                        _this.playVideo();
                    }, true);
                }
            }
        };

        function playVideo() {
            if (this.hasVideo && !this.videoPlayed && this.inViewPort) {
                this.videoEl.play();
                this.videoPlayed = true;
                //console.log('played');
            }
        };
    };


    SectionFeature.prototype = base;
    SectionFeature.prototype.constructor = SectionFeature;
    window.def.SectionFeature = SectionFeature;

})();
(function () {
    'use strict';
    var base = new window.def.SectionBase();
    var SectionHero = function (element, index) {
        if (!element) {
            return;
        }
        var _this = this;
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.playVideo = playVideo;
        this.loadVideo = loadVideo;
        this.init();

        function init() {
            base.init.call(this);
            this.name = 'SectionHero';

            this.elm = element;
            this.index = index;
            this.bleedEl = this.elm.querySelector('.section-hero .section-bleed');
            this.videoEl = this.elm.querySelector('.section-hero .section-bleed video');
            this.bleedElHeight = this.bleedEl ? this.bleedEl.clientHeight : 0;
            this.videoContainers = this.elm.querySelectorAll('.video-container');

            if (this.videoContainers) {
                for (var i = 0; i < this.videoContainers.length; i++) {
//                    new def.Video(this.videoContainers[i]);
                    this.videoPlyButtons = this.videoContainers[i].querySelector('.video-control.video-play');
                    this.videoPlyButtons.classList.add('right-aligned');
                    return;
                }
            }
            this.loadVideo();
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

        function playVideo() {
            if (!_this.videoPlaying) {
                _this.videoPlaying = true;
                if (_this.videoEl) {
                    _this.videoEl.classList.add('loaded');
                    _this.videoEl.style.display = 'block';
                    _this.videoEl.play();
                }

            }
        }

        function loadVideo() {


            if (this.videoEl) {
                window.Modernizr.on('videoautoplay', function () {
                    if (window.Modernizr.videoautoplay) {
                        _this.videoEl.querySelectorAll('source').forEach(function (source) {
                            var newSource = document.createElement('source');
                            // Removing video source on mobile.
                            if (!utils.isMobile) {
                                newSource.setAttribute('src', source.dataset.src);
                            }
                            newSource.setAttribute('type', source.getAttribute('type'));
                            _this.videoEl.appendChild(newSource);
                        });
                    }
                });

                if (this.videoEl.readyState === 4) {
                    this.playVideo();
                   // console.log('from here')
                } else {
                    this.videoEl.addEventListener('canplay', _this.playVideo);
                }
            }
        };
    };

    SectionHero.prototype = base;
    SectionHero.prototype.constructor = def.SectionHero;
    window.def.SectionHero = SectionHero;
})();
(function () {
    "use strict";

    var base = new def.SectionBase();
    var SectionPeople = function (element, index) {
        if (!element) {
            return;
        }
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.addEvents = addEvents;
        this.onClickMenu = onClickMenu;
        this.onClickNavDot = onClickNavDot;
        this.init();

        function init() {
            base.init.call(this);
            this.name = "SectionPeople";

            this.elm = element;
            this.index = index;
            this.menuMarker = this.elm.querySelector("#menu-marker");
            this.menus = this.elm.querySelectorAll(".section-people .menu li");
            this.menuActive = this.elm.querySelector(".section-people .menu li.active");
            this.profiles = this.elm.querySelectorAll(".section-people .section-bleed .video-fade");
            this.commends = this.elm.querySelectorAll(".section-people .commend");
            this.navDots = this.elm.querySelectorAll(".section-people .nav-carousel-large li");
            if(this.menuMarker) {
        	  this.menuMarker.style.top = this.menuActive.offsetTop + 'px';
              this.menuMarker.style.height = this.menuActive.offsetHeight + 'px';
            }
          
            this.addEvents();
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

        function addEvents() {
            var _this = this;
            var menuCount = this.menus.length;
            var menu;
            var navDotCount = this.navDots.length;
            var navDot;

            for (var i = 0; i < menuCount && menuCount > 1; ++i) {
                menu = this.menus[i];
                menu.menuIndex = i;
                menu.addEventListener('click', this.onClickMenu.bind(_this), false);
            }

            for (var i = 0; i < navDotCount && navDotCount > 1; ++i) {
                navDot = this.navDots[i];
                navDot.dotIndex = i;
                navDot.addEventListener('click', this.onClickNavDot.bind(_this), false);
            }
        };

        function onClickMenu(event) {
            var parentNode = event.target.parentNode;
            var menuIndex = parentNode.menuIndex;

            if (parentNode.classList.contains('people-menu-list') === true) {
                this.elm.querySelector(".section-people .menu li.active").classList.remove('active');
                this.menus[menuIndex].classList.add('active');

                this.menuActive = this.elm.querySelector(".section-people .menu li.active");
                this.menuMarker.style.top = this.menuActive.offsetTop + 'px';
                this.menuMarker.style.height = this.menuActive.offsetHeight + 'px';

                this.elm.querySelector(".section-people .section-bleed .video-fade.active").classList.remove('active');
                this.profiles[menuIndex].classList.add('active');

                this.elm.querySelector(".section-people .commend.active").classList.remove('active');
                this.commends[menuIndex].classList.add('active');
            }
        };


        function onClickNavDot(event) {
            var target = event.target;
            var menuIndex = target.dotIndex;

            this.elm.querySelector(".section-people .menu li.active").classList.remove('active');
            this.menus[menuIndex].classList.add('active');

            this.elm.querySelector(".section-people .section-bleed .video-fade.active").classList.remove('active');
            this.profiles[menuIndex].classList.add('active');

            this.elm.querySelector(".section-people .commend.active").classList.remove('active');
            this.commends[menuIndex].classList.add('active');

            this.elm.querySelector(".section-people .nav-carousel-large li.active").classList.remove('active');
            this.navDots[menuIndex].classList.add('active');
        };
    };

    SectionPeople.prototype = base;
    SectionPeople.prototype.constructor = SectionPeople;
    window.def.SectionPeople = SectionPeople;
})();

(function () {
    'use strict';

    var base = new def.SectionBase();
    var SectionSearch = function (element, index) {
        if (!element) {
            return;
        }
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.playVideo = playVideo;
        this.init();

        function init() {
            base.init.call(this);
            this.name = 'SectionSearch';

            this.elm = element;

            this.index = index;
            this.bleedEl = this.elm.querySelector('.section-search .section-bleed');
            this.videoEl = this.elm.querySelector('.section-search .section-bleed video');
            this.bleedElHeight = this.bleedEl ? this.bleedEl.clientHeight : 0;
            this.playVideo();
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

        function playVideo() {
            var _this = this;

            if (this.videoEl) {
                this.videoEl.addEventListener('canplay', function () {
                    _this.hasVideo = true;
                    _this.videoEl.style.display = 'block';
                    _this.videoEl.play();
                }, true);
            }
        };

    };

    SectionSearch.prototype = base;
    SectionSearch.prototype.constructor = SectionSearch;
    window.def.SectionSearch = SectionSearch;
})();

(function() {
     'use strict';
     var base = new window.def.SectionBase();
     var SectionCounter = function(element, index) {

          this.init = init;
          this.init();

          function init() {
               base.init.call(this);
               this.name = 'SectionCounter';
               this.elm = element;
               this.index = index;
               this.onenter(startCounterAnimation);
          };

          function startCounterAnimation() {
               var counterItems = document.querySelectorAll('.counter-item');
               for (var i = 0; i < counterItems.length; i++) {
                    var count = Number(counterItems[i].getAttribute('data-count'));
                    conter(counterItems[i], count);
               }
          };

          function conter(elm, target) {
               var number, timing, increment, interval;
               if (target % 1 != 0) {
                    number = 0.00;
                    timing = parseFloat(625 / target).toFixed(2);
                    interval = setInterval(function() {
                         elm.innerHTML = parseFloat(number).toFixed(2);
                         if (parseFloat(number) >= parseFloat(target)) {
                              clearInterval(interval);
                              elm.innerHTML = parseFloat(target).toFixed(2);
                         }
                         number = parseFloat(number) + 1.01;
                    }, timing);
               } else if (target < 101 && target > 0) {
                    number = 0;
                    timing = parseFloat(625 / target).toFixed(2);
                    interval = setInterval(function() {
                         elm.innerHTML = number;
                         if (number >= target) clearInterval(interval);
                         number++;
                    }, timing);
               } else if (target >= 101) {
                    increment = parseInt(target / 25);
                    number = target - (increment * 25);
                    interval = setInterval(function() {
                         elm.innerHTML = number;
                         if (number >= target) clearInterval(interval);
                         number = number + increment;
                    }, 25);
               } else if (target < 0) {
                    number = 0;
                    elm.innerHTML = number;
                    var targetPositive = target * -1;
                    timing = parseFloat(625 / targetPositive).toFixed(2);
                    interval = setInterval(function() {
                         elm.innerHTML = number;
                         if (number <= target) clearInterval(interval);
                         number--;
                    }, timing);
               }
          };

     };

     SectionCounter.prototype = base;
     SectionCounter.prototype.constructor = SectionCounter;
     window.def.SectionCounter = SectionCounter;
})();
(function() {
    'use strict';
    def.sectionCarousel = function(element, options) {
        this.name = 'sectionCarousel';
        this.options = {
            animation: "fadeIn",
            speed: 8000
        };
        this.options = (typeof options === "undefined") ? this.options : options;
        if (!element)
            return false;
        this.elm = element;
        this.carouselSections = this.elm.querySelectorAll('.section-feature-background-wrapper');
        this.carouselItemsLength = this.carouselSections.length;
        this.carouselCards = this.elm.querySelectorAll('.three-cards-container');
        this.navDotContainer = this.elm.querySelector('.three-cards-nav-carousel');
        if (this.navDotContainer) {
            this.navDotItems = this.navDotContainer.querySelectorAll('.three-cards-nav-carousel-item');
        }
        this.activeCarousel = 0;
        this.init();
    };
    var p = def.sectionCarousel.prototype;
    def.sectionCarousel.prototype.constructor = def.sectionCarousel;

    p.init = function() {
        this.addEvents();
    };

    p.addEvents = function() {
        var _this = this;
        _this.initAutoSlide();
        if(_this.navDotItems) {
            if (_this.navDotItems.length > 0) {
                for (var i = 0; i < this.navDotItems.length; i++) {
                    _this.navDotItems[i].addEventListener('click', function(event) {
                        if (!utils.isTouchDevice()) {
                            _this.setCurrCarouselItem(parseInt(this.getAttribute('data-nav-item')));
                        }
                        _this.clearAutoSlide();
                    }, false);
                }
            }
        }
    };

    p.initAutoSlide = function() {
        var _this = this;
        if (!utils.isTouchDevice()) {
            _this.animBox = setInterval(function() {
                if ((_this.activeCarousel + 1) < _this.carouselItemsLength) {
                    _this.increCurrCarouselItem();
                }
            }, _this.options.speed);
        }
    };

    p.increCurrCarouselItem = function() {
        var _this = this;
        var activeCarousel;
        if ((_this.activeCarousel + 1) < _this.carouselItemsLength) {
            activeCarousel = _this.activeCarousel + 1;
        } else {
            activeCarousel = 0;
        }
        _this.setCurrCarouselItem(activeCarousel);
    };

    p.setCurrCarouselItem = function(activeCarousel) {
        if (!utils.isTouchDevice()) {
            var _this = this;
            _this.activeCarousel = activeCarousel;
            _this.setCarouselIndicator(activeCarousel);
            _this.setCarouselSection(activeCarousel);
            if (_this.carouselCards && _this.carouselCards.length > 0) {
                _this.setCarouselCards(activeCarousel);
            }
        }
    };

    p.setCarouselIndicator = function(activeCarousel) {
        var _this = this;
        _this.resetCarouselIndicators();
        if (!_this.navDotItems[activeCarousel].classList.contains('active')) {
            _this.navDotItems[activeCarousel].classList.add('active');
        }
    };

    p.setCarouselSection = function(activeCarousel) {
        var _this = this;
        _this.resetCarouselSections();
        if (!_this.carouselSections[activeCarousel].classList.contains('active')) {
            _this.carouselSections[activeCarousel].classList.add('active');
        }
    };

    p.setCarouselCards = function(activeCarousel) {
        var _this = this;
        _this.resetCarouselCards();
        if (!_this.carouselCards[activeCarousel].classList.contains('active')) {
            _this.carouselCards[activeCarousel].classList.add('active');
        }
    };

    p.resetCarouselIndicators = function() {
        var _this = this;
        for (var i = 0; i < _this.carouselItemsLength; i++) {
            if (_this.navDotItems[i].classList.contains('active')) {
                _this.navDotItems[i].classList.remove('active');
            }
        }
    };

    p.resetCarouselSections = function() {
        var _this = this;
        for (var i = 0; i < _this.carouselItemsLength; i++) {
            if (_this.carouselSections[i].classList.contains('active')) {
                _this.carouselSections[i].classList.remove('active');
            }
        }
    };

    p.resetCarouselCards = function() {
        var _this = this;
        for (var i = 0; i < _this.carouselItemsLength; i++) {
            if (_this.carouselCards[i].classList.contains('active')) {
                _this.carouselCards[i].classList.remove('active');
            }
        }
    };

    p.clearAutoSlide = function() {
        var _this = this;
        clearInterval(_this.animBox);
        _this.initAutoSlide();
    };


})();
(function () {
    'use strict';
    var SideMenu = function (element) {
        if (!element) {
            return;
        }
        var _this = this;
        this.init = init;
        this.addEvents = addEvents;

        this.init(element);

        function init(element) {
            this.name = 'SideMenu';

            this.elm = element;

            this.menuItems = this.elm.querySelectorAll('.scroll-menu h3');
            this.sideMenus = this.elm.querySelectorAll('.scroll-menu-content');
            this.prevSideMenuIndex = 0;

            this.addEvents();
            RippleEffect.init();
        };

        function addEvents() {
            for (var i = 0; i < this.menuItems.length; i++) {
                this.menuItems[i].index = i;
                this.menuItems[i].addEventListener('click', function () {
                    if (_this.prevSideMenuIndex != null && _this.sideMenus[_this.prevSideMenuIndex]) {
                        _this.sideMenus[_this.prevSideMenuIndex].classList.remove('selected');
                    }
                    if (_this.sideMenus[this.index]) {
                        _this.sideMenus[this.index].classList.add('selected');
                        _this.prevSideMenuIndex = this.index;
                    }
                }, false);
            }

            // Menu item selector event handler
            document.querySelectorAll('.side-menu-nav-item').forEach(function (element) {
                element.addEventListener('click', function () {
                    // Highlights selected item in menu dropdown in mobile view
                    document.querySelectorAll('.side-menu-nav-item').forEach(function (element) {
                        element.classList.remove('selected');
                    });
                    this.classList.add('selected');

                    // Handles contents switch for each menu item
                    document.querySelectorAll('.side-menu-content').forEach(function (element) {
                        element.style.display = "none";
                    });
                    var contentElementSelector = '.side-menu-content[data-index="' + this.getAttribute('data-index') + '"]';
                    document.querySelector(contentElementSelector).style.display = "inline-block";

                    // Menu item marker animation for desktop view
                    document.querySelector('.side-menu-nav-marker').classList = ['side-menu-nav-marker side-menu-nav-marker-level' + this.getAttribute('data-index')];

                    // Dropdown menu control
                    this.parentNode.classList.remove('show');
                    this.parentNode.parentNode.querySelector('.side-menu-dropdown-arrow').classList.remove('open');
                    this.parentNode.nextElementSibling.innerHTML = this.innerHTML;
                });
            }, this);

            // Dropdown selector event handler for mobile view
            document.querySelectorAll('.side-menu-title').forEach(function (element) {
                element.addEventListener('click', function () {
                    var targetElement = this.parentNode.querySelector('.side-menu-dropdown-arrow');
                    if (targetElement.classList.contains('open')) {
                        this.parentNode.querySelector('.side-menu-nav').classList.remove('show');
                        targetElement.classList.remove('open');
                    } else {
                        this.parentNode.querySelector('.side-menu-nav').classList.add('show');
                        targetElement.classList.add('open');
                    }
                });
            }, this);
        };
    };
    def.SideMenu = SideMenu;
})();
var CardSlider = function (section) {

    this.section = section;

    var findCardSelected = function (attribute, anchorIndexValue, type) {
        var className = '';
        var allCards = '';
        var zIndex = 'z-index';
        if (type === 'panel-nav-link-small') {
            // className = this.section + ' .panel-card .slider-card-section';
            className = '.slider-card-section';
            var panelCards = document.querySelectorAll(this.section + ' .panel-card');
            var parentPanelCardIndex = anchorIndexValue / 3;
            if (parentPanelCardIndex < 1) {
                parentPanelCardIndex = 1;
            } else if (anchorIndexValue % 3 !== 0) {
                parentPanelCardIndex = Math.trunc(parentPanelCardIndex) + 1;
            }
            var panelCard = panelCards[parentPanelCardIndex - 1];
            // parent panel
            panelCard.style.opacity = 1;
            panelCard.style[zIndex] = 1;
            for (var p = 0; p < panelCards.length; p++) {
                if (p !== parentPanelCardIndex - 1) {
                    panelCards[p].style.opacity = 0;
                    panelCards[p].style[zIndex] = -1;
                }
            }
            allCards = panelCard.querySelectorAll(className);
            // calculating new anchorIndex
            if (anchorIndexValue > 3) {
                anchorIndexValue = anchorIndexValue % 3;
                if (anchorIndexValue === 0) {
                    anchorIndexValue = 3;
                }
                anchorIndexValue = anchorIndexValue.toString();
            }
        } else {
            className = this.section + ' .panel-card';
            allCards = document.querySelectorAll(className);
        }

        for (var i = 0; i < allCards.length; i++) {
            if (allCards[i].getAttribute(attribute) === anchorIndexValue) {
                return allCards[i];
            }
        }
    };

    var findCardNotInIndex = function (anchorIndexValue, type) {
        var className = '';
        var cardsNotInIndex = [];
        var allCards;
        if (type === 'panel-nav-link-small') {
            // className = this.section + ' .panel-card .slider-card-section';
            className = '.slider-card-section';
            var sliderCards = document.querySelectorAll(this.section + ' .slider-card-section');
            if (sliderCards) {
                for (var j = 0; j < sliderCards.length; j++) {
                    if (j !== anchorIndexValue - 1) {
                        cardsNotInIndex.push(sliderCards[j]);
                    }
                }
            }

        } else {
            className = this.section + ' .panel-card';
            allCards = document.querySelectorAll(className);
            if (allCards) {
                for (var i = 0; i < allCards.length; i++) {
                    if (allCards[i].getAttribute('data-card-index') !== anchorIndexValue) {
                        cardsNotInIndex.push(allCards[i]);
                    }
                }
            }

        }

        return cardsNotInIndex;
    };

    var changeNavOpacity = function (anchorIndex) {
        var navLink = document.querySelectorAll(this.section + ' .panel-nav-but a');
        if (navLink) {
            for (var i = 0; i < navLink.length; i++) {
                if (anchorIndex !== navLink[i].getAttribute('data-card-nav-index')) {
                    navLink[i].style.opacity = 0.3;
                }
            }
        }

    };

    var slideFunction = function (event) {
        var anchorIndex = event.target.getAttribute('data-card-nav-index');
        var anchorType = event.target.classList[1];
        // marking the slide nav as selected
        event.target.style.opacity = 1;
        changeNavOpacity.call(this, anchorIndex);

        var zIndex = 'z-index';

        var cardSelected = findCardSelected.call(this, 'data-card-index', anchorIndex, anchorType);
        if (cardSelected) {
            cardSelected.style.opacity = 1;
            cardSelected.style[zIndex] = 1;
        }
        var cardToBeHidden = findCardNotInIndex.call(this, anchorIndex, anchorType);
        for (var i = 0; i < cardToBeHidden.length; i++) {
            cardToBeHidden[i].style.opacity = 0;
            cardToBeHidden[i].style[zIndex] = -1;
        }
    };

    this.init = function () {
        var navLinkLarge = document.querySelectorAll(this.section + ' .panel-nav-large .panel-nav-but a');
        if (navLinkLarge && navLinkLarge.length) {
            navLinkLarge[0].style.opacity = 1;
        }
        var navLinkSmall = document.querySelectorAll(this.section + ' .panel-nav-small .panel-nav-but a');
        if (navLinkSmall && navLinkSmall.length) {
            navLinkSmall[0].style.opacity = 1;
        }
        // event listener for slide button click
        var slideButtonLarge = document.querySelectorAll(this.section + ' .panel-nav-large .panel-nav-link');
        if (slideButtonLarge && typeof slideButtonLarge !== "undefined") {
            for (var i = 0; i < slideButtonLarge.length; i++) {
                slideButtonLarge[i].addEventListener('click', slideFunction.bind(this));
            }
        }
        var slideButtonSmall = document.querySelectorAll(this.section + ' .panel-nav-small .panel-nav-link');
        if (slideButtonSmall && typeof slideButtonSmall !== "undefined") {
            for (var j = 0; j < slideButtonSmall.length; j++) {
                slideButtonSmall[j].addEventListener('click', slideFunction.bind(this));
            }
        }
    };

};
(function() {
    'use strict';
    /**
     * @function
     * @name EventList
     * @param eventListWrapper {Object} HTMLDivElement Object for the wrapper of events(event section)
     * @param eventList {Object} HTMLDivElement Object for the list of events
     * @param navBtnControlsList {Object} HTMLUlElement for the nav buttons in event area
     * @param dropdownMenuItems {array} NodeList of dropdown menu items for filterring the events
     * @desc Contructor for Event listing with Web service integration for event listing in TCS worldwide
     * @return {null}
     */
    function EventList(eventListWrapper, eventList, navBtnControlsList, dropdownMenuItems) {
        // Instance Variables
        this.events = [];
        this.eventListWrapper = eventListWrapper;
        this.eventList = eventList;
        this.navBtnControlsList = navBtnControlsList;
        this.dropdownMenuItems = dropdownMenuItems;
        this.itemsShownInPage = 3;
        this.startIndex = 0;
        this.endIndex = this.startIndex + this.itemsShownInPage;
        this.filteredEvents = [];
        this.isFilterApplied = false;
        // Instance Methods
        this.init = init;
        this.fetchEvents = fetchEvents;
        this.listEvents = listEvents;
        this.createEventListDOM = createEventListDOM;
        this.changeActiveNavBtn = changeActiveNavBtn;
        this.createNavBtnsForEvents = createNavBtnsForEvents;
        this.injectNavBtnListItem = injectNavBtnListItem;
        this.addClickEventToNavBtns = addClickEventToNavBtns;
        this.addChangeToDropDownFilter = addChangeToDropDownFilter;
        this.filterEvents = filterEvents;
		this.showPastEvents = showPastEvents;
        this.fetchPastEvents = fetchPastEvents;
		this.listPastEvents = listPastEvents;
        this.pastEventOffset = 0;
        this.pastEventLimit = 3;
		this.pastEvents = null;
        this.totalPastEventCount = 0;
        this.loadMorePastEvent = null;
        // Init eventList
        function init() {
            this.fetchEvents();
        }
        // Add change event to drop down menu for filtering the events
        function addChangeToDropDownFilter() {
            var _this = this;
            this.dropdownMenuItems.forEach(function(menuItem) {
                menuItem.addEventListener('click', function() {
                    _this.filterEvents(event.target.textContent.trim());
                });
            });
        }
        // Add click to nav button created
        function addClickEventToNavBtns() {
            var _this = this;
            var navBtns = this.navBtnControlsList.querySelectorAll('li a');
            for (var i = 0; i < navBtns.length; i++) {
                navBtns[i].addEventListener('click', _this.changeActiveNavBtn.bind(_this)); // handle click
                navBtns[i].addEventListener('touchstart', _this.changeActiveNavBtn.bind(_this)); // handle touch
            }
        }
        // Fetch events from remote server
        function fetchEvents() {
            var _this = this;
            var loaderDiv = document.querySelector('.progress');
            if (loaderDiv && loaderDiv.classList.contains('hide')) {
                loaderDiv.classList.remove('hide');
            }
            fetch('./js/service/events.json', {
                method: 'GET',
                credentials: 'include'
            }).then(function(response) {
                if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                    loaderDiv.classList.add('hide');
                }
                if (response.status === 200) {
                    response.json().then(function(data) {
                        _this.events = data.events;
                        _this.filteredEvents = data.events;
                        _this.listEvents();
                        _this.createNavBtnsForEvents();
                        _this.addChangeToDropDownFilter()
                    });
                }
            }).catch(function(error) {
            //    console.log(error);
            });
        }
		// Fetch past events
        function fetchPastEvents(isLoadMore,selectedItem) {
            var _this = this;
            var loaderDiv = document.querySelector('.progress');
            if(isLoadMore){
                this.pastEventOffset += this.pastEventLimit;
            }else{
                this.pastEventOffset = 0;
            }
            var searchPath = document.getElementById("searchPath").value;
            var url = '/services/tcs/eventListing?searchIn='+searchPath+'&offset='+this.pastEventOffset+'&limit='+this.pastEventLimit+'&month='+selectedItem+'&eventType=pastEvents';
            fetch(url,{
                method: 'GET',
                credentials: 'include'
            }).then(function (response) {
                // if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                //     loaderDiv.classList.add('hide');
                // }
                if (response.status === 200) {
                    response.json().then(function (data) {
                        _this.pastEvents = JSON.parse(data.search_result).commonSearchResultList;
                        _this.totalPastEventCount = JSON.parse(data.search_result).totalMatch
                        _this.listPastEvents(isLoadMore);
                        if(_this.pastEventOffset+_this.pastEventLimit>=_this.totalPastEventCount){
							_this.loadMorePastEvent.classList.add('hide');
                        }else{
							_this.loadMorePastEvent.classList.remove('hide');	
                        }
                        /*_this.createNavBtnsForEvents();
                        _this.addChangeToDropDownFilter()*/
                    });
                }
            }).catch(function (error) {
                //console.log(error);
            });
        }
        // List all events getting from the server
        function listEvents() {
            var _this = this;
            this.eventList.innerHTML = '';
            var events = this.isFilterApplied ? this.filteredEvents : this.events;
            events.forEach(function(item, index, list) {
                if (index >= _this.startIndex && index < _this.endIndex) {
                    var listItemText = _this.createEventListDOM(item);
                    _this.eventList.insertAdjacentHTML('beforeend', listItemText);
                } else {
                    return false;
                }
            });
        }
		   function listPastEvents(isLoadMore) {
            var _this = this;
            var pastEventList = document.querySelector('.past-event-list');
            if (typeof (isLoadMore) === 'undefined' || !isLoadMore) {
                pastEventList.innerHTML = '';
            }
            /*var events = this.isFilterApplied ? this.filteredEvents : this.events;*/
            this.pastEvents.forEach(function (item, index, list) {
                if (index >= _this.startIndex && index < _this.endIndex) {
                    var listItemText = _this.createEventListDOM(item);
                    pastEventList.insertAdjacentHTML('beforeend', listItemText);
                } else {
                    return false;
                }
            });
        }
        // Create appropriate number of nav buttons according to the events from the server
        function createNavBtnsForEvents() {
            var numberOfNavBtns = Math.ceil((this.isFilterApplied ? this.filteredEvents.length : this.events.length) / this.itemsShownInPage);
            this.navBtnControlsList.innerHTML = '';
            if (numberOfNavBtns === 1) {
                return false;
            }
            for (var navBtnIndex = 0; navBtnIndex < numberOfNavBtns; navBtnIndex++) {
                if (navBtnIndex === 0) {
                    this.injectNavBtnListItem(navBtnIndex, true);
                } else {
                    this.injectNavBtnListItem(navBtnIndex, false);
                }
            }
            this.addClickEventToNavBtns();
        }
        // Create nav btn template
        function injectNavBtnListItem(index, isActive) {
            var navBtnSelectedCls = '';
            if (isActive) {
                navBtnSelectedCls = 'nav-selected';
            }
            var navBtnTemplateInner = '<a class="panel-nav-link ' + navBtnSelectedCls + '" data-card-nav-index="' + (index + 1) + '"></a>';
            var navBtnTemplate = document.createElement('li');
            navBtnTemplate.classList.add('panel-nav-but');
            navBtnTemplate.innerHTML = navBtnTemplateInner;
            this.navBtnControlsList.appendChild(navBtnTemplate);
        }
        // Create template for list item of event
        function createEventListDOM(event) {
            var listItemText = '<li class="event-item clearfix event-adding animation-delay-4">';
            listItemText += '<a class="event-img fl" href="'+event.pagePath+'" style="background-image : url(' + event.imagePath + ')">';
            listItemText += '<span href="" class="event-img-title event-img-title-head text-style-10">';
            listItemText += event.eventStartDate;
            listItemText += '</span>';
            listItemText += '<div class="event-img-title  event-img-location text-style-10">';
            listItemText += event.eventLocation;
            listItemText += '</div>';
            listItemText += '<div class="gradient-bg green-blue">';
            listItemText += '</div>';
            listItemText += '</a>';
            listItemText += '<div class="event-info">';
            listItemText += '<a href="'+event.pagePath+'" class="event-title text-style-9">';
            listItemText += event.eventName;
            listItemText += '</a>';
            listItemText += '<p class="event-description text-style-39">';
            listItemText += event.subDescription;
            listItemText += '</p>';
            listItemText += '</div>';
            listItemText += '</li>';
            return listItemText;
        }
		//View past event overlay 
        function showPastEvents() {
            var _this = this;
            var pastEventDDContainer = document.querySelector('.past-event-dropdown .dropdown');
            var pastEventsDropdown = new def.DropDown(pastEventDDContainer);
            var itemSelected = pastEventDDContainer.querySelector('.dropdown-item.selected');
            var itemSelectedValue = itemSelected.dataset.item;
            this.fetchPastEvents(false, itemSelectedValue);
            pastEventsDropdown.subscribe('onItemChange', function () {
                itemSelected = pastEventDDContainer.querySelector('.dropdown-item.selected');
                itemSelectedValue = itemSelected.dataset.item;
                obj.eventList.fetchPastEvents(false, itemSelectedValue);

            });
            this.loadMorePastEvent = document.querySelector('#view-more-pastevent');
            if(this.loadMorePastEvent){
                this.loadMorePastEvent.addEventListener("click", function () {
                _this.fetchPastEvents(true, itemSelectedValue);
            })
            }


        }
        // Change Active nav button according to click event
        function changeActiveNavBtn(e) {
            var index = Number(e.target.getAttribute('data-card-nav-index'));
            var activeNav = this.eventListWrapper.querySelector('.pagination a.nav-selected');
            if (Number(activeNav.getAttribute('data-card-nav-index')) === index) {
                return false;
            }
            activeNav.classList.remove('nav-selected');
            this.eventListWrapper.querySelector('a[data-card-nav-index="' + index + '"]').classList.add('nav-selected');
            this.startIndex = (index - 1) * 3;
            this.endIndex = (index * 3);
            this.listEvents();
        }
        // filter listed events
        function filterEvents(filterText) {
            if (filterText === 'All Locations') {
                this.isFilterApplied = false;
            } else {
                this.isFilterApplied = true;
            }

            this.filteredEvents = this.events.filter(function(item) {
                if (item.place === filterText) {
                    return item;
                }
            });
            this.startIndex = 0;
            this.endIndex = this.startIndex + this.itemsShownInPage;
            this.listEvents();
            this.createNavBtnsForEvents();
        }

    } // End of EventList constructor


    // Bind def to the global window
    window.def.EventList = EventList;

})();
(function() {
    'use strict';
    (function(d, s, id) {
        var js;
        var fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {
            return;
        }
        js = d.createElement(s);
        js.id = id;
        js.src = 'https://connect.facebook.net/en_US/sdk.js';
        js.setAttribute('defer', 'defer');

        if (fjs && fjs.parentNode) {
            window.fbAsyncInit = function() {
                FB.init({
                    appId: '1882588655290723',
                    xfbml: 1,
                    version: 'v3.2',
                    autoLogAppEvents:1
                });
                FB.AppEvents.logPageView();
            };
            d.body.appendChild(js);
        }
    }(document, 'script', 'facebook-jssdk'));
    
    var fbShareBtn = document.getElementById('fb-share');
    if (fbShareBtn) {
        fbShareBtn.onclick = function() {
            var sanitizedUrl = utils.getSanitizedURL();
            FB.ui({
                method: 'share',
                href: sanitizedUrl
            }, function(response) {});
        };
        fbShareBtn.addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
            }, false);
        
    }

    var btnTweet = document.getElementById('tw-tweet');

    if (btnTweet) {
        btnTweet.onclick = function() {
            var width = 575;
            var height = 400;
            var left = window.innerWidth / 2;
            var top = window.innerHeight / 2;
            var sanitizedUrl = utils.getSanitizedURL();
            var url = 'https://twitter.com/intent/tweet?url=' + sanitizedUrl;
            var params = 'width=' + width +
                ',height=' + height +
                ',top=' + top +
                ',left=' + left;

            window.open(url, '', params);
        };
        btnTweet.addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
                }, false);
    }

   /* var btnGplus = document.getElementById('gplus-share')
    if (btnGplus) {
        btnGplus.onclick = function() {
            var width = 575;
            var height = 400;
            var left = window.innerWidth / 2;
            var top = window.innerHeight / 2;
            var sanitizedUrl = utils.getSanitizedURL();
            var url = 'https://plus.google.com/share?url=' + sanitizedUrl;
            var params = 'width=' + width +
                ',height=' + height +
                ',top=' + top +
                ',left=' + left;

            window.open(url, '', params);
        };
        btnGplus.addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
                 }, false);   
    }*/

    var btnLinkedIn = document.getElementById('linkedin-share');
    if (btnLinkedIn) {
        btnLinkedIn.onclick = function() {
            var width = 575;
            var height = 400;
            var left = window.innerWidth / 2;
            var top = window.innerHeight / 2;
            var sanitizedUrl = utils.getSanitizedURL();
            var url = 'https://www.linkedin.com/shareArticle?mini=true&url=' + sanitizedUrl;
            var params = 'width=' + width +
                ',height=' + height +
                ',top=' + top +
                ',left=' + left;

            window.open(url, '', params);
        };
        btnLinkedIn.addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
                }, false);
    }

    var btnMailTo = document.getElementById('mail-to');
    if (btnMailTo) {
        btnMailTo.onclick = function() {
            var sanitizedUrl = utils.getSanitizedURL();
            var subjectContent = document.getElementsByClassName('hero-main-message');
            if (subjectContent.length) {
                window.location.href = 'mailto:?subject=' + encodeURI(subjectContent[0].textContent) + '&body=' + sanitizedUrl;
            } else {
                window.location.href = 'mailto:?body=' + sanitizedUrl;
            }
        };
        btnMailTo.addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
                }, false);
    }

    var tweetIcon = document.getElementsByClassName('share-in-twitter');
    if (tweetIcon) {
        for (var i = 0; i < tweetIcon.length; i++) {
            tweetIcon[i].onclick = function(e) {
                var sanitizedUrl = utils.getSanitizedURL();
                var width = 575;
                var height = 400;
                var left = window.innerWidth / 2;
                var top = window.innerHeight / 2;
                var tweetContent = e.target.innerHTML;
                var url;
                if (tweetContent.length) {
                    url = 'https://twitter.com/intent/tweet?text=' + encodeURI(tweetContent) + '&url=' + sanitizedUrl;
                } else {
                    url = 'https://twitter.com/intent/tweet?url=' + sanitizedUrl;
                }
                var params = 'width=' + width +
                    ',height=' + height +
                    ',top=' + top +
                    ',left=' + left;

                window.open(url, '', params);
            };
            tweetIcon[i].addEventListener('keydown', function(event) {
                     if (event.which == 32 || event.which == 13)
                     this.click();
                }, false);
        }
    }
	
	var copyIcon = document.querySelectorAll('.copy-content-icon');
    var toolTip;
    var clickedLink;
    if (copyIcon) {
        for (var i = 0; i < copyIcon.length; i++) {
            copyIcon[i].addEventListener('click', function(event) {
                clickedLink = event.target.parentElement.getAttribute('data-id');
                navigator.clipboard.writeText(clickedLink);
                toolTip = document.querySelector('.copy-link-text');
                //Add custom message here
                toolTip.innerHTML = "Copied link";
            }, false);

            copyIcon[i].addEventListener('mouseout', function(event) {
                toolTip = document.querySelector('.copy-link-text');
                //Add custom message here
                toolTip.innerHTML = "Copy to clipboard";
            }, false);
         }
    }

	

})();

(function() {
    def.SocialSignInSection = function(socialElement) {
        this.name = "SocialSignInSection";
        this.socialSignInButton;
        this.inputElements = document.getElementsByClassName('required-field');
        this.checkboxes = document.querySelectorAll('.checkbox');
        this.socialSignInForm;
        this.socialElement = socialElement;
        this.addEvents();
    };
    var p = def.SocialSignInSection.prototype;
    def.SocialSignInSection.prototype.constructor = def.SocialSignInSection;

    p.addEvents = function() {
        var _this = this;
        for (var i = 0; i < _this.getInputElements().length; i++) {
            var element = _this.inputElements[i];
            element.addEventListener('keyup', _this.checkInput.bind(_this));
            element.addEventListener('blur', _this.checkRequired.bind(_this));
            element.addEventListener('change', _this.checkInput.bind(_this));
            element.addEventListener('change', _this.checkRequired.bind(_this));

        }
        for (var i = 0; i < _this.checkboxes.length; i++) {
            _this.checkboxes[i].addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13)
                    var elem = this.querySelector('input');
                    if (elem) {
                        elem.click();
                    }
            }, false);
        }
        this.getSocialSignInButton().addEventListener('click', _this.onSocialFormSubmit.bind(this));
        this.getSocialSignInForm().addEventListener('submit', _this.onSocialFormSubmit.bind(this));
    };

    p.checkRequired = function(event) {
        var field = event.currentTarget;
        if (field.getAttribute('required') == "true" && !field.value) {
            field.parentNode.querySelector('.required').classList.add('show');
        } else {
            field.parentNode.querySelector('.required').classList.remove('show');
        }
    }
    p.checkInput = function() {
        var flag = true;
        for (var i = 0;
            (i < this.getInputElements().length && flag === true); i++) {
            if (this.inputElements[i].getAttribute('required') == "true" && !this.inputElements[i].value) {
                flag = false;
            }
        }
        if (flag) {
            this.getSocialSignInButton().classList.remove('disabled');
        } else {
            this.getSocialSignInButton().classList.add('disabled');
        }
    };

    p.getInputElements = function() {
        return this.inputElements || (this.inputElements = this.socialElement.querySelectorAll('.text-box'));
    };

    p.getSocialSignInButton = function() {
        return this.socialSignInButton || (this.socialSignInButton = this.socialElement.querySelector('.social-sign-in-button'));

    };

    p.getSocialSignInForm = function() {
        return this.socialSignInForm || (this.socialSignInForm = this.socialElement.querySelector('[name = "download-pdf-form"]'));
    };

    p.validateField = function(field) {
        var validField = true;
        switch (field.getAttribute('validattype')) {
            case "name":
                validField = true;
                break;
            case "email":
                validField = this.validateEmail(field.value, field);
                break;
            case "phone":
                validField = true;
                break;
            default:
                break;
        }
        return validField;
    };


    p.validateEmail = function(mail, emailField) {
        if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(mail)) {
            emailField.classList.remove('error');
            emailField.parentNode.querySelector('.syntax').classList.remove('show');
            var invalidDomains = ["@gmail.", "@yahoo.", "@hotmail.", "@live.", "@aol.", "@outlook."];
            var validDomain = true;
            for(var i=0; i < invalidDomains.length; i++) {
               var domain = invalidDomains[i];
               if (mail.indexOf(domain) != -1) {
                   validDomain = false;
               }
            }
            if (!validDomain){
                    emailField.classList.add('error');
                    emailField.parentNode.querySelector('.invalid-domain').classList.add('show');
                    return false;
            }else {
                   emailField.classList.remove('error');
                   emailField.parentNode.querySelector('.invalid-domain').classList.remove('show');
                    return true;
            }
        } else {
            emailField.classList.add('error');
            emailField.parentNode.querySelector('.syntax').classList.add('show');
            return false;
        }
    };

    p.onSocialFormSubmit = function() {
        var validFlag = true;
        if (this.socialSignInButton.classList.contains('disabled')) {
            return;
        } else {
            for (var i = 0; i < this.getInputElements().length; i++) {
                var flag = this.validateField(this.inputElements[i]);
                if (!flag) {
                    validFlag = false;
                }
            }
        }
        if (validFlag) {
            this.downloadPdf();
        } else {
            this.removeDownload();
        }


    };

    p.downloadPdf = function() {

        var downloadName = this.socialElement.querySelector('#download_button').getAttribute('data-download');
        var downloadLink = this.socialElement.querySelector('#download_button').getAttribute('data-href');

        this.socialElement.querySelector('#download_button').download = downloadName;
        this.socialElement.querySelector('#download_button').href = downloadLink;
    };
    p.removeDownload = function() {
        this.socialElement.querySelector('#download_button').removeAttribute("href");
        this.socialElement.querySelector('#download_button').removeAttribute("download");
    }
})();

(function (){
    var invalidDomains = ["@gmail.","@yahoo.","@hotmail.","@live.","@aol.","@outlook."];

        if(typeof(MktoForms2) !== 'undefined'){
            MktoForms2.whenReady(function (form){
                    form.addHiddenFields({
                    ReferringSite : document.referrer
                    });
                    form.onValidate(function(){
                    var email = form.vals().Email;
                    if(email){
                        if(!isEmailGood(email)) {
                            form.submitable(false);
                            var emailElem = form.getFormElem().find("#Email");
                            form.showErrorMessage("Please use your business email. Thank you!", emailElem);
                             form.submitable(false);
                        }else{
                            form.submitable(true);
                        }
                    }
                    });

                });
        }

        function isEmailGood(email) {
            for(var i=0; i < invalidDomains.length; i++) {
            var domain = invalidDomains[i];
            if (email.indexOf(domain) != -1) {
                return false;
            }
            }
            return true;
        }

	})();
(function() {
    'use strict';

    function addSliders() {
        var container = document.querySelectorAll('.three-cards');
        for (var i = 0; i < container.length; i++){
            var config = {
                cardListContainerWrapper: container[i],
                cardListContainer: container[i].querySelector('.three-card-wrapper'),
                cards: container[i].querySelectorAll('.global-card'),
                navButtons: container[i].querySelectorAll('.card-collection-nav-link'),
                navArrowButtons: [],
                cardViewCount: utils.getCardViewCount(),
                gutterWidth: 25
            };
            if (utils.isMobile || utils.isTablet) {
                new window.def.Slider(config);
                container[i].querySelector('.three-card-wrapper').style.width += 3;
            }
        }


    }
    addSliders();
})();
document.addEventListener('DOMContentLoaded', function() {

    var tweetTemplate = '';
    var isInitialPageLoad = true;

    /* Sample Payload  : All social media cards */

    var tweets = [],
        tweetsCount, containerLength, bufferLength = 6,
        totalCardLength, tweetIndex = 0,
        timestamp, serviceResponseNull = 0;
    var loadMoreTweets = document.getElementById("load-more-tweets");
    var loaderDiv = document.querySelector('.progress');
    var multiSelectDDElm = window.document.querySelector('.twitter-card .multiselect-dropdown');
    if (typeof(multiSelectDDElm) !== 'undefined' && multiSelectDDElm !== null) {
        var multiSelectDrpDwnObj = new def.multiSelectDropDown(multiSelectDDElm);
        multiSelectDrpDwnObj.subscribe('onDDClose', function() {
            var resultTags = multiSelectDrpDwnObj.getSelectedItems();
            resultTags = resultTags.join("-");
            tweets = [];
            tweetsCount = 0;
            containerLength = 0;
            totalCardLength = 0;
            serviceResponseNull = 0;
            tweetIndex = 0;
            loadMoreTweets.style.display = "";
            if (document.querySelector(".twittercard-container")) {
              document.querySelector(".twittercard-container").innerHTML = '<div class="col s12 m12 l4  twitter-cards-align column-1"></div><div class="col s12 m12 l4  twitter-cards-align column-2"></div><div class="col s12 m12 l4  twitter-cards-align column-3"></div>';            }
            loadSocialCards(true, resultTags);
        });
    }

    function loadSocialCards(flag, filter) {
        var url = null;
        var resultTags = null;
       if (typeof(filter) === 'undefined') {
            resultTags = multiSelectDrpDwnObj.getSelectedItems();
            resultTags = resultTags.join("-");
            url = '/services/tcs/socialdata?filter=' + resultTags + '&page=' + 1;
        } else if (filter.trim() === "") {
            return false;
        } else {
            url = '/services/tcs/socialdata?filter=' + filter + '&page=' + 1;
        }

        if (timestamp && !flag && typeof(filter) === 'undefined') {
            url = '/services/tcs/socialdata?filter=' + resultTags + '&page=' + 1 + '&timestamp=' + timestamp;
        } else if (timestamp && !flag) {
            url = '/services/tcs/socialdata?filter=' + filter + '&page=' + 1 + '&timestamp=' + timestamp;
        }
        if (loaderDiv && loaderDiv.classList.contains('hide') && !isInitialPageLoad) {
             loaderDiv.classList.remove('hide');
         }
        isInitialPageLoad = false;
        window.fetch(url, {
             method: 'GET',
			credentials: 'include'
             })
            .then(function(response) {
				if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                    loaderDiv.classList.add('hide');
                }
                return response.json();
            })
            .then(function(cards) {
				if(cards.response.cards.length == 0){
					serviceResponseNull = 1;
				}
                
                cards.response.cards.forEach(function(item) {
                    tweets.push(item);
                })
                totalCardLength = cards.response.total;
                tweetsCount = 3;
                containerLength = 3;
                cards.response.timestamp ? timestamp = cards.response.timestamp : timestamp = null;
                if (flag) {
                    init();
                }
            });


    }
    var successCallback = function() {
        /* tweetTemplate = response;*/
        addTweets();
    };

    var init = function() {
        successCallback();
    }

    var addTweets = function(pageIndex) {
        var eventItemHtml = '';

        var itemIndex = 0;
        var col1Height = 0;
        var col2Height = 0;
        var col3Height = 0;
        var paddingToCards = 224;
        var column1_container = document.querySelectorAll('.column-1 .card-item');
        var column2_container = document.querySelectorAll('.column-2 .card-item');
        var column3_container = document.querySelectorAll('.column-3 .card-item');
        var offsetToCards = document.querySelector('.twittercard-container').offsetParent;
        loadMoreTweets.style.display = "inline-block";
        while (itemIndex < tweetsCount) {

            if (tweetIndex + itemIndex >= tweets.length) {
                if (loadMoreTweets) {
                    loadMoreTweets.style.display = "none";
                } else {
                    loadMoreTweets.style.display = "block";
                }
                itemIndex = tweetsCount;
                break;
            }
            var tweetDetails = tweets[tweetIndex + itemIndex];
            var twitterFooterIcon = "";
            var tweetLink = tweetDetails['link'];

            switch (tweetDetails["type"]) {
                case "googleplus":
                    {
                        twitterFooterIcon = "icon-ic_googleplus_footer_selected";
                        break;
                    }
                case "youtube":
                    {
                        twitterFooterIcon = "icon-ic_youtube_footer_selected";
                        break;
                    }
                case "facebook":
                    {
                        twitterFooterIcon = "icon-ic_fb_footer_selected";
                        break;
                    }
                case "twitter":
                    {
                        twitterFooterIcon = "icon-ic_twitter_footer_selected";
                        break;
                    }
                case "instagram":
                    {
                        twitterFooterIcon = "icon-ic_instagram_footer_selected";
                        break;
                    }
                case "linkedin":
                	{
                		twitterFooterIcon = "icon-ic_linkedin_footer_selected";
                		break;
                	}    

                default:
                    {
                        break;
                    }
            }
           
            var templateDiv = document.createElement('div');
            templateDiv.innerHTML = '<div class="card-item outline-none"  tabindex="0" data-href="' + tweetLink + '"><div class="card twitter-card box-shadow hover-effect cursor-pointer"><div class="card-image img-fallback"><picture><source srcset=""><img data-object-fit="contain" class="image" src="" alt="Feed Image" onerror="this.style.display=\'none\'"></picture><iframe src="" class="video-view" frameborder="0" allowfullscreen style="height:100%;width:100%;display:none;"></iframe></div><div class="card-content"><div class="text-Style-38 title-text-padding"><span class="title-text"></span><hr class="title-line"></div><p class="card-content-description"></p></div><div class="tweet-duration"><div class="twitter-icon-container"><i class="twitter-icon ' + twitterFooterIcon + '"></i><span class="text-Style-40 tweet-time"></span></div></div></div></div>';
            var tweetTitle = templateDiv.querySelector('.title-text');
            var tweetDescription = templateDiv.querySelector('.card-content-description');
            var tweetTime = templateDiv.querySelector('.tweet-time');
            var tweetCard = templateDiv.querySelector('.card');
            var imgWrapContainer = templateDiv.querySelector('.card-image');
            var image = templateDiv.querySelector('img.image');
            var video = templateDiv.querySelector('iframe.video-view');
            tweetDescription.innerHTML = tweetDetails['details'];
            tweetTime.innerHTML = tweetDetails['time'];
            tweetTitle.innerHTML = tweetDetails['title'];
            if (tweetDetails.media && tweetDetails.media.url) {
                if (tweetDetails.media.type === "image") {
                    if (!Modernizr.objectfit) {
                        imgWrapContainer.style.display = "block";
                        imgWrapContainer.style.backgroundImage = "url(" + tweetDetails.media.url + ")";
                        imgWrapContainer.style.backgroundPosition = "center center";
                        imgWrapContainer.style.backgroundRepeat = "no-repeat";
                        imgWrapContainer.style.backgroundSize = image.getAttribute('data-object-fit');
                    } else {
                        image.src = tweetDetails.media.url;
						templateDiv.querySelector('source').srcset = tweetDetails.media.url;
                    }
                    

                } else if (tweetDetails.media.type === "video") {
                    video.src = tweetDetails.media.url;
                    video.style.display = "block";
                }
            } else {
                templateDiv.querySelector('.card-image').style.display = 'none';
            }


            addToContainer(templateDiv.innerHTML, itemIndex);
            itemIndex++;
        }

        //Get offset height of each column
        column1_container.forEach(function(item) {
            col1Height += item.offsetHeight;
        });

        column2_container.forEach(function(item) {
            col2Height += item.offsetHeight;
        });

        column3_container.forEach(function(item) {
            col3Height += item.offsetHeight;
        });

        var compareHeight = [col1Height, col2Height, col3Height];
        var positionToCards = Math.min.apply(null, compareHeight);

        //Scroll to newly appended position
        if (column1_container.length > 0) {
            var scrollTo;
            if (window.innerWidth < 993) {
                scrollTo = offsetToCards.offsetTop + col1Height;
            } else {
                scrollTo = offsetToCards.offsetTop + positionToCards + paddingToCards;
            }
            window.scrollTo(0, scrollTo);
        }

        document.querySelectorAll(".card-item").forEach(function(item) {
          item.addEventListener("click", cardItemClickHandler,false);
            item.addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13)
                    item.click();
            }, false);
        })
        tweetIndex = tweetIndex + itemIndex;

        document.querySelectorAll('.card-content-description a').forEach(function(item) {
                item.addEventListener("click",function(event) {
                    event.stopPropagation();
                });
       });
       document.querySelectorAll('.card-content-description a.ot-anchor').forEach(function(item){
            item.setAttribute('target', '_blank');
               });
    };

    var cardItemClickHandler = function() {
        window.open(this.getAttribute("data-href"), '_blank');
    }


    var addToContainer = function(templateDiv, itemIndex) {
        var container;
        if (window.innerWidth < 993) {
            container = document.getElementsByClassName('column-1')[0];
        } else {
            container = document.getElementsByClassName('column-' + ((itemIndex % containerLength) + 1))[0];
        }
        if (totalCardLength > 1 && totalCardLength <= 3) {
            container.classList.add("twitter-more-card");
        }
        if (totalCardLength < 3) {
            container.classList.add("twitter-card-clear");
            if (totalCardLength == 2 && !container.parentElement.classList.contains("twittercard-display-container")) {
                container.parentElement.classList.add("twittercard-display-container");
            }
        } else {
            if (container.parentElement.classList.contains("twittercard-display-container")) {
                container.parentElement.classList.remove("twittercard-display-container");
            }
        }

        container.insertAdjacentHTML('beforeend', templateDiv);
    };


    try {
        if (loadMoreTweets) {
            loadMoreTweets.addEventListener("click", function(event) {
                // if(!utils.isMobile){

                addTweets();
                // }
                if (totalCardLength > (tweetIndex + 1) && (bufferLength + tweetIndex >= tweets.length) && (serviceResponseNull == 0)) {
                    loadSocialCards(false);
                } else if (totalCardLength < (tweetIndex + 1)) {
                    loadMoreTweets.style.display = "none";

                }
                event.preventDefault();
            });
        }
        loadSocialCards(true);
    } catch (e) { }
}, false);

document.addEventListener('DOMContentLoaded', function() {

    var tweetTemplate = '';
	var isInitialPageLoad = true;
	var aiFlag = false;
	   if(document.getElementById('aiFlag')){
     	aiFlag = document.getElementById("aiFlag").innerHTML;    
    }
    /* Sample Payload  : All related contents cards */

    var tweets = [],
        relatedContentCount, containerLength, bufferLength = 3,
        totalCardLength, tweetIndex = 0,
        timestamp;
      var loaderDiv = document.querySelector('.progress');
    var loadMoreRelatedContents = document.getElementById("load-more-related-contents");

    var multiSelectDDElmq = window.document.querySelector('.related-content .multiselect-dropdown');

    var multiSelectDrpDwnObjData = new def.multiSelectDropDown(multiSelectDDElmq);

    if (typeof(multiSelectDrpDwnObjData) !== 'undefined') {
        if (typeof(multiSelectDrpDwnObjData.subscribe) !== 'undefined') {
            multiSelectDrpDwnObjData.subscribe('onDDClose', function() {
                var resultTags = multiSelectDrpDwnObjData.getSelectedItems();
                resultTags = resultTags.join("-");
                tweets = [];
                tweetsCount = 0;
                containerLength = 0;
                totalCardLength = 0;
                tweetIndex = 0;
                loadMoreRelatedContents.style.display = "";
                if (document.querySelector(".twittercard-container ")) {
                    document.querySelector(".twittercard-container").innerHTML = '<div class="col s12 m12 l4 twitter-cards-align column-1"></div><div class="col s12 m12 l4 twitter-cards-align column-2"></div><div class="col s12 m12 l4 twitter-cards-align column-3"></div>';
                }

                loadRelatedContents(resultTags);
            });
        }
    }



    function loadRelatedContents(filter) {

        if (typeof(filter) !== 'undefined') {
            filter = 'All';
        }
        // filter = "All"///
        var limit = document.querySelector("#related-content-limit").value;
         if(limit == "") {
			limit = 3;
        } else if(limit == 6){
			limit = 6;
        } else if(limit == 3) {
			limit = 3;
        } else {
			limit = 3;
        }

        var currentPagePath = document.querySelector("#currentPagePath").value;
        var searchIn = document.querySelector("#related-content-search-path").value;
        var offset = tweetIndex;
        var resultTags = multiSelectDrpDwnObjData.getSelectedItemsAttr();
        if(typeof(resultTags)!= 'undefined'){
        for (var i = 0;  i < resultTags.length; i++) {
            resultTags[i] = "tagId=" + resultTags[i];
        }
    }
        resultTags = resultTags.join("&");
        if(resultTags == "" || resultTags == undefined ){
        	url = '/services/tcs/relatedContent?' + 'offset=' + offset + '&limit=' + limit + '&searchIn=' +
            searchIn + '&' + 'pagePath='+currentPagePath+ '&filterSearch=true' ;
        	//if(aiFlag == "true"){
        		//new def.Fingerprint(offset, limit, null, true);
        	//}
        }        		
		else{
			url = '/services/tcs/relatedContent?' + 'offset=' + offset + '&limit=' + limit + '&searchIn=' +
            searchIn + '&' + resultTags + '&pagePath='+currentPagePath;
			if(aiFlag == "true"){
				if(def != null && def.Fingerprint != null){
					new def.Fingerprint(offset, limit, resultTags, null, null, true, false, null);
				}
			}
		}      	  

        // var url = 'js/service/related-contents.json?filter=' + filter + '&page=' + 1;
        var multiSelect = multiSelectDrpDwnObjData;
         if (loaderDiv && loaderDiv.classList.contains('hide') && !isInitialPageLoad) {
           loaderDiv.classList.remove('hide');
        }
        isInitialPageLoad = false;
        window.fetch(url, {
                method: 'GET',
                credentials: 'include'
            })
            .then(function(response) {

		  if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                loaderDiv.classList.add('hide');
            }

            response.json().then(function(tweetArray) {
                var cardsJson = JSON.parse(tweetArray.search_result);
                var searchTagJson =cardsJson.searchTags;
                if (!multiSelect.contents.classList.contains('list-populated')) {
                    multiSelect.createListItems(searchTagJson);
                    multiSelect.contents.classList.add('list-populated');
                }

                cardsJson.commonSearchResultList.forEach(function(item) {
                    tweets.push(item);
                })
                totalCardLength = cardsJson.totalMatch;
                var totalMatch = cardsJson.totalMatch;
                containerLength = 3;
                addRelatedContent(tweetIndex, bufferLength);
                if(tweetIndex >= totalMatch) {
					loadMoreRelatedContents.style.display = "none";
                }
            });
        });



    }
    var successCallback = function() {
        // addRelatedContent();
    };

    var init = function() {
        successCallback();
    }
     var getTemplateDiv = function(pageLink, isExternal) {
        var template = '';
        if (isExternal == 'true') {
            template += '<a class="card-item outline-none" href="' + pageLink + '" target="_blank" rel="noopener noreferrer" tabindex="0"> ';
        } else {
            template += '<a class="card-item outline-none" href="' + pageLink + '" target="_self" tabindex="0"> ';
        }
        template +=
            '<div class="card twitter-card box-shadow hover-effect cursor-pointer">' +
            '<div class="card-image img-fallback"><picture><source srcset="">' +
            '<img data-object-fit="cover" class="image" src="" alt="Feed Image" onerror="this.style.display=\'none\'">' +
            '</picture></div> ' +
            '<div class="card-content"><div class="text-Style-38 title-text-padding"><span class="title-text"></span><hr class="title-line"></div>' +
            '<p class="card-content-description"></p></div>' +
            '<div class="tweet-duration"><div class="twitter-icon-container"><i class="twitter-icon ">f</i><span class="text-Style-40 tweet-time"></span></div></div></div></a>';
        return template;
    }
    var addRelatedContent = function(activeIndex, relatedContentCount) {
        var eventItemHtml = '';
        var cardType = multiSelectDrpDwnObjData.cardType;
        var itemIndex = 0;
        var col1Height = 0;
        var col2Height = 0;
        var col3Height = 0;
        var paddingToCards = 224;
        var column1_container = document.querySelectorAll('.column-1 .twitter-card');
        var column2_container = document.querySelectorAll('.column-2 .twitter-card');
        var column3_container = document.querySelectorAll('.column-3 .twitter-card');
        var offsetToCards = document.querySelector('.twittercard-container').offsetParent;
         loadMoreRelatedContents.style.display = "inline-block";

       while (itemIndex < relatedContentCount) {
			if(itemIndex >= tweets.length)
                break;
			while (itemIndex < bufferLength && tweetIndex < totalCardLength) {
            var tweetDetails = tweets[itemIndex];

            var pageLink = tweetDetails['pagePath'];
			 var isExternal = tweetDetails['isExternal'];
            var templateDiv = document.createElement('div');
            templateDiv.innerHTML = getTemplateDiv(pageLink, isExternal);
            window.objectFitObj.init();
            var tweetTitle = templateDiv.querySelector('.title-text');
            var tweetDescription = templateDiv.querySelector('.card-content-description');
            var image = templateDiv.querySelector('img.image');

            tweetDescription.innerHTML = tweetDetails['subDescription'];
            tweetTitle.innerHTML = tweetDetails['description'];

            if (tweetDetails.imagePath) {
                image.src = tweetDetails.imagePath;
                templateDiv.querySelector('source').srcset = tweetDetails.imagePath

            } else {
                templateDiv.querySelector('.card-image').style.display = 'none';
            }

            if(tweetDetails['isRelatedContent']=='true'){
				tweetDescription.innerHTML = tweetDetails['relatedCardDescription'];
            	tweetTitle.innerHTML = tweetDetails['relatedCardTitle'];
                if(tweetDetails['relatedCardImage']){
					templateDiv.querySelector('.card-image').style.display = 'block';
					image.src = tweetDetails.relatedCardImage;
                	templateDiv.querySelector('source').srcset = tweetDetails.relatedCardImage +'/jcr:content/renditions/tcs_1x.jpeg'+ ' 1x' +', '+tweetDetails.relatedCardImage+ ' 2x';
                }else{
					templateDiv.querySelector('.card-image').style.display = 'none';
                }
            }

            addToContainer(templateDiv.innerHTML, itemIndex);
            itemIndex++;
            tweetIndex++;
        }
	   }

        //Get offset height of each column
        column1_container.forEach(function(item) {
            col1Height += item.offsetHeight;
        });

        column2_container.forEach(function(item) {
            col2Height += item.offsetHeight;
        });

        column3_container.forEach(function(item) {
            col3Height += item.offsetHeight;
        });

        var compareHeight = [col1Height, col2Height, col3Height];
        var positionToCards = Math.min.apply(null, compareHeight);

        //Scroll to newly appended position
        if (column1_container.length > 0) {
            var scrollTo;
            if (window.innerWidth < 993) {
                scrollTo = offsetToCards.offsetTop + col1Height;
            } else {
                scrollTo = offsetToCards.offsetTop + positionToCards + paddingToCards;
            }
            window.scrollTo(0, scrollTo);
        }

        document.querySelectorAll(".card-item").forEach(function(item) {

            item.addEventListener('keydown', function(event) {
                if (event.which === 32 || event.which === 13)
                    item.click();
            }, false);
        })
        activeIndex = activeIndex + itemIndex;
    };
    // End of add
    var addToContainer = function(templateDiv, itemIndex) {
        var container;
         if (window.innerWidth < 993) {
              container = document.getElementsByClassName('column-1')[0];
             } else {
              container = document.getElementsByClassName('column-' + ((itemIndex % containerLength) + 1))[0];
             }

        if (totalCardLength < 3) {
            container.classList.add("twitter-card-clear");
        }
        
         if (totalCardLength == 2) {
                  //container.style.display = "block";
            setTimeout(function(){   container.classList.add("twitter-more-card"); }, 50);
			document.querySelector(".twittercard-container .column-3").classList.add("hide");
                  //container.style.display = "inli";
        } else {
            if (container.parentElement.classList.contains("twittercard-display-container")) {
                container.parentElement.classList.remove("twittercard-display-container");
            }
        }
        container.insertAdjacentHTML('beforeend', templateDiv);
    };


   try {
        if (loadMoreRelatedContents) {
            loadMoreRelatedContents.addEventListener("click", function() {
                // if(!utils.isMobile){

                //addRelatedContent(tweetIndex, );
                //loadRelatedContents(false);
                // }
                tweets = [];
                if (bufferLength + tweetIndex >= totalCardLength) {
                    loadMoreRelatedContents.style.display = "none";
                } 
                    loadRelatedContents();


            });
        }
        // Initial loading
        loadRelatedContents();
    } catch (e) {}
}, false);

(function () {
    'use strict';

    def.Video = function (element) {
        this.name = 'Video';
        if (!element) {
            return;
        }
        this.elm = element;

        this.videoView = element.querySelector('.video-container .video-view');
        this.videoControl = element.querySelector('.video-container .video-control');
        this.videoControlBar = element.querySelector('.video-container .video-control-bar');
        this.volumeControl = element.querySelector('.video-volume-bar');
        this.videoContent = element.querySelector('.video-container .video-thumbnail-text');
        this.videoPlayhead = element.getElementsByClassName('video-playhead')[0];
        this.videoProgressbar = element.getElementsByClassName('play-progress')[0];
        this.videoProgressbuffer = element.getElementsByClassName('play-buffer')[0];
        this.videoTimeLine = element.getElementsByClassName('video-timeline')[0];
        this.videoVolumeProgressbar = element.getElementsByClassName('volume-progress')[0];
        this.videoVolumePlayhead = element.getElementsByClassName('video-volume-playhead')[0];
        this.videoVolumeTimeLine = element.getElementsByClassName('video-volume-timeline')[0];
        this.videoVolumeWrapper = element.getElementsByClassName('video-volume-wrapper')[0];
        this.videoCurrentTime = element.querySelector('.video-container .video-control-bar .video-progress-bar .video-current-position');
        this.videoDuration = element.querySelector('.video-container .video-control-bar .video-progress-bar .video-full-duration');
        this.timelineWidth = this.videoTimeLine.offsetWidth - this.videoPlayhead.offsetWidth;
        this.fullScreenButton = element.getElementsByClassName('video-full-screen')[0];
        this.muteButton = element.getElementsByClassName('video-volume-button')[0];
        this.heroVideoPlayer = element.parentElement.querySelector('.hero-video-player');
        if (this.heroVideoPlayer) {
            this.videoPlayer = this.heroVideoPlayer.parentElement;
            this.heroVideo = this.videoPlayer.closest('.hero-video');
        }
        this.timerId = 0;
        this.timeoutID;
        this.init();
        this.timerFlag = true;
    };
    var p = def.Video.prototype;
    def.Video.prototype.constructor = def.Video;

    p.init = function () {
        var _this = this;
        if (this.videoView) {
        	eventFunction(this.videoView); //  For video analytics
            this.videoView.addEventListener('loadedmetadata', function () {
                var durationInSeconds = parseInt(_this.videoView.duration, 10); // don't forget the second param
                _this.timeFormat(durationInSeconds,1);
            }, false);
        }

        _this.videoView.volume = .5;
        _this.videoVolumePlayhead.style.left = 50 + '%';
        _this.videoVolumeProgressbar.style.width = 50 + '%';
        this.callPlayPauseVideo();
        this.setup();
     
    };

    p.timeFormat = function (durationInSeconds, flag) {
        var hours = Math.floor(durationInSeconds / 3600);
        var minutes = Math.floor((durationInSeconds - (hours * 3600)) / 60);
        var seconds = durationInSeconds - (hours * 3600) - (minutes * 60);

        if (hours < 10) {
            hours = "0" + hours;
        }
        if (minutes < 10) {
            minutes = "0" + minutes;
        }
        if (seconds < 10) {
            seconds = "0" + seconds;
        }
		if (flag === 1) {
			if (hours === '00') {
					this.videoDuration.innerHTML = minutes + ':' + seconds;	
			} else {
				this.videoDuration.innerHTML = hours + ':' + minutes + ':' + seconds;
			}
		} else {
            if (hours === '00') {
                this.videoCurrentTime.innerHTML = minutes + ':' + seconds;
            } else {
                this.videoCurrentTime.innerHTML = hours + ':' + minutes + ':' + seconds;
            }
        }
    }

    p.setup = function () {
        var _this = this;
        if (this.videoView) {
             this.videoView.addEventListener("mousemove", _this.resetTimer.bind(_this), false);
            // this.videoView.addEventListener("mousedown", _this.resetTimer.bind(_this), false);
            // this.videoView.addEventListener("keypress", _this.resetTimer.bind(_this), false);
            // this.videoView.addEventListener("DOMMouseScroll", _this.resetTimer.bind(_this), false);
            // this.videoView.addEventListener("mousewheel", _this.resetTimer.bind(_this), false);
            // this.videoView.addEventListener("touchmove", _this.resetTimer.bind(_this), false);
            // // this.videoView.addEventListener("MSPointerMove", _this.resetTimer.bind(_this), false);
        }




    }
    p.goActive = function () {
        var _this = this;
        this.startTimer();

        if (_this.videoContent.classList.contains('video-text-hide')) {
            _this.videoControlBar.classList.remove('video-control-hide');
            _this.videoControlBar.classList.add('video-control-show');
            this.videoControl.style.display = 'block';
        }

    }
    p.resetTimer = function(e) {
        var _this = this;
        if (_this.timerFlag == true)
        {
            window.clearTimeout(this.timeoutID);
            this.goActive.bind(_this)();
        } else {
            _this.timerFlag = true;
        }

    }
    p.startTimer = function () {
        var _this = this;
        this.timeoutID = window.setTimeout(_this.goInactive.bind(_this), 4000);
    }
    p.goInactive = function (event) {
        var _this = this;
        if (_this.videoContent.classList.contains('video-text-hide')) {
            this.videoControlBar.classList.add('video-control-hide');
            this.videoControlBar.classList.remove('video-control-show');
            this.videoControl.style.display = 'none';
        }
        _this.timerFlag = false;
    }

    p.clickPercent = function (e) {
        return e.offsetX / this.videoTimeLine.offsetWidth;
    };
    p.volumePercent = function (e) {
        return e.offsetX / this.videoVolumeTimeLine.offsetWidth;
    };
    p.cancelFullScreen = function (event) {
        if (event.keyCode == 27) {
            this.fullScreenExit();
        }
    }
    p.fullScreenExit = function () {
        var _this = this;
       
        this.fullScreenButton.classList.add('video-full-screen');
        _this.fullScreenButton.classList.remove('video-collapse-screen');
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        }
        if (_this.elm.parentNode.classList.contains('outer-video-container')) {
            _this.elm.parentNode.classList.add('video-small');
        }
    }
    p.callPlayPauseVideo = function () {
        var _this = this;

        // this.elm.addEventListener('mouseover', function () {
        //     _this.videoControl.style.display = 'block';
        // }, false);
        // this.elm.addEventListener('mouseout', function () {
        //     _this.videoControl.style.display = 'none';
        // }, false);


        if (this.videoControl) {
            this.videoControl.addEventListener('play', function () {
            	if (_this.videoView.paused) {
            		_this.videoView.play();
            	}
                _this.videoControl.classList.remove('video-play');
                _this.videoControl.classList.add('video-pause');
            }, false);

            this.videoControl.addEventListener('click', function () {
            	if (_this.heroVideoPlayer) {
            		_this.heroVideo.querySelector('.section-foreground').classList.add('hide');
                    _this.heroVideo.querySelector('.section-background .section-bleed picture').classList.add('hide');
                    _this.videoView.style.backgroundcolor = "#000";
                    _this.videoPlayer.style.visibility = 'visible';
                }
                if (_this.videoView.paused) {
                    _this.videoView.play();
                     _this.startTimer();
                    _this.videoContent.classList.add('video-text-hide');
                    _this.videoControlBar.classList.remove('video-control-hide');
                    _this.videoControl.classList.remove('video-play');
                    _this.videoControl.classList.add('video-pause');
                } else {
                    _this.videoView.pause();
                    _this.videoControl.classList.remove('video-pause');
                    if (_this.heroVideoPlayer) {
                        _this.videoControl.classList.remove('right-aligned');
                    }
                    _this.videoControl.classList.add('video-play');
                }
                return false;
            }, false);
        }

        if (this.videoView) {
            this.videoView.addEventListener('ended', function myHandler(e) {
                _this.videoControl.classList.remove('video-pause');
                if (_this.heroVideoPlayer) {
                    _this.videoPlayer.style.visibility = 'hidden';
                    _this.videoControl.style.visibility = 'visible';
                    _this.videoControl.classList.add('right-aligned');
                    _this.videoControl.style.display = 'block';
                    _this.heroVideo.querySelector('.section-background .section-bleed picture').classList.remove('hide');
                    _this.heroVideo.querySelector('.section-foreground').classList.remove('hide');
                    _this.videoContent.classList.remove('video-text-hide');
                }
                _this.videoControl.classList.add('video-play');
            }, false);
            this.videoView.addEventListener('progress', function() {
                if (_this.videoView.buffered.length > 0) {
                    var bufferedEnd = _this.videoView.buffered.end(_this.videoView.buffered.length - 1);
                    var duration = _this.videoView.duration;
                    if (duration > 0) {
                        var bufferPercent = ((bufferedEnd / duration) * 100);
                        _this.videoProgressbuffer.style.width = bufferPercent + '%';
                    }
                }
            });
            this.videoView.addEventListener('timeupdate', function () {
                var playPercent = 100 * (_this.videoView.currentTime / _this.videoView.duration);
                _this.videoPlayhead.style.left = playPercent + '%';
                _this.videoProgressbar.style.width = playPercent + '%';
                var durationInSeconds = parseInt(_this.videoView.currentTime, 10); // don't forget the second param
                _this.timeFormat(durationInSeconds,0);
            }, false);

            this.progressBar = document.querySelector(".progress");
            this.videoView.addEventListener('loadstart', function() {
//               _this.progressBar.classList.remove('hide'); // Commented to avoid loader displayed on page load
            }, false);
           this.videoView.addEventListener('canplay', function () {
                _this.progressBar.classList.add('hide');
                if (!_this.errorMessage.classList.contains('hide')) {
                    _this.errorMessage.classList.add('hide');
                }
            }, false);

           this.errorMessage = document.querySelector(".video-error");
           this.videoView.addEventListener('error', function() {
               if (_this.errorMessage.classList.contains('hide')) {
                    _this.errorMessage.classList.remove('hide');
                }
            });

        }

        if (this.videoVolumePlayhead) {
            this.videoVolumePlayhead.addEventListener('dragstart', function (ev) {
                ev.dataTransfer.setData("text", ev.target.className);
                //console.log("drag start", ev.target.class);
            }, false);
        }

        if (this.videoVolumeWrapper) {
            this.videoVolumeWrapper.addEventListener('drop', function (ev) {
                ev.preventDefault();
                var data = ev.dataTransfer.getData("text");
                var volumePercent = _this.volumePercent(ev);
                _this.videoVolumePlayhead.style.left = volumePercent * 100 + '%';
                _this.videoVolumeProgressbar.style.width = volumePercent * 100 + '%';
                _this.videoView.volume = volumePercent;
                if (_this.videoView.volume < 0.5)
                    _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_low.svg")';
                else if (_this.videoView.volume > 0.5)
                    _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_high.svg")';
            }, false);

            this.videoVolumeWrapper.addEventListener('dragover', function (ev) {
                ev.preventDefault();
                //console.log("dragover");
            }, false);
        }

        if (this.videoTimeLine) {
            this.videoTimeLine.addEventListener('click', function (e) {
                _this.videoPlayhead.style.left = _this.clickPercent(e) * 100 + '%';
                _this.videoProgressbar.style.width = _this.clickPercent(e) * 100 + '%';
                var time = _this.videoView.duration * (_this.clickPercent(e));
                _this.videoView.currentTime = time;
                var durationInSeconds = parseInt(_this.videoView.currentTime, 10); // don't forget the second param
                _this.timeFormat(durationInSeconds,0);
                _this.videoView.play();
                _this.videoControl.classList.remove('video-play');
                _this.videoControl.classList.add('video-pause');
            }, false);
        }

        if (this.videoVolumeWrapper) {
            this.videoVolumeWrapper.addEventListener('click', function (e) {
                _this.videoVolumePlayhead.style.left = _this.volumePercent(e) * 100 + '%';
                _this.videoVolumeProgressbar.style.width = _this.volumePercent(e) * 100 + '%';
                _this.videoView.volume = _this.volumePercent(e);
                if (_this.videoView.volume < 0.5)
                    _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_low.svg")';
                else if (_this.videoView.volume > 0.5)
                    _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_high.svg")';
            }, false);
        }

        if (this.fullScreenButton) {
            this.fullScreenButton.addEventListener("click", function () {
                if (!document.fullscreenElement && // alternative standard method
                    !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) { // current working methods
                  
                    _this.fullScreenButton.classList.remove('video-full-screen');
                    _this.fullScreenButton.classList.add('video-collapse-screen');
                    if (_this.elm.requestFullscreen) {
                        _this.elm.requestFullscreen();
                    } else if (_this.elm.msRequestFullscreen) {
                        _this.elm.msRequestFullscreen();
                    } else if (_this.elm.mozRequestFullScreen) {
                        _this.elm.mozRequestFullScreen();
                    } else if (_this.elm.webkitRequestFullscreen) {
                        _this.elm.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);

                    }
                    if (_this.elm.parentNode.classList.contains('outer-video-container')) {
                        _this.elm.parentNode.classList.remove('video-small');
                    }
                } else {
                    _this.fullScreenExit();
                }
            });
        }

        if (this.muteButton) {
            this.muteButton.addEventListener("click", function () {
                if (_this.videoView.muted == false) {
                    _this.videoView.muted = true;
                    _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_off.svg")';

                } else {
                    _this.videoView.muted = false;
                    if (_this.videoView.volume < 0.5)
                        _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_low.svg")';
                    else if (_this.videoView.volume > 0.5)
                        _this.muteButton.style.backgroundImage = 'url("/etc/designs/tcs/publish/assets/img/pages/media/ic_audio_high.svg")';
                }
            });
        }

        window.addEventListener('keyup', function (e) {
            _this.cancelFullScreen(e);
        }, false);
    };
    
    

})();
(function() {
    def.multipleAudioVideoPlay = function() {
    this.name = "multiplaAudioVideoPlay";
    this.main = document.querySelector('main');
    this.audioControl = document.querySelectorAll('.audio-play-button');
    this.videoControl = document.querySelectorAll('.video-play');

    this.init();
    }
    var p =  def.multipleAudioVideoPlay.prototype;
    def.multipleAudioVideoPlay.prototype.constructor = def.multipleAudioVideoPlay;

        p.init = function() {
            this.addEvents();
        };

        p.addEvents = function() {
        var _this = this;
            document.addEventListener('play', function(e) {
                if (document.readyState === "complete") {
                var audios = document.getElementsByTagName('audio');
                var audiosLength = audios.length;
                    for (var i = 0; i < audiosLength; i++) {
                        if (audios[i] != e.target) {
                            audios[i].pause();
                            if (audios[i].paused) {
                                if (_this.audioControl[i] && _this.audioControl[i] != undefined) {
                                    if (_this.audioControl[i].classList.contains('audio-pause-button') === true) {
                                        _this.audioControl[i].classList.remove('audio-pause-button');
                                    }
                                    _this.audioControl[i].classList.add('audio-play-button');
                                }
                            }
                        }
                    }
                }
                var videos = document.getElementsByTagName('video');
                var videosLength = videos.length;
                for (var i = 0; i < videosLength; i++) {
                    if (videos[i] != e.target) {
                        if (!videos[i].getAttribute('video-type')) {
                                 videos[i].pause();
                                 if (videos[i].paused) {
                                     if (videos[i].parentNode.querySelector(".video-control")) {
                                         if (videos[i].parentNode.querySelector(".video-control").classList.contains("video-pause")) {
                                             videos[i].parentNode.querySelector(".video-control").classList.remove("video-pause");
                                             videos[i].parentNode.querySelector(".video-control").classList.add("video-play");
                                         }
                                     }
                            }
                        }
                    }
                }
        }, true);

    };
    obj.multipleaudiovideoPlay = new def.multipleAudioVideoPlay();
})();

document.addEventListener('DOMContentLoaded', function() {
    var bluePolygonContainer = document.querySelector('.blue-polygon-container');
    var redPolygonContainer = document.querySelector('.red-polygon-container');



    //setting class active and text to center blue polygon
    var setBluePolygonDefaultText = function() {
        if (bluePolygonContainer) {

            bluePolygonContainer.querySelector('svg').querySelectorAll('g').forEach(function(gElem) {
                gElem.querySelector('text.polygon-text').style.display = 'none';
                gElem.querySelector('text.polygon-text-plus').style.display = 'block';

                if (parseInt(gElem.querySelector('polygon').getAttribute('id')) === 1) {
                    gElem.setAttribute('class', 'active polygon-blue-1');
                    gElem.setAttribute('transform', 'translate(-100 -115) scale(1.5)');
                    gElem.querySelector('text.polygon-text').style.display = 'block';
                    gElem.querySelector('text.polygon-text-plus').style.display = 'none';
                    return;
                }
            });
        }
    };

    //setting class active and text to center red polygon
    var setRedPolygonDefaultText = function() {
        if (redPolygonContainer) {
            redPolygonContainer.querySelector('svg').querySelectorAll('g').forEach(function(gElem) {
                gElem.querySelector('text.polygon-text').style.display = 'none';
                gElem.querySelector('text.polygon-text-plus').style.display = 'block';

                if (parseInt(gElem.querySelector('polygon').getAttribute('id')) === 1) {
                    gElem.setAttribute('class', 'active polygon-red-1');
                    gElem.setAttribute('transform', 'translate(-100 -112) scale(1.5)');
                    gElem.querySelector('text.polygon-text').style.display = 'block';
                    gElem.querySelector('text.polygon-text-plus').style.display = 'none';
                    return;
                }
            });
        }
    };

    // Animation event binding for blue polygons
    var callHoverEvent = function() {
        if (bluePolygonContainer) {
            bluePolygonContainer.querySelector('svg').querySelectorAll('g').forEach(function(gElem) {

                gElem.addEventListener('mouseenter', function() {
                    var itemId = parseInt(this.querySelector('polygon').getAttribute('id'));
                    var transform = {
                        scale: 0,
                        translate: '',
                        fontSize: ''
                    };

                    if (parseInt(this.querySelector('polygon').getAttribute('id')) !== 1) {

                        var blueCenterPolygon = document.querySelector('.blue-polygon-container').querySelector('svg').querySelectorAll('g')[0];
                        blueCenterPolygon.removeAttribute('class');
                        blueCenterPolygon.setAttribute('transform', 'translate(0 0) scale(1)');

                        this.setAttribute('class', 'active polygon-blue-' + itemId);
                        this.querySelector('text.polygon-text').style.display = 'block';
                        this.querySelector('text.polygon-text-plus').style.display = 'none';
                        var elem = this.querySelector('polygon');
                        elem.setAttribute('class', 'active');


                        if (itemId === 2) {
                            transform.scale = (60 / 40) * 1.3;
                            transform.translate = '-122 -100';
                            transform.fontSize = '7.5px';
                        } else if (itemId === 3) {
                            transform.scale = (60 / 30) * 1.3;
                            transform.translate = '-443 -573';
                            transform.fontSize = '6px';
                        } else if (itemId === 4) {
                            transform.scale = (60 / 20) * 1.3;
                            transform.translate = '-363 -1030';
                            transform.fontSize = '4px';
                        } else if (itemId === 5) {
                            transform.scale = (60 / 10) * 1.3;
                            transform.translate = '-1868 -650';
                            transform.fontSize = '2px';
                        }

                        this.setAttribute('transform', 'translate(' + transform.translate + ') scale(' + transform.scale + ')');
                        this.querySelector('text').style.fontSize = transform.fontSize;
                    }
                });

                gElem.addEventListener('mouseleave', function() {
                    var itemId = parseInt(this.querySelector('polygon').getAttribute('id'));
                    if (itemId === 1) {
                        return false;
                    } else {
                        if (parseInt(this.querySelector('polygon').getAttribute('id')) !== 1) {

                            var blueCenterPolygon = document.querySelector('.blue-polygon-container').querySelector('svg').querySelectorAll('g')[0];
                            blueCenterPolygon.setAttribute('class', 'active polygon-blue-1');
                            blueCenterPolygon.setAttribute('transform', 'translate(-100 -115) scale(1.5)');
                            gElem.querySelector('text.polygon-text').style.display = 'none';
                            gElem.querySelector('text.polygon-text-plus').style.display = 'block';

                        }
                        var elem = this.querySelector('polygon');
                        elem.removeAttribute('class');
                        this.removeAttribute('class');
                        this.style.transformOrigin = '';
                        gElem.setAttribute('transform', 'translate(0 0) scale(1)');
                    }
                });
            });
        }
    };

    // Animation event binding for red polygons
    var callRedPolygonHoverEvent = function() {
        if (redPolygonContainer) {
            redPolygonContainer.querySelector('svg').querySelectorAll('g').forEach(function(gElem) {
                gElem.addEventListener('mouseenter', function() {

                    var itemId = parseInt(this.querySelector('polygon').getAttribute('id'));
                    var transform = {
                        scale: 0,
                        translate: '',
                        fontSize: ''
                    };

                    if (parseInt(this.querySelector('polygon').getAttribute('id')) !== 1) {

                        var redCenterPolygon = document.querySelector('.red-polygon-container').querySelector('svg').querySelectorAll('g')[0];
                        redCenterPolygon.removeAttribute('class');
                        redCenterPolygon.setAttribute('transform', 'translate(0 0) scale(1)');
                        this.querySelector('text.polygon-text').style.display = 'block';
                        this.querySelector('text.polygon-text-plus').style.display = 'none';

                        this.setAttribute('class', 'active polygon-red-' + itemId);
                        var elem = this.querySelector('polygon');
                        elem.setAttribute('class', 'active');

                        if (itemId === 2) {
                            transform.scale = (60 / 30) * 1.3;
                            transform.translate = '-207 -166';
                            transform.fontSize = '8px';
                        } else if (itemId === 3) {
                            transform.scale = (60 / 30) * 1.3;
                            transform.translate = '-441 -572';
                            transform.fontSize = '8.4px';
                        } else if (itemId === 4) {
                            transform.scale = (60 / 20) * 1.3;
                            transform.translate = '-359 -1037';
                            transform.fontSize = '6px';
                        } else if (itemId === 5) {
                            transform.scale = (60 / 40) * 1.3;
                            transform.translate = '-259 -95';
                            transform.fontSize = '10.5px';
                        }

                        this.setAttribute('transform', 'translate(' + transform.translate + ') scale(' + transform.scale + ')');
                        this.querySelector('text').style.fontSize = transform.fontSize;
                    }
                });
                gElem.addEventListener('mouseleave', function() {
                    var itemId = parseInt(this.querySelector('polygon').getAttribute('id'));
                    if (itemId === 1) {
                        return false;
                    } else {
                        if (parseInt(this.querySelector('polygon').getAttribute('id')) !== 1) {
                            var redCenterPolygon = document.querySelector('.red-polygon-container').querySelector('svg').querySelectorAll('g')[0];
                            redCenterPolygon.setAttribute('class', 'active polygon-red-1');
                            redCenterPolygon.setAttribute('transform', 'translate(-100 -112) scale(1.5)');
                            gElem.querySelector('text.polygon-text').style.display = 'none';
                            gElem.querySelector('text.polygon-text-plus').style.display = 'block';
                        }
                        var elem = this.querySelector('polygon');
                        elem.removeAttribute('class');
                        this.removeAttribute('class');
                        this.style.transformOrigin = '';
                        gElem.setAttribute('transform', 'translate(0 0) scale(1)');
                    }
                });
            });
        }
    };
    setBluePolygonDefaultText();
    callHoverEvent();
    setRedPolygonDefaultText();
    callRedPolygonHoverEvent();
}, false);
(function() {
    'use strict';

        var ViewAll = function() {
            this.init = init;
            this.addEvents = addEvents;
            this.setOverlayPage = setOverlayPage;
            this.showOverlay = showOverlay;
            this.closeOverlay = closeOverlay;
            this.getOverlayData = getOverlayData;
            this.addCards = addCards;
            this.viewAllTemplate = viewAllTemplate;
			this.updateLevelOneDD = updateLevelOneDD;
			this.updateLevelOneDDBancs = updateLevelOneDDBancs;
            this.initCards = initCards;
            this.totalcards = 0;
            this.itemIndex = 0;
            this.cardsList = [];
            this.loadMoreParams = {};
            this.lazyload;
            this.hashObject = {};
            this.addToContainer = addToContainer;
            this.isDDSelected;
            this.init();
            var itemSelectedYearValue = 'All';
            var itemSelectedMonthValue = 'All';
            var overlayHeading = "";
            var aiFlag = false;
     	   	if(document.getElementById('aiFlag')){
	          	aiFlag = document.getElementById("aiFlag").innerHTML;    
	         }
            function init() {
                this.name = 'Overlay';
                this.body = document.querySelector('body');
                this.pageOverlay = document.querySelector('.page-overlay');
                if (this.pageOverlay) {
                    this.contentWrapper = this.pageOverlay.querySelector('.overlay-content-wrapper');
                    this.close = this.pageOverlay.querySelector('.overlay-close');
					this.filterLevelOneDynamic = this.pageOverlay.querySelector('.filter-level-one-dynamic');
					this.bancsSolution = this.pageOverlay.querySelector('.solution-selection');
                    this.pressReleasesSection = document.querySelector('.press-releases-dropdown-container');
                    this.yearSection = document.querySelector('.press-release-by-year');
                    if (this.yearSection) {
                    	this.pressReleasesByYearDD = this.pressReleasesSection.querySelector('.press-release-by-year .dropdown');
                        this.pressReleasesByMonthDD = this.pressReleasesSection.querySelector('.press-release-by-month .dropdown');
                        this.pressReleasesByYearDD.addEventListener('click', function() {
                            var mmcontents = document.querySelectorAll('.press-release-by-month .dropdown-content-wrapper .dropdown-content li');
                            for(var i = 0; i < mmcontents.length; i++){
								mmcontents[i].classList.remove('selected');
                            }
                            mmcontents[0].classList.add('selected');
                        });

                    }else if(!this.yearSection && this.pressReleasesSection ){
						this.pressReleasesByYearDD = this.pressReleasesSection.querySelector('.dropdown');
                    }
                }


                this.addEvents();
            this.setOverlayPage();
            };

        function addEvents() {
            var _this = this;

            this.close.addEventListener('click', function() {
                _this.closeOverlay();
            }, false);
        };

        function getOverlayData(isLoadMore, isDDSelected) {
        	var url, searchIn, tagId, orderBy, sortBy, blogEnabled, isCSPage,  monthFilter, yearFilter, actualPath,componentName;
            var _this = this;
            this.cardsList = [];
            this.cardsTitle = [];
			this.bancsDropdownList=[];
            this.isDDSelected = isDDSelected || false;

            if (!isLoadMore && !isDDSelected) {
                this.initialLoad = true;
            } else {
                this.initialLoad = false;
            }


                if (isLoadMore) {
                    this.loadMoreParams.offset = this.loadMoreParams.end;
                    this.loadMoreParams.end += this.loadMoreParams.limit;
                } else {
                    this.loadMoreParams.offset = parseInt(this.hashObject.offset);
                    this.loadMoreParams.limit = parseInt(this.hashObject.limit);
                    this.loadMoreParams.end = this.loadMoreParams.offset + this.loadMoreParams.limit;
                }

                searchIn = this.hashObject.searchIn ? this.hashObject.searchIn : '';
                tagId = this.hashObject.tagId ? this.hashObject.tagId : '';
                orderBy = this.hashObject.orderBy ? this.hashObject.orderBy : '';
            	sortBy = this.hashObject.sortBy ? this.hashObject.sortBy : '';
            	blogEnabled= this.hashObject.blogEnabled ? this.hashObject.blogEnabled : '';
            	isCSPage= this.hashObject.isCSPage ? this.hashObject.isCSPage : '';
            	monthFilter= this.hashObject.M ? this.hashObject.M : 'no';
            	yearFilter = this.hashObject.Y ? this.hashObject.Y :'no';

            	var country = utils.getQueryStringFromUrl('country', this.url);
            	var lang = utils.getQueryStringFromUrl('lang', this.url);

                var itemSelectedYear = '';
                var itemSelectedMonth = '';
				var solutionDropdownselected = '';
                if (this.yearSection) {
                	itemSelectedYear = this.pressReleasesByYearDD.querySelector('.dropdown-item.selected');
                    itemSelectedMonth = this.pressReleasesByMonthDD.querySelector('.dropdown-item.selected');
                    if(itemSelectedYearValue != itemSelectedYear.dataset.item){
                        itemSelectedMonthValue = 'All';
                        document.querySelector('.press-release-by-month .dropdown-selected').innerHTML = 'All';

                }else if(itemSelectedYearValue == itemSelectedYear.dataset.item){
                    itemSelectedMonthValue = itemSelectedMonth.dataset.item;
                    document.querySelector('.press-release-by-month .dropdown-selected').innerHTML = itemSelectedMonthValue;
                }
				itemSelectedYearValue = itemSelectedYear.dataset.item;
                }
               else if(!this.yearSection && this.pressReleasesSection ){
					itemSelectedYear = this.pressReleasesByYearDD.querySelector('.dropdown-item.selected');
                    itemSelectedYearValue = itemSelectedYear.dataset.item;
                }
				 if (this.solutionDropdown) {
                solutionDropdownselected = this.solutionDropdown.querySelector('.dropdown-item.selected').dataset.item;

				}

                if (this.filterLevelOneDynamic) {
                    var filterLevelOneSeleted = this.filterLevelOneDynamic.querySelector('.dropdown-item.selected');
                    var filterLevelOneSeletedValue = filterLevelOneSeleted.dataset.item;
                }
				if (this.bancsSolution) {
                var bancsSolutionSeleted = this.bancsSolution.querySelector('.dropdown-item.selected');
                var bancsSolutionSeletedValue = bancsSolutionSeleted.dataset.item;
				}

                if (this.yearSection) {
                    if (itemSelectedYearValue == 'All') {
                        this.pressReleasesByMonthDD.style.display = 'none';
                    } else {
                        this.pressReleasesByMonthDD.style.display = 'block';
                    }
              }
                if(yearFilter == "yes" && (monthFilter == "no" || monthFilter == "")&& this.yearSection ){
                    document.querySelector('.press-release-by-month .dropdown').classList.add('hide');
                }else if (yearFilter == "yes" && monthFilter == "yes" && this.yearSection){
                    this.pressReleasesSection.querySelector('.press-release-by-month .dropdown').classList.remove('hide');
                }else if ((yearFilter == "no" || yearFilter == "") && (monthFilter == "no" || monthFilter == "") && this.yearSection){
					this.pressReleasesSection.querySelector('.press-release-by-year .dropdown').classList.add('hide');
					this.pressReleasesSection.querySelector('.press-release-by-month .dropdown').classList.add('hide');
                    this.pressReleasesSection.style.height = 'auto';
                }else if(this.yearSection) {
                    this.pressReleasesSection.querySelector('.press-release-by-year .dropdown').classList.add('hide');
					this.pressReleasesSection.querySelector('.press-release-by-month .dropdown').classList.add('hide');
                    this.pressReleasesSection.style.height = 'auto';
                }else if ((yearFilter == "no" || yearFilter == "")&& monthFilter == "yes" && this.yearSection){
                	this.pressReleasesSection.querySelector('.press-release-by-year .dropdown').classList.add('hide');
					this.pressReleasesSection.querySelector('.press-release-by-month .dropdown').classList.add('hide');
                    this.pressReleasesSection.style.height = 'auto';
                }

				var urltagId = tagId;
            	if (tagId.indexOf(',') != -1) {
                var segments = tagId.split(',');
                urltagId = "";
                urltagId = segments.join("&tagId=");
            }
            	  if (this.pressReleasesSection) {

                      url = '/services/tcs/cardsWithFilter?searchIn=' + searchIn +
                          '&offset=' + this.loadMoreParams.offset +
                          '&limit=' + this.loadMoreParams.limit +
                          '&tagId=' + urltagId +'&year=' + itemSelectedYearValue +'&month=' + itemSelectedMonthValue +'&isCSPage=' + isCSPage;
                    var aiFlag = false;
               	   	if(document.getElementById('aiFlag')){
          	          	aiFlag = document.getElementById("aiFlag").innerHTML;    
          	         }
                      if(aiFlag=="true"){
                    	  if(def !=null && def.Fingerprint != null){
                    		  new def.Fingerprint(this.loadMoreParams.offset, this.loadMoreParams.limit, urltagId, itemSelectedYearValue, itemSelectedMonthValue, false, true, null);
                    	  }
                      }
                  } else if (this.filterLevelOneDynamic) {

                 var sortBy;
                      if ("Press Release" == filterLevelOneSeletedValue) {
                        sortBy = '&sortBy=publishedDate';
                      } else if (sortBy) {
						sortBy = '&sortBy=' + sortBy;
                      }
                      if ("All" == filterLevelOneSeletedValue) {
                          filterLevelOneSeletedValue = "";
                      }
                url = '/services/tcs/cardsWithFilter?searchIn=' + searchIn +
                          '&offset=0&limit=0' +
                          '&tagId=' + urltagId +
                          '&isCSPage=' + isCSPage +
                    '&cardTitle=' + filterLevelOneSeletedValue +
                    sortBy;
                var aiFlag = false;
         	   	if(document.getElementById('aiFlag')){
    	          	aiFlag = document.getElementById("aiFlag").innerHTML;    
    	         }
                if(aiFlag=="true"){
                	if(def != null && def.Fingerprint != null){
                		new def.Fingerprint(0, 0, urltagId, null, null, false, true, filterLevelOneSeletedValue);
                	}
                }
            } else{

                  	  url = '/services/tcs/cardsWithFilter?searchIn=' + searchIn +
                          '&offset=' + this.loadMoreParams.offset +
                          '&limit=' + this.loadMoreParams.limit +
      					'&tagId=' + urltagId +'&isCSPage=' + isCSPage;
                  	var aiFlag = false;
             	   	if(document.getElementById('aiFlag')){
        	          	aiFlag = document.getElementById("aiFlag").innerHTML;    
        	         }
                  	if(aiFlag=="true"){
                  		if(def !=null && def.Fingerprint != null){
                  			new def.Fingerprint(this.loadMoreParams.offset, this.loadMoreParams.limit, urltagId, null, null, false, true, null);
                  		}
                  	}
                  }







                if(orderBy){
					url = url + '&orderBy=' + orderBy;
            	}
            	if(sortBy){
					url = url + '&sortBy=' + sortBy;
            	}
            	if(blogEnabled){
            		url = url +'&blogEnabled=' + blogEnabled;
            	}

                if(this.hashObject.overlayType === 'view-all-asset'){
					url = '/services/tcs/csReports?searchIn=' + searchIn +
                    '&offset=' + this.loadMoreParams.offset +
                    '&limit=' + this.loadMoreParams.limit +
                    '&tagId=' + urltagId;
                }
				else if (_this.hashObject.overlayType === 'solutions-add') {
                    if(bancsSolutionSeletedValue === "All"){
					solutionDropdownselected=urltagId;
                   }
                    else{
                solutionDropdownselected = bancsSolutionSeletedValue;
                    }
                url = '/services/tcs/cardsWithFilter?searchIn=' + searchIn +
                    '&offset=' + this.loadMoreParams.offset +
                    '&limit=' + this.loadMoreParams.limit +
                    '&tagId=' + solutionDropdownselected + '&sortBy=' + sortBy ;
            }

            	if(this.hashObject.overlayType === 'career-news-view-all'){
					url = '/services/tcs/careerNews?searchIn=' + searchIn +
                    '&offset=' + this.loadMoreParams.offset +
                    '&limit=' + this.loadMoreParams.limit +
                    '&tagId=' + urltagId +
                    '&country=' + country +
                    '&lang=' + lang;

                }
            	
            	if(this.hashObject.overlayType === 'authoredcards'){
					url = '/services/tcs/AuthorCardDetails?offset=' + this.loadMoreParams.offset +
                    '&limit=' + this.loadMoreParams.limit +
                    '&tagId=' +  tagId+
                    '&actualPath=' + this.hashObject.actualPath +
                    '&componentName=' + this.hashObject.componentName;
                }


				var loaderDiv = document.querySelector('.progress');
            	if (loaderDiv && loaderDiv.classList.contains('hide')) {
                	loaderDiv.classList.remove('hide');
            	}


                window.fetch(url, {
                        method: 'GET',
                        credentials: 'include'
                    })
                    .then(function(response) {
						 if (loaderDiv && !loaderDiv.classList.contains('hide')) {
                         	loaderDiv.classList.add('hide');
                     	}
                        response.json().then(function(cards) {
                        	 if(cards.success === 'false') {
	                       		  return;
	                       	  }
                        	var selValue = "" ;
                            var searchResult = cards.search_result;
                            overlayHeading = cards.overlayHeading;
							if(cards.filterValues){
                        var dropdownResult=cards;
                        }
                           /* if(document.querySelector('.dropdown-header .title')) {
							    document.querySelector('.dropdown-header .title').innerHTML = overlayHeading;
                            }*/
                            if(document.querySelector(".view-all-heading")){
     								document.querySelector(".view-all-heading").innerHTML = overlayHeading;
                            }else if(document.querySelector(".vam-card-group h3")){
                            	if(document.getElementById("overlayHeading") && document.getElementById("overlayHeading").value ){
                            		utils.getSanitizedText(document.getElementById("overlayHeading").value);
                            	}
                            	 if(selValue == "" )
                            	 {
                                     if(document.querySelector(".viewAllBancsOverlay")) {
                                    	 document.querySelector(".vam-card-group h3").innerHTML = "" ;
                                 } else {
 									 	document.querySelector(".vam-card-group h3").innerHTML = overlayHeading;
                                       }
                                 } else  {
                                    document.querySelector(".vam-card-group h3").innerHTML = selValue ;
                                }
                            }
                            
                            if(searchResult) {
		                            searchResult.commonSearchResultList.forEach(function(item) {
		                                _this.cardsList.push(item);
		                            })
									if (searchResult.cardTitle) {
		                            searchResult.cardTitle.forEach(function(item) {
		                                _this.cardsTitle.push(item);
		                            })
		                            _this.updateLevelOneDD();
								}
                            
                        }
						if (dropdownResult) {
                             dropdownResult.filterValues.forEach(function (item) {
                            _this.bancsDropdownList.push(item);
                        })
                            if (document.querySelector(".solution-selection .dropdown-content")) {
                                _this.updateLevelOneDDBancs();
                            }
                        }

						if(searchResult) {
                            _this.totalcards = searchResult.totalMatch;
						}
                            _this.viewAllTemplate();
                            window.objectFitObj.init();
                        })
                    })
                    .catch(function(error) {

                    });
            }
			
			function updateLevelOneDD() {
            var _this = this;
            var cardTitleCount = this.cardsTitle.length;
            if(document.querySelector('.dropdown-header .title')&& this.filterLevelOneDynamic) {
			    document.querySelector('.dropdown-header .title').innerHTML = overlayHeading;
            }
            
            if (this.initialLoad && this.filterLevelOneDynamic) {
                for (var i = 0; i < cardTitleCount; i++) {
                    var templateDiv = '<li tabindex="0" class="text-style-46 dropdown-item outline-none" data-item="' +
                        this.cardsTitle[i] + '">' +
                        this.cardsTitle[i] + '</li >';
                    document.querySelector(".filter-level-one-dynamic .dropdown-content").insertAdjacentHTML('beforeend', templateDiv);
                }
                var filterDynamicCategoryDD = this.contentWrapper.querySelector('.filter-level-one-dynamic .dropdown');
                if(filterDynamicCategoryDD) {
                    var filterDynamicCategoryDDObj = new def.DropDown(filterDynamicCategoryDD);
                    filterDynamicCategoryDDObj.subscribe('onItemChange', function() {
                        _this.getOverlayData(false, true);
                    });
                }
            }
        }
		function updateLevelOneDDBancs() {
            var _this = this;
            var dropDownList = this.bancsDropdownList.length;
            if (this.initialLoad &&  this.bancsSolution ) {
                for (var i = 0; i < dropDownList; i++) {
                    var templateDiv = '<li tabindex="0" class="text-style-46 dropdown-item outline-none" data-item="' +
                        this.bancsDropdownList[i].filterTagId + '">' +
                        this.bancsDropdownList[i].filterTitle + '</li >';
                    document.querySelector(".solution-selection .dropdown-content").insertAdjacentHTML('beforeend', templateDiv);
                }
                var bancsFeatureDropdown = this.contentWrapper.querySelector('.solution-selection .dropdown');
               
                 if (bancsFeatureDropdown) {
                     var bancsfilter = new def.DropDown(bancsFeatureDropdown);
                    bancsfilter.subscribe('onItemChange', function () {
                        _this.getOverlayData(false, true);
                    });
                 }
            }
        }


            function viewAllTemplate() {
                var template;
                var none = "\'none\'";
                if (this.hashObject.overlayType === 'view-all' || this.hashObject.overlayType === 'career-news-view-all') {
                    template = '<div class="view-all-card-wrap">' +
                        '<a href="#" tabindex="0">' +
                        '<div class="view-all-card">' +
                        '<div class="view-all-card-image ">' +
                        '<picture>' +
                        '<source srcset=""/>' +
                        '<img data-object-fit="cover" src="" alt="Picture Card" onerror="this.style.display='+none+'"/>' +
                        '</picture>' +
                        '<div class="view-all-gradient">' +
                        '</div>' +
                        '</div>' +
                        '<div class="view-all-card-content">' +
                        '<div class="view-all-card-title"></div>' +
                        '<div class="view-all-card-heading"></div>' +
                        '<div class="view-all-card-description"></div>' +
                    	'<div class="view-all-card-date card-date"></div>'+
                        '</div>' +
                        '</div>' +
                        '</a>' +
                        '</div>';
                } else if((this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'our-solution') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-horizontal') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-vertical') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-list') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'latest-thinking')){
                	 template = '<div class="view-all-card-wrap">' +
                     '<a href="#">' +
                     '<div class="view-all-card">' +
                     '<div class="view-all-card-image ">' +
                     '<picture>' +
                     '<source srcset=""/>' +
                     '<img data-object-fit="cover" src="" alt="Picture Card" onerror="this.style.display='+none+'"/>' +
                     '</picture>' +
                     '<div class="view-all-gradient">' +
                     '</div>' +
                     '</div>' +
                     '<div class="view-all-card-content">' +
                     '<div class="view-all-card-title"></div>' +
                     '<div class="view-all-card-heading"></div>' +
                     '<div class="view-all-card-description"></div>' +
                 	'<div class="view-all-card-date card-date"></div>'+
                     '</div>' +
                     '</div>' +
                     '</a>' +
                     '</div>';
                }else {
                    template = '<div class=" vam-card-wrap col s12 m12 l4" >' +
                        '<div class="vam-card">' +
                        '<a href="#card1">' +
                        '<div class="vam-card-image img-fallback">' +
                        '<picture>' +
                        '<source srcset=""/>' +
                        '<img data-object-fit="cover" src="" alt="Picture Card" onerror="this.style.display='+none+'"/>' +
                        '</picture>' +
                        '<div class="vam-gradient"></div>' +
                        '</div>' +
                        '<div class="vam-card-content">' +
                        '<div class="vam-card-title"></div>' +
                        '<div class="vam-card-heading"></div>' +
                        '<div class="vam-card-description"></div>' +
                    	'<div class="vam-all-card-date  card-date"></div>'+
                        '</div>' +
                        '</a>' +
                        '</div>' +
                        '</div>';
                }
                this.initCards(template);
            };

            function initCards(template) {

                var _this = this;
                this.itemIndex = 0;
                this.addCards(template);

                if (this.loadMoreButton) {
                    if (this.loadMoreParams.end < this.totalcards) {
                        this.loadMoreButton.classList.remove('hide');
                    } else {
						this.loadMoreButton.classList.add('hide');
                    }
                }
            };


        function addCards(template) {
            var _this = this;
            var cardCount = this.cardsList.length;
            var cardTitle, cardHeading, cardDescription,cardDate;

            if (this.hashObject.overlayType === 'view-all' || this.hashObject.overlayType === 'career-news-view-all') {
                cardTitle = '.view-all-card-title';
                cardHeading = '.view-all-card-heading';
                cardDescription = '.view-all-card-description';
                cardDate = ".view-all-card-date";
            } else if((this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'our-solution') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-horizontal') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-vertical') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-list') || (this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'latest-thinking')){
            	 cardTitle = '.view-all-card-title';
                 cardHeading = '.view-all-card-heading';
                 cardDescription = '.view-all-card-description';
                 cardDate = ".view-all-card-date";
            } else {
                cardTitle = '.vam-card-title';
                cardHeading = '.vam-card-heading';
                cardDescription = '.vam-card-description';
                cardDate = ".vam-all-card-date";
            }
            if (this.isDDSelected) {
                var container = document.querySelector(".view-all-menu .vam-card-list .row");
                container.innerHTML = '';
            }

            if (cardCount == 0) {
                if(container) {
	                container.innerHTML = '<div class="no_cards">No Cards Available</div>'
                }
            }
            else {
                for (var i = 0; i < cardCount; ++i) {
                    var templateDetails = this.cardsList[i];
                    var templateDiv = document.createElement('div');
                    templateDiv.innerHTML = template;
                    var title = templateDiv.querySelector(cardTitle);
                    title.innerHTML = templateDetails.pageTitle;
                    var heading = templateDiv.querySelector(cardHeading);
                    heading.innerHTML = templateDetails.description;
                    var description = templateDiv.querySelector(cardDescription);
                    if (templateDetails.subDescription) {
                        description.innerHTML = templateDetails.subDescription;
                    }else {
                    	templateDiv.querySelector(cardHeading).classList.add('exclude-card-sub-desc');
                    }
                    var date = templateDiv.querySelector(cardDate);
                    if (date) {
                     	date.innerHTML = templateDetails.newsPublishedDate;
                    }
                    var source = templateDiv.querySelector('picture source');
                    source.srcset = templateDetails.imagePath;
                    var image = templateDiv.querySelector('picture img');
                    image.src = templateDetails.imagePath;
                    image.srcset = templateDetails.imagePath;
					/* For video card adding play bg image */
						if (templateDetails.isVideo === "[true]") {
                            var videoPlayBgImg = document.createElement("div");
                            videoPlayBgImg.classList.add('video-control', 'video-play');
                            var pictureTag = templateDiv.querySelector('picture');
                            pictureTag.parentNode.appendChild(videoPlayBgImg);
                        }
					var anchor = templateDiv.querySelector('a');
					anchor.href = templateDetails.pagePath;
					anchor.target = "_blank";
					if(templateDetails.isExternal !=null && templateDetails.isExternal=='true'){
						anchor.rel = "noopener";
                        anchor.classList.add("external-link");
                    }
                    this.addToContainer(templateDiv.innerHTML, _this.itemIndex);
                }
              }
            };

            function addToContainer(templateDiv, itemIndex) {

                var container;
                if (this.hashObject.overlayType === 'view-all' || this.hashObject.overlayType === 'career-news-view-all') {
                    container = document.querySelector(".card-wrap-view .view-all-card-list");
                }else if(this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'our-solution'){
                	container = document.querySelector(".card-wrap-view .view-all-card-list");
				}else if(this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-horizontal'){
                	container = document.querySelector(".card-wrap-view .view-all-card-list");	
				}else if(this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-vertical'){
                	container = document.querySelector(".card-wrap-view .view-all-card-list");	
				}else if(this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'section-card-layout/section-card-list'){
                	container = document.querySelector(".card-wrap-view .view-all-card-list");	
				}else if(this.hashObject.overlayType === 'authoredcards' && this.hashObject.componentName === 'latest-thinking'){
                	container = document.querySelector(".card-wrap-view .view-all-card-list");
                } else {
                    container = document.querySelector(".view-all-menu .vam-card-list .row");
                }
                container.insertAdjacentHTML('beforeend', templateDiv);

            };

            function setOverlayPage(data) {
                var _this = this;
                var heading;
            	this.hashObject = utils.getURLHash();
			/*
                if (this.hashObject.overlayType === 'view-all') {
                    heading = document.querySelector(".view-all-heading");
                } else {
                    heading = document.querySelector(".vam-card-group h3");
                }
                var modifiedHeading = utils.getSanitizedText(decodeURI(this.hashObject.query));

			if(sessionStorage.getItem("viewAll") != null ) {
                if(sessionStorage.getItem("heading") == null ) {
					 heading.innerHTML = modifiedHeading;
                } else {
					 heading.innerHTML =sessionStorage.getItem("heading");
                }

				 sessionStorage.setItem("heading",modifiedHeading);
            }
				 heading.innerHTML = overlayHeading;*/
               
            	var loadMoreVal = "";
              	if(document.getElementById("loadMoreValue") && document.getElementById("loadMoreValue").value ){
              		loadMoreVal = utils.getSanitizedText(document.getElementById("loadMoreValue").value);

              	}
              	if(loadMoreVal == ""){
              		this.loadMoreButton = this.pageOverlay.querySelector('#view-more');

              	}else {

              		var loadMoreSelector = this.pageOverlay.querySelector('#view-more');
              		loadMoreSelector.innerHTML = utils.getSanitizedText(loadMoreVal);
              		this.loadMoreButton =loadMoreSelector;
              	}

                if(this.loadMoreButton){
                     this.loadMoreButton.addEventListener('click', function() {

                    _this.getOverlayData(true);
                });
                }
				if (this.loadMoreButton) {
                this.loadMoreButton.addEventListener('keydown', function() {
                    if (event.which == 32 || event.which == 13)
                        _this.getOverlayData(true);
                });
				}

                this.getOverlayData(false);
                this.showOverlay();
            };

            function showOverlay() {
                if (this.pageOverlay) {

                    this.pageOverlay.style.visibility = 'visible';
                    this.pageOverlay.classList.add('show');
                }
               /* if (this.body) {
                    this.body.style.overflowY = 'scroll';
                }*/


            };

            function closeOverlay() {
                
                var _this = this;

                if (_this.body) {
                 
                    _this.body.style.position = '';
                }

                if (this.pageOverlay) {
                    this.pageOverlay.classList.remove('show');

                    setTimeout(function() {
                        _this.pageOverlay.style.visibility = 'hidden';
                    }, 1001);
                }

            utils.clearURLHash();
        };
    };
    def.ViewAll = ViewAll;
})();
(function () {
    "use strict";

    var base = new def.SectionBase();
    var PWSideMenu = function (element, index) {
        if (!element) {
            return;
        }
        this.init = init;
        this.onRequestAnimationFrame = onRequestAnimationFrame;
        this.addEvents = addEvents;
        this.onClickMenu = onClickMenu;
        this.onClickListMenuHeader = onClickListMenuHeader;
        this.closeSectionPageDD = closeSectionPageDD;
        this.setLayoutHeight = setLayoutHeight;

        this.init();

        function init() {
            base.init.call(this);
            this.name = "PWSideMenu";

            this.elm = element;
            this.index = index;
            this.menuMarker = this.elm.querySelector("#page-side-menu-marker");
            this.menuContainer = this.elm.querySelector(".section-page-side-menu .menu");
            this.menus = this.elm.querySelectorAll(".section-page-side-menu .menu li");
            this.menuActive = this.elm.querySelector(".section-page-side-menu .menu li.active");
            this.profiles = this.elm.querySelectorAll(".section-page-side-menu .section-page-menu .section-fade");
            this.listMenuHeader = this.elm.querySelector('.page-side-menu-list-header');
            this.listMenuSelected = this.elm.querySelector('.selected-menu-item');
            this.pageOverlay = document.querySelector('.page-overlay');
            this.pageBody = document.querySelector('body');

            this.menuMarker.style.top = this.menuActive.offsetTop + 'px';
            this.menuMarker.style.height = this.menuActive.offsetHeight + 'px';

            //Adding gutter height based on dropdown height
            if (utils.isMobile || utils.isTouchDevice) {
                this.templateBottomGutter = 60;
            } else {
                this.templateBottomGutter = 20;
            }

            this.addEvents();
        };

        function onRequestAnimationFrame() {
            // Call base class method
            base.onRequestAnimationFrame();
        };

        function addEvents() {
            var _this = this;
            var menuCount = this.menus.length;
            var menu;
            //Appending selected menu item
            this.elm.querySelector('.selected-menu-item').innerHTML = utils.getSanitizedText(this.menuActive.querySelector('div').innerHTML);
            //Settng template height
            this.setLayoutHeight();

            for (var i = 0; i < menuCount && menuCount > 1; ++i) {
                menu = this.menus[i];
                menu.menuIndex = i;
                menu.addEventListener('click', this.onClickMenu.bind(_this), false);
                menu.addEventListener('keypress', this.onClickMenu.bind(_this), false);
            }
            //Dropdown header click event
            if (this.listMenuHeader) {
                this.listMenuHeader.addEventListener('click', this.onClickListMenuHeader.bind(_this), false);
            }
        };

        function onClickMenu(event) {
            var parentNode = event.target.parentNode;
            var menuIndex = parentNode.menuIndex;

            if (parentNode.classList.contains('page-side-menu-list') === true) {
                this.elm.querySelector(".section-page-side-menu .menu li.active").classList.remove('active');
                this.menus[menuIndex].classList.add('active');
                this.menuActive = this.elm.querySelector(".section-page-side-menu .menu li.active");

                //Remove dropdown-overlay and class open after menu selection - Mobile Devices
                if (utils.isMobile || utils.isTouchDevice) {
                    this.elm.querySelector('.selected-menu-item').innerHTML = utils.getSanitizedText(this.menuActive.querySelector('div').innerHTML);
                    this.menuContainer.classList.remove('open');
                    this.pageOverlay.classList.remove('dropdown-overlay');
                    this.listMenuHeader.classList.remove('open');
                }

                this.menuMarker.style.top = this.menuActive.offsetTop + 'px';
                this.menuMarker.style.height = this.menuActive.offsetHeight + 'px';
                this.elm.querySelector(".section-page-side-menu .section-page-menu .section-fade.active").classList.remove('active');
                this.profiles[menuIndex].classList.add('active');

                //updating template height
                this.setLayoutHeight();
            }
        };

        //Add open class and dropdown-overlay - Mobile Devices
        function onClickListMenuHeader(event) {
            if (this.menuContainer.classList.contains('open') === false) {
                this.menuContainer.classList.add('open');
                this.pageOverlay.classList.add('dropdown-overlay');
                this.listMenuHeader.classList.add('open');
                //Close dropdown, on outside click
                if (this.pageBody) {
                    this.pageBody.addEventListener('click', closeSectionPageDD.bind(this), false);
                }
                event.stopPropagation();
            } else {
                this.closeSectionPageDD();
            }
        }

        //Close Dropdown
        function closeSectionPageDD(event) {
            this.menuContainer.classList.remove('open');
            this.pageOverlay.classList.remove('dropdown-overlay');
            this.listMenuHeader.classList.remove('open');
        }

        //Setting Layout height based on the content
        function setLayoutHeight() {
        	if(this.elm.style.minHeight = this.elm.querySelector(".section-page-side-menu .section-page-menu .section-fade.active .text-content")){
                this.elm.style.minHeight = this.elm.querySelector(".section-page-side-menu .section-page-menu .section-fade.active .text-content").offsetHeight + this.templateBottomGutter + 'px';
            }
        }
    };

    PWSideMenu.prototype = base;
    PWSideMenu.prototype.constructor = PWSideMenu;
    window.def.PWSideMenu = PWSideMenu;
})();

(function() {
    'use strict';
    var def = window.def;
    def.componentMapping = {
        'section-base': def.SectionBase,
        'section-banner': def.SectionBanner,
        'section-hero': def.SectionHero,
        'section-busnessfourdot-mirror': def.SectionBusnessfourdotMirror,
        'section-feature': def.SectionFeature,
        'section-search': def.SectionSearch,
        'section-people': def.SectionPeople,
        'section-counter': def.SectionCounter,
        'section-card': def.SectionCard,
        'section-card-arrow': def.SectionCardArrow,
        'section-page-side-menu': def.PWSideMenu,
        'section-hero-video': def.SectionHeroVideo
    };
})();
(function() {
    'use strict';
    /**
     * @function
     * @name FlexPanelSlider
     * @param sliderConfig {Object} The config object through which the slider is getting invoked
     * And it must have the properties as follows
     * cardListContainerWrapper {HTMLObject} : The wrapper container for all the cards through which the slider is getting invoked
     * cardListContainer {HTMLObject} : The list container for all the cards to which the transform is done
     * cards {NodeList} : The cards through which the navigation of the slider is attached
     * navButtonsMobile {NodeList} : The nav buttons through which the navigation of the slider is attached for mobile
     * navButtons {NodeList} : The nav buttons through which the navigation of the slider is attached for desktop
     * cardViewCount {number} : The number of viewable card count in desktop devices
     * gutterWidth {number} : The white space taken in between the cards , it should get added to get the total width of the list
     * @desc The factory function for the flex panel slider
     * @returns {null}
     */
    var FlexPanelSlider = function(sliderConfig) {
        // Instance Methods
        this.init = init;
        this.addEvents = addEvents;
        this.setLayout = setLayout;
        this.touchStartHandler = touchStartHandler;
        this.touchEndHandler = touchEndHandler;
        this.decideSlideForMobile = decideSlideForMobile;
        this.changeActiveSelection = changeActiveSelection;
        this.slide = slide;
        this.navSlideHandler = navSlideHandler;
        this.decideSlideForLargeScreen = decideSlideForLargeScreen;
        this.changeActiveSelectionLarge = changeActiveSelectionLarge;
        this.autoSlide = autoSlide;
        // Invoke the init method
        this.init(sliderConfig);
        // Init slider
        function init(config) {
            this.cardListContainerWrapper = config.cardListContainerWrapper || {};
            this.cardListContainer = config.cardListContainer || {};
            this.cards = config.cards || [];
            this.navButtonsMobile = config.navButtonsMobile || [];
            // this.navButtons = config.navButtons || [];
            this.navButtonsContainer = config.navButtonsContainer || {};
            this.navButtonsContainerMobile = config.navButtonsContainerMobile || {};
            this.cardViewCount = config.cardViewCount || 0;
            this.gutterWidth = config.gutterWidth || 0;
            this.isAutoSlide = config.isAutoSlide || false;
            this.startPageX = 0;
            this.swipedIndexes = 1;
            this.endPageX = 0;
            this.activeIndex = 1; // Set the first card as active initially
            this.scrollIndex = 0;
            this.cardListContainerWidth = 0;
            this.cardWrapWidth = config.wrapperWidth || 0;
            // Invoke addEvents method
            window.addEventListener("load", this.addEvents.bind(this));
            if (this.isAutoSlide === true) {
                this.autoSlide();
            }
        };
        // Setlayout for slider implementation
        function setLayout(width) {
            if (utils.isMobile()|| utils.isTouchDevice()) {
                this.cardListContainer.style.width = width + 'px';
            } else {
                this.cardListContainer.style.width = width + this.gutterWidth + 'px';
            }
        }

        // Auto slide functionality for flex slider
        function autoSlide() {
            var _this = this;
            if (!utils.isTouchDevice()) {
                this.animBox = setInterval(function() {
                    _this.activeIndexs = parseInt(document.querySelector('.card-collection-nav').querySelector('.active').getAttribute('data-card-nav-index'));
                    if (_this.activeIndexs == _this.cards.length) {
                        _this.activeIndexs = 1;
                        _this.slide(_this.activeIndexs, 1);
                        _this.changeActiveSelectionLarge(_this.activeIndexs, _this.cards.length);
                    }
                    else {
                        _this.slide(_this.activeIndexs + 1, _this.swipedIndexes + 1);
                        _this.changeActiveSelectionLarge(_this.activeIndexs + 1, _this.activeIndexs);
                    }
                }, 8000);
            }
        }
        // Attach touch events to cards and nav buttons
        function addEvents() {
            try {

                var _this = this;
                var cardListContainerWidth = 0;
                var minCardWidth = 0;
                var hashObject = utils.getURLHash();

                //Display Nav buttons based on the cards size.
                if (!utils.isMobile || !utils.isTouchDevice()) {
                    if (this.cards.length > 1) {
                        this.navButtonsContainer.style.display = 'block';
                    } else {
                        this.navButtonsContainer.style.display = 'none';
                        this.cardListContainer.classList.add('fixed-card');
                        var fixedWidth = 0;
                        for (var i = 0; i < this.cards.length; i++) {
                            fixedWidth += this.cards[i].getBoundingClientRect().width;
                        }
                        this.cardListContainer.style.width = fixedWidth + this.gutterWidth + 'px';
                    }
                } else {
                    if (this.cards.length > 1) {
                        this.navButtonsContainerMobile.style.display = 'block';
                    } else {
                        this.navButtonsContainerMobile.style.display = 'none';
                    }
                }

                //NavButtons creation for desktop
                if (!utils.isMobile || !utils.isTouchDevice()) {
                    if (this.cards.length > 1) {
                        var navButtonsForDesk = '<ul>';
                        var navButtonsCount = Math.ceil(this.cards.length / _this.cardViewCount);
                        for (var navIterator = 1; navIterator <= navButtonsCount; navIterator++) {
                            if (navIterator === 1) {
                                navButtonsForDesk += '<li class="card-collection-nav-but">' +
                                '<a class="card-collection-nav-link active" data-card-nav-index="'+navIterator+'"></a>' +
                                '</li>';
                        } else {
                            navButtonsForDesk += '<li class="card-collection-nav-but">' +
                                '<a class="card-collection-nav-link" data-card-nav-index="'+navIterator+'"></a>' +
                                '</li>';
                            }
                        }
                        navButtonsForDesk += '</ul>' +
                            this.navButtonsContainer.insertAdjacentHTML('beforeend', navButtonsForDesk);
                    }
                    this.navButtons = this.navButtonsContainer.querySelectorAll('.card-collection-nav-link');
                }



                //Event listeners.
                for (var cardIterator = 0; cardIterator < this.cards.length; cardIterator++) {
                    cardListContainerWidth += this.cards[cardIterator].getBoundingClientRect().width;
                    minCardWidth = this.cards[0].getBoundingClientRect().width * 3;
                    if (!utils.isMobile || !utils.isTouchDevice()) {
                        this.cards[cardIterator].setAttribute('data-slider-index', parseInt(cardIterator / _this.cardViewCount) + 1);
                        //Remove last child border by adding class
                        if (cardIterator === this.cards.length - 1) {
                            this.cards[cardIterator].classList.add('flex-panel-no-bordered');
                        }


                        if (cardIterator < this.navButtons.length) {
                            this.navButtons[cardIterator].setAttribute('data-direction', 'dir-' + (cardIterator + 1));
                            this.navButtons[cardIterator].addEventListener('click', function(event) {
                                _this.decideSlideForLargeScreen(event);
                            }, false);
                        }
                    } else {
                        this.cards[cardIterator].addEventListener('touchstart', _this.touchStartHandler.bind(_this));
                        this.cards[cardIterator].addEventListener('touchend', _this.touchEndHandler.bind(_this));
                        this.navButtonsMobile[cardIterator].addEventListener('touchstart', _this.navSlideHandler.bind(_this));
                        this.navButtonsMobile[cardIterator].setAttribute('data-slider-index', cardIterator + 1);
                        this.cards[cardIterator].setAttribute('data-slider-index', cardIterator + 1);
                    }
                }

                this.cardListContainerWidth = cardListContainerWidth;

                if (hashObject && hashObject.type === "flexpanelslide") {
                    if (hashObject.section && hashObject.section === this.cardListContainerWrapper.getAttribute('data-card-id')) {
                        this.activeIndex = parseInt(hashObject.index);
                        if (parseInt(hashObject.index)) {
                            this.slide(parseInt(hashObject.index), parseInt(hashObject.index));
                            this.changeActiveSelectionLarge(parseInt(hashObject.index), 1);
                        }
                    }
                }

                this.setLayout(cardListContainerWidth > minCardWidth ? cardListContainerWidth : minCardWidth);
            } catch (e) {
                //console.log(e);
            }
        }
        // Event handler for "touchstart"
        function touchStartHandler(e) {
            this.startPageX = e.changedTouches[0].pageX;
        }
        // Event handler for "touchend"
        function touchEndHandler(e) {
            this.endPageX = e.changedTouches[0].pageX;
            this.decideSlideForMobile();
        }
        // Handle hav button events
        function navSlideHandler(e) {
            this.slide(this.activeIndex, e.target.getAttribute('data-slider-index'));
            this.changeActiveSelection(this.activeIndex, parseInt(e.target.getAttribute('data-slider-index')));
        }

        // Decision making on slider on desktop devices
        function decideSlideForLargeScreen(event) {
            this.activeIndex = parseInt(event.target.getAttribute('data-card-nav-index'));
            this.scrollIndex = parseInt(this.cardListContainer.querySelectorAll('div[data-slider-index="' + this.activeIndex + '"]')[0].getAttribute('data-card-index'));
            if (this.activeIndex === 1) {
                this.slide(this.activeIndex, 1);
                this.changeActiveSelectionLarge(this.activeIndex, this.swipedIndexes);
            }
            else {
                if (this.activeIndex > this.swipedIndexes) {
                    this.slide(this.activeIndex, this.scrollIndex);
                    this.changeActiveSelectionLarge(this.activeIndex, this.swipedIndexes);
                } else {
                    this.slide(this.activeIndex, this.scrollIndex);
                    this.changeActiveSelectionLarge(this.activeIndex, this.swipedIndexes);
                }
            }
        }

        // Decision making on slider on mobile devices
        function decideSlideForMobile() {
            if (Math.abs(this.startPageX - this.endPageX) < 10) {
                return false;
            }
            if (this.startPageX < this.endPageX && this.activeIndex > 1) {
                this.slide(this.activeIndex, (this.activeIndex - 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex - 1));
            } else if (this.startPageX > this.endPageX && this.cards.length > this.activeIndex) {
                this.slide(this.activeIndex, (this.activeIndex + 1));
                this.changeActiveSelection(this.activeIndex, (this.activeIndex + 1));
            } else {
                return false;
            }
        }

        //Change active For Desktop Nav Buttons
        function changeActiveSelectionLarge(currentIndex, swipedIndex) {
            this.activeIndex = swipedIndex;
            this.swipedIndexes = currentIndex;
            if (this.navButtonsContainer) {
                if (currentIndex != this.activeIndex) {
                    this.navButtonsContainer.querySelector('a[data-card-nav-index="' + currentIndex + '"]').classList.add('active');
                    this.navButtonsContainer.querySelector('a[data-card-nav-index="' + this.activeIndex + '"]').classList.remove('active');
                }
            }
        }
        // Change active Selection
        function changeActiveSelection(currentIndex, swipedIndex) {
            this.activeIndex = swipedIndex;
            if (utils.isTouchDevice()) {
                // Change active Nav button
                this.cardListContainerWrapper.querySelector('a[data-slider-index="' + currentIndex + '"]').classList.remove('active');
                this.cardListContainerWrapper.querySelector('a[data-slider-index="' + swipedIndex + '"]').classList.add('active');
            }
            // Change active card
            this.cardListContainerWrapper.querySelector('div[data-slider-index="' + currentIndex + '"]').classList.remove('active');
            this.cardListContainerWrapper.querySelector('div[data-slider-index="' + swipedIndex + '"]').classList.add('active');
        }
        // slide container for slide effect
        function slide(currentIndex, swipedIndex) {

            var translateValue = 0;
            var sectionId = this.cardListContainerWrapper.getAttribute('data-card-id');
            if (utils.isTouchDevice()) {
                var widthtouch = this.cards[0].getBoundingClientRect().width.toFixed(2);
                translateValue = ((swipedIndex - 1) * (widthtouch));
            } else {
                for (var iterator = 1; iterator < swipedIndex; iterator++) {
                    translateValue += this.cards[iterator].offsetWidth;
                }
            }
            this.cardListContainer.style.transform = "translateX(-" + translateValue + "px)";
            window.location.hash = "type=flexpanelslide&section=" + sectionId + "&index=" + swipedIndex;
        };
    };
    // Slider will available to the entire app through it is assigned to the global window
    window.def.FlexPanelSlider = FlexPanelSlider || {};

})();
(function() {
    'use strict';
    def.replaceLazyImages = function() {
        this.init();
    }
    var p = def.replaceLazyImages.prototype;
    def.replaceLazyImages.prototype.constructor = def.replaceLazyImages;

    /* Lazy loading images */
    var lazyImages = [].slice.call(document.querySelectorAll(".lazy"));
    var active = false;
    p.lazyLoadImages = function() {
        var _this = this;
        if (active === false) {
            active = true;
            if (document.querySelectorAll('html')[0].classList.contains('first-visit') === true) {
                setTimeout(function() {
                    if (lazyImages && lazyImages.length > 0) {
                        lazyImages.forEach(function(lazyImage) {
                            if ((lazyImage.getBoundingClientRect().top <= window.innerHeight && lazyImage.getBoundingClientRect().bottom >= 0) && getComputedStyle(lazyImage).display !== "none") {
                                _this.clearLazyImages(lazyImage);
                            }
                        });
                    }
                    active = false;
                }, 200);
            } else {
                if (lazyImages && lazyImages.length > 0) {
                    lazyImages.forEach(function(lazyImage) {
                        _this.clearLazyImages(lazyImage);
                    });
                }
            }
        }
    };

    p.init = function() {
        this.lazyLoadImages();
    };


    p.clearLazyImages = function(lazyImage) {
        if (lazyImage.style.display != 'none') {
            if (lazyImage.srcset) {
                lazyImage.srcset = lazyImage.dataset.srcset;
            }
            if (lazyImage.src) {
                lazyImage.src = lazyImage.dataset.src;
            }
            lazyImage.classList.remove("lazy");
            lazyImage.classList.add("lazy-removed");

            lazyImages = lazyImages.filter(function(image) {
                return image !== lazyImage;
            });
            if (lazyImages.length === 0) {
                document.removeEventListener("scroll", new def.replaceLazyImages());
                window.removeEventListener("resize", new def.replaceLazyImages());
                window.removeEventListener("orientationchange", new def.replaceLazyImages());
            }
        }
    }
})();
(function() {
    'use strict';
    def.SplashScreen = function() {
        this.name = 'SplashScreen';
        var _this = this;
        document.addEventListener("DOMContentLoaded", function(event) {
            _this.init();
        }, false);
    }
    var p = def.SplashScreen.prototype;
    def.SplashScreen.prototype.constructor = def.SplashScreen;

    p.init = function() {
        var _this = this;
        this.startPageY = 0;
        this.endPageY = 0;
        this.splashContainer = document.querySelector('.ss-outer-container');
		if (this.splashContainer) {
        this.splashTimer = this.splashContainer.querySelector('#splash-timer');
        this.splashScreen = document.querySelector('.splash-screen');
        this.pageHeader = document.querySelector('header');
        this.body = document.querySelector('body');
        this.main = document.querySelector('main');
        this.footer = document.querySelector('footer');
        this.sections = document.querySelectorAll('section');
        // if (this.sections) {
        //     if (this.sections.length > 0) {
        //         for (var i = 0; i < this.sections.length; i++) {
        //             this.sections[i].style.visibility = 'visible';
        //         }
        //     }
        // }
        _this.addEvents();
		}
    };

    p.addEvents = function() {
        var _this = this;
        if (_this.splashContainer) {
            if (!_this.splashContainer.classList.contains('fixed')) {
              //  _this.body.style.position = 'fixed';
                _this.body.style.overflowY = 'scroll';
                _this.hideHeader();
                _this.splashContainer.addEventListener("wheel", function(event) {
                    if (event.deltaY > 0) {
                        _this.showHeader();
                        _this.hideAnimateSplashScreen();
                        _this.resetSectionCarousel();
                    }
                }, false);
                _this.splashContainer.addEventListener('click', function(event) {
                    if (!event.target.classList.contains('splash-btn') && !event.target.classList.contains('splash-logos')) {
                        _this.showHeader();
                        _this.hideAnimateSplashScreen();
                        _this.resetSectionCarousel();
                    }
                }, false);
                if (!utils.isTouchDevice()) {
                    document.addEventListener("scroll", function(event) {
                        if (_this.splashContainer) {
                            if (window.scrollY > 40) {
                                _this.showHeader();
                                _this.hideAnimateSplashScreen();
                            }
                        }
                    }, false);
                }
                if (utils.isTouchDevice()) {
                    _this.splashContainer.addEventListener("touchstart", function(event) {
                        _this.startPageY = event.changedTouches[0].pageY;
                    },utils.supportsPassive() ? {
                        passive: true
                    } : false);
                    _this.splashContainer.addEventListener("touchend", function(event) {
                        _this.endPageY = event.changedTouches[0].pageY;
                        if (_this.startPageY > _this.endPageY) {
                            _this.showHeader();
                            _this.hideAnimateSplashScreen();
                            _this.resetSectionCarousel();
                        }
                    }, false);
                }
                if (typeof _this.splashTimer!='undefined' && _this.splashTimer!= null && _this.splashTimer.value !== "" && _this.splashTimer.value !== "undefined") {
                    var timerval = parseInt(_this.splashTimer.value)*1000;
                } else {
                    var timerval = 5000;
                }
                    setTimeout(function() {
                        _this.showHeader();
                        _this.hideAnimateSplashScreen();
                        _this.resetSectionCarousel();
                    }, timerval);

            } else {
                _this.showHeader();
                _this.hideAnimateSplashScreen();
            }
        }
    };

    p.showHeader = function() {
        var _this = this;
         if (_this.pageHeader) {
            if (!_this.pageHeader.classList.contains('show-header')) {
                _this.pageHeader.classList.add('show-header');
             }
            _this.pageHeader.style.display = 'block';
            _this.pageHeader.querySelector('.contact-us-container').style.display = 'block';
        }
        if (_this.main) {
            _this.main.style.visibility = 'visible';
        }
        new def.replaceLazyImages();
    };

    p.hideHeader = function() {
        var _this = this;
         if (_this.pageHeader) {
            if (_this.pageHeader.classList.contains('show-header')) {
                _this.pageHeader.classList.remove('show-header');
            }
        }
    };

    p.hideAnimateSplashScreen = function() {
        var _this = this;
        if (!_this.splashContainer.classList.contains('fixed')) {
            _this.splashContainer.classList.add('fixed');
        }
        if (_this.body) {
            _this.body.style.position = 'relative';
            _this.body.style.overflowY = '';
        }
    }

    p.resetSectionCarousel = function() {
        var sectionCarousel = document.querySelector('.section-feature-carousel');
        if (sectionCarousel) {
            if (obj.sectionCarousel) {
                obj.sectionCarousel.setCurrCarouselItem(0);
                obj.sectionCarousel.clearAutoSlide();
            }
        }
    }

    obj.splashScreen = new def.SplashScreen();

})();
//# sourceMappingURL=sourcemap/splash-screen-core.js.map

(function() {
    def.Main = function() {

    };

    def.Main.prototype.init = function() {
        this.body = document.getElementsByTagName('body')[0];
        this.navLocal = document.getElementById('nav-local');
        this.contactUsButton = document.getElementById('contactus-banner');
        this.contactOverlayButton = document.getElementsByClassName('contact-overlay-button')[0];
        this.signInButton = document.querySelector('.signin-button');
        this.signInOverlayButton = document.querySelector('.signin-overlay-button');
        this.stockHeader = document.getElementById('stock-transparent-header');
        this.goBackLinks = document.querySelectorAll('.nav-link-back a');
        this.quickMenu = document.querySelector('#quick-menu');
        this.stickyMenu = document.querySelector('#sticky-menu');
        this.headerWithoutMenu = document.querySelector(".header-without-menu");
        this.loaderDiv = this.body.querySelector('.progress');
        this.davosHeader = this.body.querySelector('.davos-header');
        this.hideThinHeader = this.body.querySelector('.hide-thin-header');
        this.fullFledgedHeader = this.body.querySelector('.full-fledged-header');
        this.btsHeader = this.body.querySelector('.bts-header');
        this.catalogHeader = this.body.querySelector('.show-header-catalog');
        if (this.quickMenu) {
            this.quickMenuItems = this.quickMenu.querySelectorAll('.quick-menu-items .menu-item-link');
        }
        if (this.stickyMenu) {
            this.stickyMenuItems = this.stickyMenu.querySelectorAll('.sticky-menu-items .menu-item-link');
        }
        if (this.loaderDiv) {
            if (this.loaderDiv.classList.contains('hide') === false) {
                this.loaderDiv.classList.add('hide');
            }
        }


        this.navFixed = false;
        this.isAnimating = false;
        this.stockHeaderFixed = false;
        this.sections = [];
        this.carouselElements = [];
        this.pageHeight = 0;
        this.viewportHeight = window.innerHeight;
        this.viewportWidth = window.innerWidth;
        this.header = {};
        this.footer = {};
        this.parallaxEnabled = window.matchMedia('(min-width:1025px)').matches && !utils.hasTouchSupport();
        this.parallaxBuffer = 160;
        this.fpsList = [];
        this.fps = 0;
        this.timestamp = 0;
        this.lastTimeStamp = 0;
        this.fixViewPortSize();
        this.setUpHeaderFooter();
        this.setupSections();
        this.getBounds();
        this.addEventListners();
        this.setSectionNavAndColor();
        this.addSectionParallax();
        this.scrollInterval();
        this.setGlobalTheme();
        this.registerServiceWorker();
        this.loadFonts();
        this.setSectionsVisible();
        this.setSectionsIds();
        this.captchaRender();
    };

    def.Main.prototype.getSectionObject = function(sectionElm) {
        var sectionObject;
        window.Array.prototype.forEach.call(this.sections, function(section) {
            if (section.elm === sectionElm) {
                sectionObject = section;
            }
        });
        return sectionObject;
    };

    def.Main.prototype.setUpHeaderFooter = function() {
        this.header.elm = document.getElementsByTagName('header')[0];
        this.footer.elm = document.getElementsByTagName('footer')[0];
        if (this.footer.elm) {
            this.footer.height = this.footer.elm.clientHeight;
        }
    };

    def.Main.prototype.fixViewPortSize = function() {
        if (navigator.userAgent.match(/Android.*.Chrome[.0-9]*.*(?!Mobile)/)) {
            var screenHeight = window.screen.height + 'px';
            this.body.querySelectorAll('.section-hero,.section-feature').forEach(function(section) {
                if (!section.classList.contains('section-feature-carousel')) {
                    if (section.classList.contains('section-feature-small') === true) {
                        // Checking for medium devices
                        if (screenHeight > 768) {
                            //If section-feaute-small min-heigh 460px
                            if (section.clientHeight > 460) {
                                section.style.height = screenHeight;
                            }
                        }
                    } else {
                        section.style.height = screenHeight;
                    }
                }
            });
            document.querySelector('html').style.minHeight = screenHeight;
        }
    };

    def.Main.prototype.setupSections = function() {
        var sectionElm;
        var sectionType;
        var section;
         var main = document.querySelector('main');
        var sectionsElms
        if (main) {
            sectionsElms = main.getElementsByTagName('section');
        }
        else {
            sectionsElms = document.getElementsByTagName('section');
      }
        var sLength = sectionsElms.length;

        for (var i = 0; i < sLength; i++) {

            sectionElm = sectionsElms[i];
            sectionType = sectionElm.hasAttribute('data-section-type') ? sectionElm.getAttribute('data-section-type') : 'section-base';
            section = new def.componentMapping[sectionType](sectionElm, i);
            section.theme = section.elm.dataset.globalTheme || 'theme-black';
            section.snapToViewport = (section.elm.dataset.snapToViewport === 'true') || false;
            section.parallax = section.elm.querySelector('.parallax-wrapper');
            section.visibility = 0;
            section.classList = [];
            this.sections.push(section);
        }
    };

    def.Main.prototype.getBounds = function() {
        this.pageHeight = this.body.clientHeight;
        this.viewportHeight = window.innerHeight;
        this.viewportWidth = window.innerWidth;
        if (this.footer.elm) {
            this.footer.height = this.footer.elm.clientHeight;
        }

        window.Array.prototype.forEach.call(this.sections, function(section) {

            section.width = section.elm.clientWidth;
            section.height = section.elm.clientHeight;
            section.top = section.elm.offsetTop;
            section.bottom = section.top + section.height;

        });
    };

    def.Main.prototype.setSectionNavAndColor = function() {

        var _this = this;
        var carouselElements = [];
        this.navCarousel = {};
        this.navCarousel.elm = document.getElementById('nav-carousel');
        this.pageLevel = document.querySelector('main').dataset.pageLevel || '1';

        // if section length is less than 2 do not create carousel
        if (this.sections.length > 2 && this.pageLevel.toString() === '1') {

            for (var i = 0; i < this.sections.length; i++) {
                carouselElements.push('<span class="nav-carousel-item circle outline-none" tabindex="0" aria-label="page navigation button' + i + '" data-i="' + i + '"></span>');
            }
            if (this.navCarousel && this.navCarousel.elm) {
                this.navCarousel.elm.innerHTML = carouselElements.join('');
                this.carouselElements = document.getElementsByClassName('nav-carousel-item');
                this.navCarousel.elm.onclick = function(event) {
                    if (event.target.classList.contains('nav-carousel-item')) {
                        _this.getBounds();
                        _this.scrollToSection(event.target.dataset.i);
                    }
                };
            }

            for (var i = 0; i < this.carouselElements.length; i++) {
                this.carouselElements[i].addEventListener('keydown', function(event) {
                    if (event.which == 32 || event.which == 13)
                        this.click();
                }, false);
            }

        }
        if (this.navCarousel && this.navCarousel.elm) {
            this.navCarousel.height = this.navCarousel.elm.clientHeight;
        }
    };

    def.Main.prototype.setGlobalTheme = function() {
        var activeTheme = (this.activeSection && this.activeSection.theme) ? this.activeSection.theme : 'theme-black';
        if (this.theme !== activeTheme) {
            document.body.classList.remove(this.theme);
            document.body.classList.add(activeTheme);
            this.theme = activeTheme;
        }
    };

    def.Main.prototype.setSectionsVisible = function() {
        if (this.sections.length > 0) {
            for (var i = 0; i < this.sections.length; i++) {
                if (this.sections[i].elm.classList.contains('section-cards-layout') === true) {
                    if (this.sections[i].elm.style.visibility != '') {
                        if (this.sections[i].elm.style.visibility === 'hidden') {
                            this.sections[i].elm.style.visibility = 'visible';
                        }
                    } else {
                        this.sections[i].elm.style.visibility = 'visible';
                    }
                }
            }
        }
    };

    def.Main.prototype.setSectionsIds = function() {
        if (this.sections.length > 0) {
            for (var i = 1; i <= this.sections.length; i++) {
                this.sections[i-1].elm.setAttribute('id', 'section_'+i);
            }
        }
    }

    def.Main.prototype.calculateAverageFPS = function() {
        var fps = 0;
        var sum = 0;
        if (this.fpsList.length >= 10) {
            for (var i = 0; i < this.fpsList.length; i++) {
                sum += this.fpsList[i];
            }
            fps = sum / this.fpsList.length;
        }
        return fps;
    };

    def.Main.prototype.scrollInterval = function() {

        var _this = this;
        // Check fps & disable parallax if needed
        if (!this.averageFPS) {
            this.timestamp = window.performance.now();
            if (this.timestamp - this.lastTimeStamp > 1000) this.fpsList = [];
            var fps = 1000 / (this.timestamp - this.lastTimeStamp);
            this.fpsList.push(fps);
            if (this.fpsList.length > 10) {
                this.fpsList.shift();
            }
            this.averageFPS = this.calculateAverageFPS();
            if (this.averageFPS !== 0 && this.averageFPS < 25) {
                this.parallaxEnabled = false;
                this.clearSectionParallax();
            }
        }

        var headerHeight = 40;
        this.scrollTop = window.utils.getScrollY();
        var scrollUpFlag = (this.previousScrollTop > this.scrollTop) ? 1 : 0;
        // Ignore small scroll changes
        if (Math.abs(this.previousScrollTop - this.scrollTop) < 5) {
            this.isAnimating = false;
            return;
        }

        window.Array.prototype.forEach.call(this.sections, function(section) {

            var previousVisibility = section.visibility;
            var scrollTop = _this.scrollTop;
            // If section is within viewport
            if (section.top >= scrollTop && section.top < scrollTop + _this.viewportHeight) {
                section.visibility = 100 * (scrollTop + _this.viewportHeight - section.top) / (section.height);
            } else if (section.bottom > scrollTop && section.bottom <= scrollTop + _this.viewportHeight) {
                section.visibility = 100 * (section.top + section.height - scrollTop) / (section.height);
            } else {
                // Otherwise remove markers
                section.visibility = 0;
                if (section.classList.length > 0) {
                    section.classList = [];
                }
            }

            if (section.visibility > 0) {
                // Trigger section animations
                this.inViewPort = true;

                section.onRequestAnimationFrame && section.onRequestAnimationFrame();
                section.dispatch('onscroll');
                if (previousVisibility < section.visibility && section.visibility >= 10) {
                    if (section.classList.indexOf('section-enter') === -1) {
                        section.classList.push('section-enter');
                        section.elm.classList.add('section-enter');
                        if (section.elm.classList.contains('section-leave') === true) {
                            section.elm.classList.remove('section-leave');
                        }
                        section.dispatch('onenter');
                    }
                }
                if (previousVisibility > section.visibility && section.visibility < 45) {
                    if (section.classList.indexOf('section-leave') === -1) {
                        section.classList.push('section-leave');
                        section.elm.classList.add('section-leave');
                        if (section.elm.classList.contains('section-active') === true) {
                            section.elm.classList.remove('section-active');
                        }
                        section.dispatch('onexit');
                    }
                }
                if (section.visibility >= 80) {
                    if (section.classList.indexOf('section-active') === -1) {
                        section.classList.push('section-active');
                        section.elm.classList.add('section-active');
                        if (section.elm.classList.contains('section-leave') === true) {
                            section.elm.classList.remove('section-leave');
                        }
                    }
                }

                if (!_this.activeSection || _this.activeSection.top > scrollTop + headerHeight) {
                    _this.activeSection = section;
                } else if (section.top > _this.activeSection.top && section.top <= scrollTop + headerHeight) {
                    _this.activeSection = section;
                }
            } else {
                _this.inViewPort = false;
            }
        });

        // Minimize header on desktop view
        if (!utils.isTablet) {
            if (this.scrollTop > 20 && !this.navFixed) {
            	if (!this.hideThinHeader&&!this.headerWithoutMenu && !this.davosHeader && !this.fullFledgedHeader && !this.btsHeader&& !this.catalogHeader )  {
                    this.header.elm.style.transform = 'translate3d(0,-24px,0)';
                }
                this.navFixed = true;
                this.navLocal.classList.add('shrink');
                //this.contactUsButton.classList.add('shrink');
            }
            if (this.scrollTop < 20 && this.navFixed) {
            	if (!this.headerWithoutMenu) {
                    this.header.elm.style.transform = 'translate3d(0,0,0)';
                }
                this.navFixed = false;
                this.navLocal.classList.remove('shrink');
                //this.contactUsButton.classList.remove('shrink');
            }
            // Stock header for Investor Relations
            if (this.stockHeader) {
                if (this.scrollTop > 20 && !this.stockHeaderFixed) {
                    this.stockHeaderFixed = true;
                    this.stockHeader.classList.add('shrink-sh-close');
                    this.stockHeader.classList.remove('shrink-sh-open');
                }
                if (this.scrollTop < 20 && this.stockHeaderFixed) {
                    this.stockHeaderFixed = false;
                    this.stockHeader.classList.add('shrink-sh-open');
                    this.stockHeader.classList.remove('shrink-sh-close');
                }
            }
        }

        // shrink header on tablet & mobile view
        //if (utils.isTablet || utils.isMobile) {
        if (this.scrollTop < 20 || scrollUpFlag) {
        	if (this.contactUsButton) {
                this.contactUsButton.classList.remove('shrink-mobile');
            }
            if (this.contactOverlayButton) {
                this.contactOverlayButton.classList.add('hide');
            }
            if (this.signInButton) {
                this.signInButton.classList.remove('shrink-mobile');
            }
            if (this.signInOverlayButton) {
                this.signInOverlayButton.classList.add('hide');
            }
        }
        if (this.scrollTop > 20 && !scrollUpFlag) {
        	if (this.contactUsButton) {
                this.contactUsButton.classList.add('shrink-mobile');
             }
        	if (this.signInButton) {
                this.signInButton.classList.add('shrink-mobile');
             }
             if (this.contactOverlayButton) {
                this.contactOverlayButton.classList.remove('hide');
             }
             if (this.signInOverlayButton) {
                 this.signInOverlayButton.classList.remove('hide');
              }
        }
        // }

        this.updateCarouselIndicator();
        if (this.quickMenu) {
            this.updateQuickMenuSelection();
        }
        if (this.stickyMenu) {
            this.updateStickyMenuSelection();
        }
        this.setGlobalTheme();
        if (this.parallaxEnabled) {
        	if(!document.querySelector('.parallax-not-required')) {
                this.addSectionParallax();
        	}
        }
        //this.snapToViewPort();
        this.previousScrollTop = this.scrollTop;
        this.lastTimeStamp = this.timestamp;
        this.isAnimating = false;
    };

    def.Main.prototype.updateCarouselIndicator = function() {
        var sectionIndex = this.sections.indexOf(this.activeSection);
        window.Array.prototype.forEach.call(this.carouselElements, function(carouselItem, index) {
            if (index === sectionIndex) {
                carouselItem.classList.add('selected');
            } else {
                carouselItem.classList.remove('selected');
            }
        });

        // Hide carousel once we reach footer section
        if (this.navCarousel.elm && !(utils.isTablet || utils.isMobile)) {
            var carouselOffset = this.scrollTop + (this.viewportHeight / 2) + (this.navCarousel.height / 2);
            if (this.pageHeight != this.body.clientHeight)
                this.pageHeight = this.body.clientHeight;
            var footerOffset = this.pageHeight - this.footer.height;
            if (carouselOffset > footerOffset) {
                this.navCarousel.elm.classList.add('hide');
            } else {
                this.navCarousel.elm.classList.remove('hide');
            }
        }
    };

    def.Main.prototype.updateQuickMenuSelection = function() {
        if (this.activeSection) {
            var sectionIdVal = this.activeSection.elm.id;
        }
        window.Array.prototype.forEach.call(this.quickMenuItems, function(quickMenuItem, index) {
            if (quickMenuItem.getAttribute('href').split('#')[1] === sectionIdVal) {
                quickMenuItem.parentNode.parentNode.classList.add('selected');
                var parentNodeElm = quickMenuItem.parentNode.parentNode;
                var parentNodeElmOffsetTop = parentNodeElm.offsetTop;
                document.querySelector('.quick-menu-overlay .menu-selector').style.transform = 'translate(0px, ' + parentNodeElmOffsetTop + 'px)';
                document.querySelector('.quick-menu-overlay .menu-selector').style.webkitTransform = 'translate(0px, ' + parentNodeElmOffsetTop + 'px)';
            } else {
            	quickMenuItem.parentNode.parentNode.classList.remove('selected');
            }
        });
    };    def.Main.prototype.updateStickyMenuSelection = function() {
        if (this.activeSection) {
            var sectionIdVal = this.activeSection.elm.id;
        }
        window.Array.prototype.forEach.call(this.stickyMenuItems, function(stickyMenuItem, index) {
            if (stickyMenuItem.getAttribute('href').split('#')[1] === sectionIdVal) {
                stickyMenuItem.parentNode.parentNode.classList.add('selected');
                var parentNodeElm = stickyMenuItem.parentNode.parentNode;
                var parentNodeElmOffsetTop = parentNodeElm.offsetTop;
                document.querySelector('.sticky-menu-overlay .menu-selector').style.transform = 'translate(0px, ' + parentNodeElmOffsetTop + 'px)';
                document.querySelector('.sticky-menu-overlay .menu-selector').style.webkitTransform = 'translate(0px, ' + parentNodeElmOffsetTop + 'px)';
            } else {
                stickyMenuItem.parentNode.parentNode.classList.remove('selected');
            }
        });

    };


    def.Main.prototype.clearSectionParallax = function() {
        window.Array.prototype.forEach.call(this.sections, function(section) {
            if (section && section.parallax) {
                section.parallax.style.cssText = '';
            }
        });
    };

    def.Main.prototype.addSectionParallax = function() {
        var _this = this;
        var scrollTop = _this.scrollTop;
        var viewportHeight = _this.viewportHeight;

        for (var i = 0; i < _this.sections.length; i++) {
            var section = _this.sections[i];
            var content = section.parallax;
            var pageOffset = section.top + _this.parallaxBuffer;
            if (content && section.visibility > 0) {
                if (scrollTop >= 0 && scrollTop > pageOffset && scrollTop < pageOffset + viewportHeight) {
                    var opacity = 1 - ((scrollTop - pageOffset) / viewportHeight);
                    var sectionOffset = Math.round((scrollTop - pageOffset) * 0.4);
                    var newOpacity = opacity.toFixed(1);
                    content.style.cssText = 'transform:translate3d(0,' + sectionOffset + 'px, 0);opacity:' + newOpacity;
                } else {
                    content.style.cssText = 'transform:translate3d(0,0,0);opacity:1';
                }
            }

        }
    };

    def.Main.prototype.snapToViewPort = function() {
        var _this = this;
        clearTimeout(this.timeout);
        this.timeout = setTimeout(function() {
            var sectionId = 0;
            var visibility = 0;
            for (var i = 0; i < _this.sections.length; i++) {
                var section = _this.sections[i];

                if (section.visibility > 70 && section.visibility > visibility && section.snapToViewport) {
                    visibility = section.visibility;
                    sectionId = i;
                }
            }
            if (_this.sections[sectionId].top !== _this.scrollTop && visibility > 90) {
                _this.scrollToSection(sectionId, 500);
            }
        }, 750);
    };

    def.Main.prototype.scrollToSection = function(sectionIndex, duration) {
        var TWEEN = window.TWEEN;
        var to;
        var initialScrollPos = parseInt(this.scrollTop);
        var currentScrollPos = initialScrollPos;
        var targetSection = this.sections[sectionIndex];
        duration = duration || 2000;
        var direction = 1;
        var targetScrollPos = targetSection.top - 1;
        direction = (initialScrollPos < targetScrollPos) ? 1 : -1;
        to = (targetScrollPos - initialScrollPos) * direction;
        new TWEEN.Tween(0)
            .to(to, duration)
            .easing(TWEEN.Easing.Quadratic.Out)
            .onUpdate(function(value) {
                currentScrollPos = Math.round(initialScrollPos + (value * to * direction));
            })
            .start();

        scrollWindow();

        function scrollWindow() {
            window.scrollTo(0, currentScrollPos);
            TWEEN.update();
            if (currentScrollPos !== (to * direction) + initialScrollPos) {
                window.requestAnimationFrame(scrollWindow);
            }
        }
    };

    def.Main.prototype.goBack = function(event) {
    	//window.location.href = event.target.parentElement.href;
	   	 var hashValue = window.location.hash.toString();
	        /** Fix for overlay open case.
	         *  History back is not work properly in this case.
	         * Hash change happens when overlay open and close case.
	         * Master change in to branch**/
	        if (hashValue === "#0") {
	            window.location.href = utils.getSanitizedText(event.target.parentElement.href);
	        } else if (event.target.parentElement.href === document.referrer) {
	        	if (window.history.length > 1)
	            {
	                 event.preventDefault();
	                 window.history.go(-1);
	            }
	         }
    };

    def.Main.prototype.addEventListners = function() {
        var _this = this;


        window.addEventListener('resize', this.getBounds.bind(this));
        window.Array.prototype.forEach.call(_this.sections, function(section, index) {
            section.elm.addEventListener('click', function(event) {
                if (event.target.classList.contains('icon-paddledown')) {
                    _this.scrollToSection(index + 1);
                }
            });
        });
        window.addEventListener('scroll', function() {
            if (!_this.isAnimating) {
                window.requestAnimationFrame(function() {
                    _this.isAnimating = true;
                    _this.scrollInterval();
                });
            }
        }, utils.supportsPassive() ? {
            passive: true
        } : false);

        for (var m = 0; m < this.goBackLinks.length; m++) {
            var goBackLink = this.goBackLinks[m];
            goBackLink.addEventListener('click', this.goBack, false);
        }

        //Avoid Script & HTML injections
        window.addEventListener("keyup", function(elm) {
            if (elm.target.tagName.toLowerCase() == 'input' || elm.target.tagName.toLowerCase() == 'textarea') {
                var val = elm.target.value;
                var rVal = val.replace(/<(.*?)>/g, "");
                if (val != rVal)
                    elm.target.value = rVal;
            }
        });
    };

    def.Main.prototype.registerServiceWorker = function() {
        if ('serviceWorker' in navigator) {
            if (document.readyState === 'loading') {
                window.addEventListener('load', function() {
                    installSW();
                });
            } else {
                installSW();
            }
        }

        function installSW() {
        	var origin = utils.getSanitizedText(window.location.origin);
            var host = utils.getSanitizedText(window.location.hostname);
            if (host === 'localhost' || host === '127.1.1.1') {
                var serviceWorker = './service-worker.js';
            } else {
                var serviceWorker = origin + '/service-worker.js';
            }
            navigator.serviceWorker.register(serviceWorker).catch(function(err) {
                console.log('ServiceWorker registration failed: ', err);
            });
        };
    };
    def.Main.prototype.loadFonts = function() {
        var timeout;
        // check if font is already loaded
        if (document.documentElement.className.indexOf('fonts-loaded') > -1) {
            return;
        }

        function markFontsAsLoaded() {
            // Wait for 8sec & mark fonts as loaded
            setTimeout(function() {
                document.documentElement.className += ' fonts-loaded';
                window.localStorage.setItem('fonts-loaded', 'true');
            }, 800 * 10);
        }

        // var LatoNormal = new window.FontFaceObserver('LatoWeb', {
        //     weight: 'normal'
        // });

        var iconFont = new window.FontFaceObserver('icomoon', {
            weight: 'normal'
        });

        //timeout = setTimeout(markFontsAsLoaded, 1000 * 10);
        window.Promise
            .all([iconFont.load()])
            .then(function() {
                //window.clearTimeout(timeout);
                markFontsAsLoaded();
            }).catch(markFontsAsLoaded);
    };
	 def.Main.prototype.captchaRender = function() {
        var gRecaptchaContainer = document.querySelectorAll('.g-recaptcha');
        var siteKey = "6LcUNxYUAAAAAKay5vQQQiz8ttjhaGk6jCHljsoQ";
        var script = document.createElement('script');
        script.src = 'https://www.google.com/recaptcha/api.js?onload=onloadCommonCaptchaCallback&&render=explicit';
        script.async = true;
        script.defer = true;
        document.body.appendChild(script);
    }
	
})();

(function() {
    window.obj = window.obj || {};

    var _initialize = function() {

        if (!window.obj.main) {
            window.obj.main = new window.def.Main();
            window.obj.main.init();
            var lazyImages = document.querySelectorAll(".lazy");
            if (lazyImages && lazyImages.length > 0) {
                document.addEventListener("scroll", function() {
                    new def.replaceLazyImages();
                }, false);
                window.addEventListener("resize", function() {
                    new def.replaceLazyImages();
                }, false);
                window.addEventListener("orientationchange", function() {
                    new def.replaceLazyImages();
                }, false);
            }
        }
    };

    if (window.addEventListener) {
        window.addEventListener('DOMContentLoaded', _initialize, false);

        // On Orientation Change Reload the page and navigate to hash defined if available.
        window.addEventListener('orientationchange', function() {

            var shouldRefreshOnRotate = true;
            shouldRefreshOnRotate = (def.VideoControlHub === null || (def.VideoControlHub && !def.VideoControlHub.isVideoPlaying()));
            var isRefreshNeeded = document.querySelector('main').getAttribute('refresh-on-orientationchange');
            if (isRefreshNeeded) {
                shouldRefreshOnRotate = isRefreshNeeded;
            }
            if (shouldRefreshOnRotate) {
                var activeSection = obj.main.activeSection;
                var lastHash = utils.getSanitizedText(window.location.hash.toString());
                // Switch/Naviagate to section on Rotation, only if a valid Hash key is not present.
                var shouldSwitchSection = (lastHash === '' || lastHash === '#0' || lastHash.indexOf('section_') != -1);
                if (activeSection != null && shouldSwitchSection) {
                    window.location.hash = activeSection.elm.id;
                }
                window.location.reload();
            }
        });

    } else {
        // IE and Older browsers need to be handled here
    }
})();
(function() {

    var ContactUsSection = function(contactUs, openItem) {
        if (!contactUs) {
            return;
        }
        this.name = 'ContactUsSection';
        this.contactUsButton = document.getElementsByClassName('contact-us-button')[0];
        this.contactShrinkButton = document.querySelector('.contact-overlay-button');
        this.formSendButton = contactUs.querySelector('.form-send-button');
        this.contactConfirmationButton = contactUs.querySelector('.contact-confirmation');
        this.serverErrorMsg = contactUs.querySelector('.contact-server-error-msg');
        this.contactForm = contactUs.querySelector('.contact-form');
        this.navigateForm = contactUs.querySelector('.navigate-form');
        this.clearForm = contactUs.querySelector('.form-clear-button');
        this.contactUsValidations = contactUs.querySelectorAll('.form-error-label');
        this.syntaxValidations = contactUs.querySelectorAll('.required-field');
        this.radiobuttons = document.querySelectorAll('.radiobutton');
        this.checkboxes = document.querySelectorAll('.checkbox');
        this.title=document.title;
        this.contactUsWrapper = contactUs;
        this.clickFirst=true;
        this.keyBoardClick=false;
        
        if(document.getElementById('locale')!=null){
			 var localeGerman = document.getElementById('locale').value;
        }
        else{
			 var localeGerman = "";
        }
        if (openItem) {
            this.openItem = openItem;
        }
        this.init();
    };
    var p = ContactUsSection.prototype;
    ContactUsSection.prototype.constructor = ContactUsSection;
    p.init = function() {
        var _this = this;
		this.formID = _this.contactForm.getAttribute("id");
		this.formIdentity = '#' + this.formID;
		this.commonFormValidation = new def.commonFormValidation(this.formIdentity);
        //this.formValidation = new def.formValidation(_this.formSendButton);
        this.DropDownList = new def.DropDownList();
        if (this.openItem) {
            this.contactUsWrapper.querySelectorAll(".accordion-item").forEach(function(item) {
                if (item.getAttribute("data-item-name") === _this.openItem) {
                    item.classList.add("expanded");
                    item.querySelector('.accordion-head span').classList.remove('icon-ic_expand');
                    item.querySelector('.accordion-head span').classList.add('icon-ic_collapse');
                }
            })
        }
        if (this.formSendButton) {
            this.formSendButton.addEventListener('click', function() {
                if (_this.commonFormValidation.isValidated()) {
		    var loader = document.querySelector('.progress');
                    if (loader) {
                        loader.classList.remove('hide');
                        loader.classList.add('show');
                    }
                    var url = '/services/tcs/ContactUsFormServlet';
                    //var url = '/services/tcs/ContactUsStoreDataServlet';
                     if(document.getElementById('locale')!=null){
			 			var localeGerman = document.getElementById('locale').value;
        			}
        			else{
			 			var localeGerman = "";
       				 }
                    var formData = utils.serializeForm(_this.contactForm);
					//formparameters = formData +"&isgerman="+german;
                    if(localeGerman){
                    	formparameters = formData +"&locale="+localeGerman;
                    }else{
                    	formparameters = formData;
                    }
                    var ref = "";
                    if (window.location.href !="undefined") {
                        ref = window.location.href;
                    }
                    fetch(url + '?' + formparameters+"&referrerUrl="+ref, {
                            method: 'GET',
                            credentials: 'include'
                        })
                        .then(
                            function (response) {
								 loader.classList.remove('show');
                                 loader.classList.add('hide');
                                if (response.status !== 200) {
                                    return;
                                }
                                response.json().then(function (data) {
		   		    if(data.status == 'succeed'){
					//_this.contactForm.classList.add('hide');
                     _this.serverErrorMsg.classList.add('hide');
                  
              


						var existingClient="Yes";
						if (document.getElementById("rad2")) {
						    if (document.getElementById("rad2").checked) {
						        existingClient = "No";
						    }
						}
	                        if (typeof(_satellite) != 'undefined') {
	                        	var countryVal = document.getElementById("country")? document.getElementById("country").value: "";
	                            var industryVal = document.getElementById("industry")? document.getElementById("industry").value: "";
	                            var categoryVal = document.getElementById("category")? document.getElementById("category").value: "";
	                            var servicesoftwareVal = document.getElementById("servicesoftware")? document.getElementById("servicesoftware").value: "";
	                            _satellite.setVar('countryContactUs', countryVal);
	                            _satellite.setVar('industryContactUs', industryVal);
	                            _satellite.setVar('inquiryCategoryContactUs', categoryVal);
	                            _satellite.setVar('servicesContactUs', servicesoftwareVal);
	                            _satellite.setVar('clientContactUs', existingClient);
	                            _satellite.track('contactUsSubmit');
	                        }
                            _this.contactForm.reset();
                            if (utils.getURLHash().type === 'overlay'){
                            	if(document.querySelector("#contactUsType") && document.querySelector("#contactUsType").value == "itWiz"){
                            		
                            		location.href = "/itwiz-en/itwiz/thankyou-itwiz#type=thank-you-itwiz";
                            	}else{
                            		location.href = "/thankyou#type=thankyou-contact-us-overlay";
                            	}
                            } else {
                                location.href = "/thankyou#type=thankyou-contact-us";
                            }

                    }else if(data.status == 'validation error'){
                         _this.serverErrorMsg.classList.remove('hide');
                        _this.contactConfirmationButton.classList.add('hide');
                        _this.contactConfirmationButton.classList.remove('show');
                        _this.serverErrorMsg.querySelector('h5').innerHTML = data.response.messages.general;
                        _this.commonFormValidation.resetCaptcha();
                        if (typeof(_satellite) != 'undefined') {
                            _satellite.track('ContactUsValidationError');
                        }
                    }
                    else if(data.status == 'error'){
						
                    	//_this.contactForm.classList.add('hide');
                    	  _this.formSendButton.classList.add('disabled');
                         _this.serverErrorMsg.classList.remove('hide');
                        _this.contactConfirmationButton.classList.add('hide');
                        _this.contactConfirmationButton.classList.remove('show');
                        _this.serverErrorMsg.querySelector('h5').innerHTML = data.response.messages.general;
                        _this.commonFormValidation.resetCaptcha();
                        if (typeof(_satellite) != 'undefined') {
                            _satellite.track('contactUsError');
                        }
                    }
                    else {
                        if (typeof(_satellite) != 'undefined') {
                            _satellite.track('contactUsError');
                        }
                       
                        loader.classList.remove('show');
                        loader.classList.add('hide');
                        _this.serverErrorMsg.classList.remove('hide');
                    }
				});
                            }
                        )
                        .catch(function (err) {
                            loader.classList.remove('show');
                            loader.classList.add('hide');
                        });

                }

            }, false);
        }

        if (this.navigateForm) {
            this.navigateForm.addEventListener('click', function() {
                _this.contactForm.reset();
                _this.contactConfirmationButton.classList.remove('show');
                _this.contactConfirmationButton.classList.add('hide');
                _this.contactForm.classList.remove('hide');
                _this.contactForm.classList.add('show');
                _this.commonFormValidation.resetCaptcha();

            }, false);
            this.navigateForm.addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13) {
                    this.click();
                }
            }, false);
        }
        if (this.clearForm) {
            this.clearForm.addEventListener('click', function() {
                _this.contactForm.reset();
                _this.formSendButton.classList.add('disabled');
                _this.serverErrorMsg.classList.add('hide');
                /* for removing the labels */
                for (var noOfFields = 0; noOfFields < _this.contactUsValidations.length; noOfFields++) {
                    _this.contactUsValidations[noOfFields].classList.remove('show');
                }
                /* for removing the syntax errors */
                for (var syntaxFields = 0; syntaxFields < _this.syntaxValidations.length; syntaxFields++) {
                    _this.syntaxValidations[syntaxFields].classList.remove('error');
                }
                if (window.grecaptcha) {
                    try {
                        window.grecaptcha.reset();
                    } catch (e) {
                        console.log("Error while reseting captcha");
                    }
                }
            }, false);
            this.clearForm.addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13) {
                    this.click();
                }
            }, false);
        }
        if (this.contactShrinkButton) {
            this.contactShrinkButton.addEventListener('click', function(event) {
               _this.onClickContactUsShrinked(event, this);
            }, false);

            this.contactShrinkButton.addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13) {
                    _this.onClickContactUsShrinked(event, this);
                }
            }, false);
        }
        for (var i = 0; i < _this.radiobuttons.length; i++) {
            _this.radiobuttons[i].addEventListener('keydown', function(event) {
                if (event.which == 32 || event.which == 13){
                    var elem = this.querySelector('input');
                if (elem) {
                    elem.click();
                    let toggleAriaCheck=elem.parentNode.ariaChecked;
                    if(toggleAriaCheck=='false'){
                     elem.parentNode.ariaChecked=true;
                     if(elem.id=="rad1"){
                        _this.radiobuttons[1].ariaChecked=false;
                       }
                     else{
                         _this.radiobuttons[0].ariaChecked=false;
                     }
                     }
                    }
                }
            }, false);
            _this.radiobuttons[i].addEventListener('click', function (event) {
                var elem = this.querySelector('input');
               if (elem) {
                   elem.click();
                   let toggleAriaCheck=elem.parentNode.ariaChecked;
                  if(toggleAriaCheck=='false'){
                   elem.parentNode.ariaChecked=true;
                   if(elem.id=="rad1"){
                      _this.radiobuttons[1].ariaChecked=false;
                     }
                   else{
                       _this.radiobuttons[0].ariaChecked=false;
                   }
        }
               }
            }, false);
        }
        if( _this.checkboxes){
            for (var i = 0; i < _this.checkboxes.length; i++){
            _this.checkboxes[i].addEventListener('keydown', function(event) {
            	if (event.which == 32 || event.which == 13){
                    _this.keyBoardClick=true;
                    var elem = this.querySelector('input');
                if (elem) {
                 // if(_this.title!= "tcs.com | contact-us"){
                	elem.click();
                	let toggleAriaCheck=elem.parentNode.ariaChecked;
                    if(toggleAriaCheck=='false'){
                     elem.parentNode.ariaChecked=true;
                    }
                     else{
                        elem.parentNode.ariaChecked=false;
                     }

              //  }

                }
        }
            }, false);
            _this.checkboxes[i].addEventListener('click', function (event) {

                var elem = this.querySelector('input');
                if (elem && _this.keyBoardClick==false ) {
               // if(_this.title!= "tcs.com | contact-us"){
                _this.clickFirst=true;
                  elem.click();
                 let toggleAriaCheck=elem.parentNode.ariaChecked;
                    if(toggleAriaCheck=='false' && _this.clickFirst){
                   elem.parentNode.ariaChecked=true;
                   _this.clickFirst=false;

                  }
                   else{
                      if(_this.clickFirst){
                        elem.parentNode.ariaChecked=false;
                        _this.clickFirst=false;
                      }
                           }
                //}
               }
              else{
                _this.keyBoardClick=false;
              }

              }, false);
           }
          }
    	//var script = document.createElement('script');
    	//script.src = 'https://www.google.com/recaptcha/api.js';
    	//document.body.appendChild(script);
		
		onloadCommonCaptchaCallback();

    };
    p.onClickContactUsShrinked = function(event, element) {
        if (window.utils.isMobile || window.utils.isTablet) {
            element.classList.add('hide');
            if (this.contactUsButton) {
                this.contactUsButton.classList.remove('shrink-mobile');
            }
        }
    };


    window.def.ContactUsSection = ContactUsSection;
})();

